[2021-06-17 18:00:31,947] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 18:00:35,674] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_pseudo_mini_batch_train.py --aggre lstm --batch-size 6245 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 18:00:36,701] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 18:00:36,701] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 18:00:36,701] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 18:00:36,701] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 18:00:36,701] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623952842.244878
before load_ogb step Time(s): 0.0065
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.84375, 'VmSize': 20541.9375, 'VmHWM': 1165.6640625, 'VmRSS': 1165.6640625}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.5892
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2857
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0015
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0996
-------------------------------------------------end of load ogb****************** step Time(s): 0.0074
finish constructing ogbn-products
load ogb-products time total: 1.9837355613708496
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9846
after inductive else step Time(s): 0.0001
after label step Time(s): 3.4066
after train_g.create_formats_() step Time(s): 1.5377
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 18:00:49,211] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 18:00:49,211] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 18:00:49,214] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 18:00:51,582] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.376021385192871 seconds
[2021-06-17 18:00:54,302] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 18:00:54,302] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 18:00:54,302] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 18:00:54,302] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 18:00:54,302] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f5d823511d0>
[2021-06-17 18:00:54,302] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:00:54,302] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 18:00:54,303] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 18:00:54,304] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 18:00:54,305] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 18:00:54,305] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 18:00:54,305] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 18:00:54,307] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.3799877166748047 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58837890625GB

Max Memory Allocated 1.1886205673217773  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.66259765625GB

Max Memory Allocated 1.1886205673217773  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 11.62158203125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 11.62158203125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 11.63330078125GB

Max Memory Allocated 9.847861289978027  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7186 | Train Acc 0.0303 | Speed (samples/sec) nan | GPU 10084.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 11.60986328125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 11.60986328125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 11.62353515625GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.847861289978027  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10595703125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11767578125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.61767578125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.847861289978027  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59619140625GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59619140625GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60791015625GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.847861289978027  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.847861289978027  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.888043880462646  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11572265625GB

Max Memory Allocated 9.888043880462646  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09228515625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.888043880462646  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.888043880462646  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889419078826904  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889419078826904  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.889419078826904  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889419078826904  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.889419078826904  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889755249023438  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.889755249023438  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889755249023438  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.889755249023438  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.889755249023438  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10205078125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10205078125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11376953125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10595703125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11376953125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

avg iteration(step) data from cpu to GPU time:9.26826906 ms
avg iteration GPU training time:243.22168025 ms
avg iteration (step) total cpu time:261.66782556 ms
Epoch Time(s): 10.7358
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09423828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10791015625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.11767578125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.11962890625GB

Max Memory Allocated 9.890792846679688  GigaBytes

Epoch 00001 | Step 00000 | Loss 3.2810 | Train Acc 0.2623 | Speed (samples/sec) 22723.4570 | GPU 10128.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09619140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12548828125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12744140625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.10009765625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.11181640625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.12353515625GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.12158203125GB

Max Memory Allocated 9.890792846679688  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.09814453125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.10986328125GB

Max Memory Allocated 9.890792846679688  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891141891479492  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60595703125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61962890625GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891141891479492  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60595703125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891141891479492  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59423828125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60595703125GB

Max Memory Allocated 9.891141891479492  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.899810791015625  GigaBytes

avg iteration(step) data from cpu to GPU time:9.42669874 ms
avg iteration GPU training time:242.99695220 ms
avg iteration (step) total cpu time:262.12936861 ms
Epoch Time(s): 9.9878
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.899810791015625  GigaBytes

Epoch 00002 | Step 00000 | Loss 3.3483 | Train Acc 0.2599 | Speed (samples/sec) 22744.8384 | GPU 10137.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.899810791015625  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.900296688079834  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.900296688079834  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

avg iteration(step) data from cpu to GPU time:9.53389519 ms
avg iteration GPU training time:239.62655075 ms
avg iteration (step) total cpu time:258.26619290 ms
Epoch Time(s): 9.9238
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

Epoch 00003 | Step 00000 | Loss 2.9986 | Train Acc 0.3058 | Speed (samples/sec) 22827.7995 | GPU 10153.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18603515625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

avg iteration(step) data from cpu to GPU time:9.12306252 ms
avg iteration GPU training time:242.21181742 ms
avg iteration (step) total cpu time:260.28094468 ms
Epoch Time(s): 9.8419
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

Epoch 00004 | Step 00000 | Loss 2.9191 | Train Acc 0.3220 | Speed (samples/sec) 22866.3214 | GPU 10153.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

avg iteration(step) data from cpu to GPU time:9.20072769 ms
avg iteration GPU training time:239.99475945 ms
avg iteration (step) total cpu time:258.13288159 ms
Epoch Time(s): 9.8244
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18798828125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

Epoch 00005 | Step 00000 | Loss 2.3866 | Train Acc 0.3875 | Speed (samples/sec) 22899.9868 | GPU 10153.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17626953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20751953125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20556640625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.18017578125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.20361328125GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.20166015625GB

Max Memory Allocated 9.915043830871582  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17822265625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.915043830871582  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

avg iteration(step) data from cpu to GPU time:9.53876031 ms
avg iteration GPU training time:240.37916113 ms
avg iteration (step) total cpu time:259.17244841 ms
Epoch Time(s): 9.8425
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

Epoch 00006 | Step 00000 | Loss 2.1929 | Train Acc 0.4267 | Speed (samples/sec) 22912.9165 | GPU 10158.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

avg iteration(step) data from cpu to GPU time:8.94482604 ms
avg iteration GPU training time:238.61642965 ms
avg iteration (step) total cpu time:257.31951219 ms
Epoch Time(s): 9.7637
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

Epoch 00007 | Step 00000 | Loss 1.8783 | Train Acc 0.4884 | Speed (samples/sec) 22942.7649 | GPU 10158.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

avg iteration(step) data from cpu to GPU time:9.03593953 ms
avg iteration GPU training time:237.28149131 ms
avg iteration (step) total cpu time:255.36017065 ms
Epoch Time(s): 9.7036
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

Epoch 00008 | Step 00000 | Loss 1.7141 | Train Acc 0.5286 | Speed (samples/sec) 22988.3571 | GPU 10158.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.920149803161621  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.920149803161621  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.62309214 ms
avg iteration GPU training time:240.21540324 ms
avg iteration (step) total cpu time:259.47545193 ms
Epoch Time(s): 9.9678
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00009 | Step 00000 | Loss 1.5666 | Train Acc 0.5707 | Speed (samples/sec) 22969.9344 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71337890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:02:35,076] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 18:02:35,077] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=3497.8645864099935
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.50782214 ms
avg iteration GPU training time:236.03101773 ms
avg iteration (step) total cpu time:255.60182995 ms
Epoch Time(s): 9.7974
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00010 | Step 00000 | Loss 1.4778 | Train Acc 0.5960 | Speed (samples/sec) 22996.2322 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46668673 ms
avg iteration GPU training time:240.82280081 ms
avg iteration (step) total cpu time:260.10639579 ms
Epoch Time(s): 9.8869
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00011 | Step 00000 | Loss 1.3471 | Train Acc 0.6493 | Speed (samples/sec) 22988.6169 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.82962253 ms
avg iteration GPU training time:237.07881560 ms
avg iteration (step) total cpu time:256.45026454 ms
Epoch Time(s): 9.7537
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00012 | Step 00000 | Loss 1.2342 | Train Acc 0.6685 | Speed (samples/sec) 23012.7062 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.19628795 ms
avg iteration GPU training time:231.49259158 ms
avg iteration (step) total cpu time:249.67901795 ms
Epoch Time(s): 9.4641
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00013 | Step 00000 | Loss 1.1733 | Train Acc 0.6930 | Speed (samples/sec) 23083.2366 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.12918993 ms
avg iteration GPU training time:228.17989265 ms
avg iteration (step) total cpu time:246.36577677 ms
Epoch Time(s): 9.7890
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00014 | Step 00000 | Loss 1.1277 | Train Acc 0.7097 | Speed (samples/sec) 23165.6874 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.06824414 ms
avg iteration GPU training time:232.09275931 ms
avg iteration (step) total cpu time:249.93907081 ms
Epoch Time(s): 9.9682
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00015 | Step 00000 | Loss 1.1328 | Train Acc 0.7042 | Speed (samples/sec) 23221.4928 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.39684149 ms
avg iteration GPU training time:228.16883285 ms
avg iteration (step) total cpu time:246.77217448 ms
Epoch Time(s): 9.5205
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00016 | Step 00000 | Loss 1.0551 | Train Acc 0.7169 | Speed (samples/sec) 23279.7660 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.73943354 ms
avg iteration GPU training time:235.66522838 ms
avg iteration (step) total cpu time:255.63880249 ms
Epoch Time(s): 9.7213
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.9667 | Train Acc 0.7558 | Speed (samples/sec) 23286.6445 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.68015779 ms
avg iteration GPU training time:237.47505414 ms
avg iteration (step) total cpu time:256.35011108 ms
Epoch Time(s): 9.7209
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.9200 | Train Acc 0.7611 | Speed (samples/sec) 23285.5975 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86584524 ms
avg iteration GPU training time:235.27343580 ms
avg iteration (step) total cpu time:255.11951800 ms
Epoch Time(s): 9.7572
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.8851 | Train Acc 0.7771 | Speed (samples/sec) 23292.3441 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:04:12,970] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:04:12,970] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=3533.801986815248
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.90916150 ms
avg iteration GPU training time:240.41922393 ms
avg iteration (step) total cpu time:260.34324257 ms
Epoch Time(s): 10.3107
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.8373 | Train Acc 0.7915 | Speed (samples/sec) 23246.8678 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.61748634 ms
avg iteration GPU training time:232.09356294 ms
avg iteration (step) total cpu time:252.03608584 ms
Epoch Time(s): 9.9524
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.7793 | Train Acc 0.8019 | Speed (samples/sec) 23237.8524 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69477216 ms
avg iteration GPU training time:236.00864100 ms
avg iteration (step) total cpu time:255.45665953 ms
Epoch Time(s): 9.7805
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.7832 | Train Acc 0.8099 | Speed (samples/sec) 23236.9611 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.70895289 ms
avg iteration GPU training time:235.24907091 ms
avg iteration (step) total cpu time:255.08468239 ms
Epoch Time(s): 9.7935
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.7464 | Train Acc 0.8259 | Speed (samples/sec) 23229.4386 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.27926404 ms
avg iteration GPU training time:221.79653818 ms
avg iteration (step) total cpu time:240.39857476 ms
Epoch Time(s): 9.3944
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.7038 | Train Acc 0.8267 | Speed (samples/sec) 23282.9573 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.32988328 ms
avg iteration GPU training time:238.32562878 ms
avg iteration (step) total cpu time:258.89321610 ms
Epoch Time(s): 9.9331
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.7107 | Train Acc 0.8314 | Speed (samples/sec) 23262.6424 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.53066785 ms
avg iteration GPU training time:236.08554303 ms
avg iteration (step) total cpu time:254.91000988 ms
Epoch Time(s): 9.7716
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.6415 | Train Acc 0.8456 | Speed (samples/sec) 23265.5684 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.73325749 ms
avg iteration GPU training time:225.63371899 ms
avg iteration (step) total cpu time:244.83049357 ms
Epoch Time(s): 9.4529
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.6271 | Train Acc 0.8552 | Speed (samples/sec) 23296.9504 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:8.84509978 ms
avg iteration GPU training time:225.04906492 ms
avg iteration (step) total cpu time:242.97705403 ms
Epoch Time(s): 9.4140
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.6110 | Train Acc 0.8610 | Speed (samples/sec) 23336.6856 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.64182993 ms
avg iteration GPU training time:229.26717009 ms
avg iteration (step) total cpu time:248.21826264 ms
Epoch Time(s): 9.5600
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.5645 | Train Acc 0.8681 | Speed (samples/sec) 23352.2263 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:05:49,559] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:05:49,560] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=3605.667972357894
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.11329061 ms
avg iteration GPU training time:225.04719317 ms
avg iteration (step) total cpu time:244.38749419 ms
Epoch Time(s): 9.5361
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.5810 | Train Acc 0.8709 | Speed (samples/sec) 23372.7776 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.77760470 ms
avg iteration GPU training time:224.61435219 ms
avg iteration (step) total cpu time:243.93781909 ms
Epoch Time(s): 9.5139
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.5800 | Train Acc 0.8682 | Speed (samples/sec) 23394.3430 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.73294225 ms
avg iteration GPU training time:237.81839385 ms
avg iteration (step) total cpu time:256.76374965 ms
Epoch Time(s): 9.7970
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.5805 | Train Acc 0.8644 | Speed (samples/sec) 23388.9807 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.35137300 ms
avg iteration GPU training time:234.87396523 ms
avg iteration (step) total cpu time:254.54742820 ms
Epoch Time(s): 9.7661
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.5376 | Train Acc 0.8757 | Speed (samples/sec) 23384.0442 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.81984116 ms
avg iteration GPU training time:237.89381070 ms
avg iteration (step) total cpu time:257.13493206 ms
Epoch Time(s): 9.7733
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.5570 | Train Acc 0.8733 | Speed (samples/sec) 23381.0730 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.76232654 ms
avg iteration GPU training time:236.93224589 ms
avg iteration (step) total cpu time:256.01700500 ms
Epoch Time(s): 9.9206
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.4939 | Train Acc 0.8844 | Speed (samples/sec) 23373.4308 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.70070163 ms
avg iteration GPU training time:238.23718544 ms
avg iteration (step) total cpu time:257.33718166 ms
Epoch Time(s): 9.9195
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.4889 | Train Acc 0.8860 | Speed (samples/sec) 23369.6066 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71474847 ms
avg iteration GPU training time:238.97212728 ms
avg iteration (step) total cpu time:258.14833464 ms
Epoch Time(s): 9.8485
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.4666 | Train Acc 0.8905 | Speed (samples/sec) 23361.0750 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.37303594 ms
avg iteration GPU training time:234.12967371 ms
avg iteration (step) total cpu time:252.56421831 ms
Epoch Time(s): 9.7950
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.5064 | Train Acc 0.8815 | Speed (samples/sec) 23365.1432 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.62697372 ms
avg iteration GPU training time:238.85884942 ms
avg iteration (step) total cpu time:257.89559329 ms
Epoch Time(s): 9.8626
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.5035 | Train Acc 0.8820 | Speed (samples/sec) 23363.2808 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:07:27,165] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:07:27,165] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=3612.7015749090583
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:8.98706143 ms
avg iteration GPU training time:223.64682007 ms
avg iteration (step) total cpu time:241.56013242 ms
Epoch Time(s): 9.4080
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.4893 | Train Acc 0.8855 | Speed (samples/sec) 23395.7949 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.01413209 ms
avg iteration GPU training time:229.62103837 ms
avg iteration (step) total cpu time:249.05915614 ms
Epoch Time(s): 9.6486
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.4737 | Train Acc 0.8900 | Speed (samples/sec) 23406.8186 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46510693 ms
avg iteration GPU training time:226.37714132 ms
avg iteration (step) total cpu time:244.80835597 ms
Epoch Time(s): 9.5935
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.4543 | Train Acc 0.8889 | Speed (samples/sec) 23428.2442 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.56524446 ms
avg iteration GPU training time:234.58827096 ms
avg iteration (step) total cpu time:254.42780389 ms
Epoch Time(s): 9.6756
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.4478 | Train Acc 0.8865 | Speed (samples/sec) 23431.1820 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:8.66912829 ms
avg iteration GPU training time:234.72299364 ms
avg iteration (step) total cpu time:252.55194417 ms
Epoch Time(s): 9.6681
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.4690 | Train Acc 0.8914 | Speed (samples/sec) 23436.0794 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.86359815 ms
avg iteration GPU training time:231.92259951 ms
avg iteration (step) total cpu time:251.34199637 ms
Epoch Time(s): 9.7338
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.4506 | Train Acc 0.8868 | Speed (samples/sec) 23436.6373 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.95885273 ms
avg iteration GPU training time:226.28281318 ms
avg iteration (step) total cpu time:245.40283062 ms
Epoch Time(s): 9.5243
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.4597 | Train Acc 0.8876 | Speed (samples/sec) 23448.1479 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65701455 ms
avg iteration GPU training time:256.14306302 ms
avg iteration (step) total cpu time:275.41885553 ms
Epoch Time(s): 10.2313
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.4242 | Train Acc 0.8982 | Speed (samples/sec) 23412.7042 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.30470398 ms
avg iteration GPU training time:223.02232135 ms
avg iteration (step) total cpu time:241.24116368 ms
Epoch Time(s): 9.3801
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.4184 | Train Acc 0.8956 | Speed (samples/sec) 23433.1038 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.14031998 ms
avg iteration GPU training time:222.75579043 ms
avg iteration (step) total cpu time:240.91033582 ms
Epoch Time(s): 9.4028
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.4313 | Train Acc 0.8962 | Speed (samples/sec) 23451.2483 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:09:03,899] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:09:03,899] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=3626.566914003209
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65968831 ms
avg iteration GPU training time:238.77886454 ms
avg iteration (step) total cpu time:257.89387138 ms
Epoch Time(s): 9.8755
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.4338 | Train Acc 0.8881 | Speed (samples/sec) 23441.9284 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.77871052 ms
avg iteration GPU training time:237.95098029 ms
avg iteration (step) total cpu time:257.23995986 ms
Epoch Time(s): 9.8160
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.4192 | Train Acc 0.8994 | Speed (samples/sec) 23434.0642 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.08839466 ms
avg iteration GPU training time:239.05266317 ms
avg iteration (step) total cpu time:258.63126472 ms
Epoch Time(s): 9.7916
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.3974 | Train Acc 0.9006 | Speed (samples/sec) 23426.7531 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.16208121 ms
avg iteration GPU training time:221.84121309 ms
avg iteration (step) total cpu time:239.81726611 ms
Epoch Time(s): 9.3853
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.4374 | Train Acc 0.8903 | Speed (samples/sec) 23444.9201 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.82237629 ms
avg iteration GPU training time:240.98779975 ms
avg iteration (step) total cpu time:260.04657039 ms
Epoch Time(s): 9.9123
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.4411 | Train Acc 0.8890 | Speed (samples/sec) 23435.2098 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.42890900 ms
avg iteration GPU training time:241.86231203 ms
avg iteration (step) total cpu time:260.49966282 ms
Epoch Time(s): 9.7995
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.4715 | Train Acc 0.8793 | Speed (samples/sec) 23426.7368 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65638998 ms
avg iteration GPU training time:243.16679721 ms
avg iteration (step) total cpu time:261.98953169 ms
Epoch Time(s): 10.0215
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.4208 | Train Acc 0.8897 | Speed (samples/sec) 23409.4552 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.04580037 ms
avg iteration GPU training time:237.64482004 ms
avg iteration (step) total cpu time:257.68697703 ms
Epoch Time(s): 10.1244
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.4218 | Train Acc 0.8919 | Speed (samples/sec) 23397.4435 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.69762248 ms
avg iteration GPU training time:236.32154394 ms
avg iteration (step) total cpu time:255.93602216 ms
Epoch Time(s): 9.7882
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.3868 | Train Acc 0.9036 | Speed (samples/sec) 23397.7932 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.03054930 ms
avg iteration GPU training time:234.01534017 ms
avg iteration (step) total cpu time:253.58767863 ms
Epoch Time(s): 9.8666
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.4083 | Train Acc 0.8988 | Speed (samples/sec) 23394.6537 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:10:42,100] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:10:42,101] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=3624.904464964613
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.25180555 ms
avg iteration GPU training time:231.67328955 ms
avg iteration (step) total cpu time:251.48217766 ms
Epoch Time(s): 9.6951
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.3997 | Train Acc 0.8982 | Speed (samples/sec) 23398.4229 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.60868975 ms
avg iteration GPU training time:237.84473843 ms
avg iteration (step) total cpu time:256.70770363 ms
Epoch Time(s): 9.7780
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.4138 | Train Acc 0.8991 | Speed (samples/sec) 23394.2865 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.44374167 ms
avg iteration GPU training time:235.75695010 ms
avg iteration (step) total cpu time:255.57228371 ms
Epoch Time(s): 9.8105
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.3916 | Train Acc 0.9002 | Speed (samples/sec) 23391.7705 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46116509 ms
avg iteration GPU training time:225.35519692 ms
avg iteration (step) total cpu time:244.02795898 ms
Epoch Time(s): 9.4953
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.3943 | Train Acc 0.8961 | Speed (samples/sec) 23402.1860 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.41346492 ms
avg iteration GPU training time:229.67086849 ms
avg iteration (step) total cpu time:248.24326127 ms
Epoch Time(s): 9.5136
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3918 | Train Acc 0.9002 | Speed (samples/sec) 23412.0171 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.71632124 ms
avg iteration GPU training time:226.91923862 ms
avg iteration (step) total cpu time:246.06805378 ms
Epoch Time(s): 9.4282
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.3762 | Train Acc 0.9042 | Speed (samples/sec) 23424.5128 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.38139965 ms
avg iteration GPU training time:236.55729788 ms
avg iteration (step) total cpu time:255.24295701 ms
Epoch Time(s): 9.7936
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3982 | Train Acc 0.9001 | Speed (samples/sec) 23420.5028 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.00684445 ms
avg iteration GPU training time:233.70494984 ms
avg iteration (step) total cpu time:251.69416710 ms
Epoch Time(s): 9.7041
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3653 | Train Acc 0.9078 | Speed (samples/sec) 23422.7465 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.19096413 ms
avg iteration GPU training time:238.70119392 ms
avg iteration (step) total cpu time:258.07633223 ms
Epoch Time(s): 9.9822
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.3515 | Train Acc 0.9129 | Speed (samples/sec) 23415.2541 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:8.64193662 ms
avg iteration GPU training time:235.80087958 ms
avg iteration (step) total cpu time:253.46264133 ms
Epoch Time(s): 9.5811
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3606 | Train Acc 0.9076 | Speed (samples/sec) 23420.6709 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71337890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

[2021-06-17 18:12:18,949] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:12:18,949] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=3628.0229064443665
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.89053278 ms
avg iteration GPU training time:236.57513145 ms
avg iteration (step) total cpu time:255.91335473 ms
Epoch Time(s): 9.7612
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3848 | Train Acc 0.9034 | Speed (samples/sec) 23420.5422 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.75251791 ms
avg iteration GPU training time:235.32475620 ms
avg iteration (step) total cpu time:254.27944572 ms
Epoch Time(s): 9.6821
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3573 | Train Acc 0.9070 | Speed (samples/sec) 23419.5696 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.57622274 ms
avg iteration GPU training time:234.21059559 ms
avg iteration (step) total cpu time:253.40115583 ms
Epoch Time(s): 9.6832
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3723 | Train Acc 0.9039 | Speed (samples/sec) 23418.1736 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.80491626 ms
avg iteration GPU training time:226.30822245 ms
avg iteration (step) total cpu time:245.33271790 ms
Epoch Time(s): 9.4333
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.3665 | Train Acc 0.9046 | Speed (samples/sec) 23428.7592 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:10.04051080 ms
avg iteration GPU training time:243.14921909 ms
avg iteration (step) total cpu time:262.88837857 ms
Epoch Time(s): 10.0010
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3612 | Train Acc 0.9047 | Speed (samples/sec) 23417.5588 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

avg iteration(step) data from cpu to GPU time:9.53729310 ms
avg iteration GPU training time:240.80174199 ms
avg iteration (step) total cpu time:260.07979888 ms
Epoch Time(s): 9.7837
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3652 | Train Acc 0.9060 | Speed (samples/sec) 23414.6907 | GPU 10160.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.92210340499878  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.92210340499878  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

avg iteration(step) data from cpu to GPU time:9.44849081 ms
avg iteration GPU training time:221.19462472 ms
avg iteration (step) total cpu time:239.85634910 ms
Epoch Time(s): 9.4276
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3554 | Train Acc 0.9076 | Speed (samples/sec) 23427.0393 | GPU 10162.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

avg iteration(step) data from cpu to GPU time:10.52261098 ms
avg iteration GPU training time:237.42398015 ms
avg iteration (step) total cpu time:258.72124566 ms
Epoch Time(s): 10.0528
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3392 | Train Acc 0.9097 | Speed (samples/sec) 23415.7883 | GPU 10162.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.924599170684814  GigaBytes

avg iteration(step) data from cpu to GPU time:9.87444503 ms
avg iteration GPU training time:234.14455951 ms
avg iteration (step) total cpu time:253.73489768 ms
Epoch Time(s): 9.7712
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3420 | Train Acc 0.9066 | Speed (samples/sec) 23416.1273 | GPU 10162.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.924599170684814  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.924599170684814  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:10.41523208 ms
avg iteration GPU training time:233.53735747 ms
avg iteration (step) total cpu time:253.62443041 ms
Epoch Time(s): 9.7788
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3343 | Train Acc 0.9079 | Speed (samples/sec) 23413.6844 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

[2021-06-17 18:13:56,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:13:56,519] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=3639.61414363071
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.11841901 ms
avg iteration GPU training time:239.46738688 ms
avg iteration (step) total cpu time:257.75439651 ms
Epoch Time(s): 9.9555
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3288 | Train Acc 0.9110 | Speed (samples/sec) 23406.5926 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.99886809 ms
avg iteration GPU training time:231.84710354 ms
avg iteration (step) total cpu time:251.52973776 ms
Epoch Time(s): 9.5253
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3397 | Train Acc 0.9108 | Speed (samples/sec) 23411.3410 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.65580093 ms
avg iteration GPU training time:237.36272628 ms
avg iteration (step) total cpu time:256.41170254 ms
Epoch Time(s): 9.8771
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3371 | Train Acc 0.9131 | Speed (samples/sec) 23408.9480 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.91885517 ms
avg iteration GPU training time:232.97353391 ms
avg iteration (step) total cpu time:252.20662576 ms
Epoch Time(s): 9.5937
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.3481 | Train Acc 0.9098 | Speed (samples/sec) 23414.2488 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.01316860 ms
avg iteration GPU training time:226.63617226 ms
avg iteration (step) total cpu time:245.51944379 ms
Epoch Time(s): 9.4738
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3627 | Train Acc 0.9065 | Speed (samples/sec) 23424.4666 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:8.73656654 ms
avg iteration GPU training time:226.14979214 ms
avg iteration (step) total cpu time:243.44600572 ms
Epoch Time(s): 9.3047
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3316 | Train Acc 0.9164 | Speed (samples/sec) 23437.5033 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:10.15300850 ms
avg iteration GPU training time:241.26361084 ms
avg iteration (step) total cpu time:260.87979034 ms
Epoch Time(s): 9.8832
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.3547 | Train Acc 0.9068 | Speed (samples/sec) 23431.0224 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.12793361 ms
avg iteration GPU training time:238.42326129 ms
avg iteration (step) total cpu time:256.35985092 ms
Epoch Time(s): 9.9380
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.3579 | Train Acc 0.9038 | Speed (samples/sec) 23431.3369 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.26879881 ms
avg iteration GPU training time:220.39946436 ms
avg iteration (step) total cpu time:238.85176800 ms
Epoch Time(s): 9.3826
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.3634 | Train Acc 0.8991 | Speed (samples/sec) 23443.9989 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:8.83118698 ms
avg iteration GPU training time:238.97962330 ms
avg iteration (step) total cpu time:257.06037769 ms
Epoch Time(s): 9.6989
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.3860 | Train Acc 0.8958 | Speed (samples/sec) 23442.5354 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

[2021-06-17 18:15:32,849] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:15:32,849] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=3646.545489944336
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.45936954 ms
avg iteration GPU training time:235.84409361 ms
avg iteration (step) total cpu time:254.80520284 ms
Epoch Time(s): 9.6516
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.3354 | Train Acc 0.9134 | Speed (samples/sec) 23441.9344 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.59449129 ms
avg iteration GPU training time:234.62243257 ms
avg iteration (step) total cpu time:253.93533707 ms
Epoch Time(s): 9.7913
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.3591 | Train Acc 0.9060 | Speed (samples/sec) 23439.6338 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.50003794 ms
avg iteration GPU training time:252.63170539 ms
avg iteration (step) total cpu time:271.52041153 ms
Epoch Time(s): 10.3619
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.3703 | Train Acc 0.9033 | Speed (samples/sec) 23421.9926 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.13210081 ms
avg iteration GPU training time:227.21473242 ms
avg iteration (step) total cpu time:245.38511700 ms
Epoch Time(s): 9.5296
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.3508 | Train Acc 0.9063 | Speed (samples/sec) 23427.3150 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.18208232 ms
avg iteration GPU training time:231.58284788 ms
avg iteration (step) total cpu time:250.14675105 ms
Epoch Time(s): 9.5925
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.3588 | Train Acc 0.9070 | Speed (samples/sec) 23432.1840 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:11.17661745 ms
avg iteration GPU training time:237.20991290 ms
avg iteration (step) total cpu time:257.97760045 ms
Epoch Time(s): 9.8133
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.3407 | Train Acc 0.9076 | Speed (samples/sec) 23428.4869 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.30929431 ms
avg iteration GPU training time:237.93577576 ms
avg iteration (step) total cpu time:256.10313592 ms
Epoch Time(s): 10.0328
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.3407 | Train Acc 0.9126 | Speed (samples/sec) 23426.9825 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.74152189 ms
avg iteration GPU training time:233.82506759 ms
avg iteration (step) total cpu time:253.01533275 ms
Epoch Time(s): 9.8181
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.3273 | Train Acc 0.9159 | Speed (samples/sec) 23425.3336 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.23621217 ms
avg iteration GPU training time:237.99742974 ms
avg iteration (step) total cpu time:256.56008720 ms
Epoch Time(s): 9.9155
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.3195 | Train Acc 0.9180 | Speed (samples/sec) 23420.7936 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.46548144 ms
avg iteration GPU training time:233.86623976 ms
avg iteration (step) total cpu time:252.66535194 ms
Epoch Time(s): 9.6692
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.3162 | Train Acc 0.9164 | Speed (samples/sec) 23422.5775 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70166015625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

[2021-06-17 18:17:11,112] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 18:17:11,112] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=3635.1066428312815
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:9.43177357 ms
avg iteration GPU training time:233.20817057 ms
avg iteration (step) total cpu time:251.57526687 ms
Epoch Time(s): 9.7376
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.3368 | Train Acc 0.9090 | Speed (samples/sec) 23421.4857 | GPU 10166.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.71142578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70947265625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70361328125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.70556640625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.70751953125GB

Max Memory Allocated 9.928089618682861  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69970703125GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.928089618682861  GigaBytes

avg iteration(step) data from cpu to GPU time:10.22253628 ms
avg iteration GPU training time:241.34663391 ms
avg iteration (step) total cpu time:260.86875244 ms
Epoch Time(s): 9.9611
Eval Acc 0.9091
Test Acc: 0.7505
Avg epoch time(time.time()): 9740.241115291914 ms
total avg iteration(step) data from cpu to GPU time:9.59492605 ms
total avg iteration GPU training time:234.65622108 ms
total avg iteration (step) total cpu time:253.65097557 ms
