[2021-06-17 23:13:07,550] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 23:13:11,231] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_mini_batch_train.py --aggre lstm --batch-size 24577 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 23:13:12,139] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 23:13:12,139] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 23:13:12,139] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 23:13:12,140] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 23:13:12,140] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623971597.6587784
before load_ogb step Time(s): 0.0018
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.83984375, 'VmSize': 20541.8671875, 'VmHWM': 1165.53515625, 'VmRSS': 1165.53515625}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6508
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2833
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0867
-------------------------------------------------end of load ogb****************** step Time(s): 0.0567
finish constructing ogbn-products
load ogb-products time total: 2.07910418510437
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0800
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8196
after train_g.create_formats_() step Time(s): 1.8626
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 24577
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 23:13:25,450] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 23:13:25,450] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 23:13:25,454] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 23:13:27,786] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.4906063079833984 seconds
[2021-06-17 23:13:30,704] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 23:13:30,704] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 23:13:30,704] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 23:13:30,704] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 23:13:30,704] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f4d4c6d0208>
[2021-06-17 23:13:30,704] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:13:30,704] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 23:13:30,705] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 23:13:30,706] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 23:13:30,707] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 23:13:30,707] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 23:13:30,707] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 23:13:30,709] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.5152900218963623 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.78564453125GB

Max Memory Allocated 1.3899211883544922  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.88720703125GB

Max Memory Allocated 1.3899211883544922  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.17822265625GB

Max Memory Allocated 27.320537567138672  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.17822265625GB

Max Memory Allocated 27.320537567138672  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.20361328125GB

Max Memory Allocated 27.320537567138672  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.20361328125GB

Max Memory Allocated 27.320537567138672  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7971 | Train Acc 0.0322 | Speed (samples/sec) nan | GPU 27976.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.14111328125GB

Max Memory Allocated 27.320537567138672  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.14111328125GB

Max Memory Allocated 27.320537567138672  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.18017578125GB

Max Memory Allocated 27.320537567138672  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.08642578125GB

Max Memory Allocated 27.378862857818604  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.06103515625GB

Max Memory Allocated 27.378862857818604  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.07080078125GB

Max Memory Allocated 27.378862857818604  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.07080078125GB

Max Memory Allocated 27.378862857818604  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.00830078125GB

Max Memory Allocated 27.378862857818604  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.00830078125GB

Max Memory Allocated 27.378862857818604  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.04736328125GB

Max Memory Allocated 27.378862857818604  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.08642578125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.06103515625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.07080078125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.07080078125GB

Max Memory Allocated 27.3891544342041  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.00634765625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.00634765625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.04541015625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.02978515625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.00634765625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.01416015625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.01416015625GB

Max Memory Allocated 27.3891544342041  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.94970703125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.94970703125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.98876953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.03369140625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.00830078125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.01806640625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.01806640625GB

Max Memory Allocated 27.3891544342041  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.95556640625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.95556640625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.99462890625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.03759765625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.01220703125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.02197265625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.02197265625GB

Max Memory Allocated 27.3891544342041  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.95947265625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.95947265625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.99853515625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.03759765625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.01220703125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.02197265625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.02197265625GB

Max Memory Allocated 27.3891544342041  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.99658203125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.03759765625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.01416015625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.02197265625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.02197265625GB

Max Memory Allocated 27.3891544342041  GigaBytes

avg iteration(step) data from cpu to GPU time:29.06282616 ms
avg iteration GPU training time:414.60148112 ms
avg iteration (step) total cpu time:458.65726471 ms
Epoch Time(s): 7.9091
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.99658203125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.03564453125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.01025390625GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.02001953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.02001953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.7428 | Train Acc 0.5160 | Speed (samples/sec) 41383.1907 | GPU 28046.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.99658203125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.03564453125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.01220703125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.02001953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

[2021-06-17 23:13:43,269] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 23:13:43,384] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=3051.600801114474
-----------------------------------------after batch engine step
 Nvidia-smi: 30.02001953125GB

Max Memory Allocated 27.3891544342041  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.95751953125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.99658203125GB

Max Memory Allocated 27.3891544342041  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

avg iteration(step) data from cpu to GPU time:28.01701355 ms
avg iteration GPU training time:424.00381470 ms
avg iteration (step) total cpu time:468.12884013 ms
Epoch Time(s): 6.3982
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

Epoch 00002 | Step 00000 | Loss 1.0150 | Train Acc 0.7358 | Speed (samples/sec) 44344.2834 | GPU 28095.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

[2021-06-17 23:13:50,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:13:50,633] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=3302.576244457501
-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.50830078125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.43726634979248  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.43726634979248  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.449260234832764  GigaBytes

avg iteration(step) data from cpu to GPU time:28.30425580 ms
avg iteration GPU training time:414.99162801 ms
avg iteration (step) total cpu time:459.48688189 ms
Epoch Time(s): 6.2115
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.449260234832764  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.7131 | Train Acc 0.8300 | Speed (samples/sec) 45591.9352 | GPU 28108.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.449260234832764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

[2021-06-17 23:13:57,715] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:13:57,830] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=3367.7689134834527
-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.50830078125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

avg iteration(step) data from cpu to GPU time:28.39187177 ms
avg iteration GPU training time:414.20416260 ms
avg iteration (step) total cpu time:460.44500669 ms
Epoch Time(s): 6.2792
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.5755 | Train Acc 0.8639 | Speed (samples/sec) 45802.2319 | GPU 28110.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

[2021-06-17 23:14:04,858] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:04,971] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=3414.538632086356
-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

avg iteration(step) data from cpu to GPU time:26.01627731 ms
avg iteration GPU training time:413.90302531 ms
avg iteration (step) total cpu time:455.95033964 ms
Epoch Time(s): 6.2357
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.4895 | Train Acc 0.8829 | Speed (samples/sec) 46244.0001 | GPU 28110.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53369140625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.51806640625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53955078125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

avg iteration(step) data from cpu to GPU time:28.21059227 ms
avg iteration GPU training time:417.17831421 ms
avg iteration (step) total cpu time:459.64837074 ms
Epoch Time(s): 6.3517
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.4426 | Train Acc 0.8894 | Speed (samples/sec) 46398.2143 | GPU 28110.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

[2021-06-17 23:14:15,226] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:15,339] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=3433.2179460629313
-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53955078125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

avg iteration(step) data from cpu to GPU time:25.75039991 ms
avg iteration GPU training time:413.58674113 ms
avg iteration (step) total cpu time:452.95627912 ms
Epoch Time(s): 6.8665
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.4161 | Train Acc 0.8959 | Speed (samples/sec) 46484.5211 | GPU 28110.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53955078125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51416015625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

[2021-06-17 23:14:22,402] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:22,516] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=3458.9249142149206
-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

avg iteration(step) data from cpu to GPU time:26.46564293 ms
avg iteration GPU training time:416.12298584 ms
avg iteration (step) total cpu time:460.78721682 ms
Epoch Time(s): 6.1253
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.4078 | Train Acc 0.8956 | Speed (samples/sec) 46650.6063 | GPU 28110.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51025390625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45751953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49658203125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53759765625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.52001953125GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45556640625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49462890625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.53564453125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.51220703125GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

[2021-06-17 23:14:29,711] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:29,825] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=3469.952784946505
-----------------------------------------after batch engine step
 Nvidia-smi: 31.52197265625GB

Max Memory Allocated 27.45201349258423  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.45947265625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.49853515625GB

Max Memory Allocated 27.45201349258423  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.30517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.27783203125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.28759765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.28759765625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.22314453125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.22314453125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.26220703125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.30712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.28369140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.29150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:28.82888540 ms
avg iteration GPU training time:618.33113607 ms
avg iteration (step) total cpu time:660.93301773 ms
Epoch Time(s): 7.0238
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.22705078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.22705078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.26611328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77197265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.74658203125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.75634765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.75634765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3912 | Train Acc 0.8984 | Speed (samples/sec) 46223.1943 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77197265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.74853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.75634765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.75634765625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69189453125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73095703125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.77587890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.75048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.76025390625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.73681640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.61181640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.58642578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.59619140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.59619140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.57275390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.61376953125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.58642578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.59619140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.59619140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.57080078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03759765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03759765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07666015625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:14:37,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:37,763] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=3422.071624798854
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06103515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:28.47032547 ms
avg iteration GPU training time:410.37217204 ms
avg iteration (step) total cpu time:452.39265760 ms
Epoch Time(s): 6.4456
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03759765625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3671 | Train Acc 0.9047 | Speed (samples/sec) 46334.8601 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:28.40461858 ms
avg iteration GPU training time:412.74053955 ms
avg iteration (step) total cpu time:455.63602448 ms
Epoch Time(s): 6.2671
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3630 | Train Acc 0.9056 | Speed (samples/sec) 46391.0908 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:14:47,523] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:47,637] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=3435.878809637763
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:27.16675123 ms
avg iteration GPU training time:414.96735636 ms
avg iteration (step) total cpu time:456.60082499 ms
Epoch Time(s): 6.3761
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3506 | Train Acc 0.9078 | Speed (samples/sec) 46464.5445 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:14:54,845] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:14:54,959] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=3449.057393774351
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:26.70083173 ms
avg iteration GPU training time:415.65621948 ms
avg iteration (step) total cpu time:457.73108800 ms
Epoch Time(s): 6.3616
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3367 | Train Acc 0.9111 | Speed (samples/sec) 46577.3708 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:15:02,130] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:02,245] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=3452.4256907301715
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:25.47795169 ms
avg iteration GPU training time:445.84760539 ms
avg iteration (step) total cpu time:487.57640521 ms
Epoch Time(s): 6.3851
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3320 | Train Acc 0.9108 | Speed (samples/sec) 46476.5484 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:15:09,634] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:09,748] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=3451.9750253174752
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:31.82929039 ms
avg iteration GPU training time:420.11575317 ms
avg iteration (step) total cpu time:467.15037028 ms
Epoch Time(s): 6.5699
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3220 | Train Acc 0.9135 | Speed (samples/sec) 46454.3926 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08251953125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:27.39178658 ms
avg iteration GPU training time:416.85403442 ms
avg iteration (step) total cpu time:458.83973440 ms
Epoch Time(s): 6.3867
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.3387 | Train Acc 0.9083 | Speed (samples/sec) 46473.9172 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:15:19,673] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:19,785] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=3461.25869523158
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:32.79409091 ms
avg iteration GPU training time:417.12240601 ms
avg iteration (step) total cpu time:463.47196897 ms
Epoch Time(s): 6.4017
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.3182 | Train Acc 0.9148 | Speed (samples/sec) 46511.3367 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:15:27,444] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:27,558] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=3470.1223135872506
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:28.08222898 ms
avg iteration GPU training time:421.56431071 ms
avg iteration (step) total cpu time:462.37850189 ms
Epoch Time(s): 6.8741
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.3170 | Train Acc 0.9144 | Speed (samples/sec) 46575.8280 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.07861328125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

[2021-06-17 23:15:34,876] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:34,990] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=3472.7982122711705
-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05712890625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

avg iteration(step) data from cpu to GPU time:26.33118884 ms
avg iteration GPU training time:415.87508138 ms
avg iteration (step) total cpu time:458.94471804 ms
Epoch Time(s): 6.5225
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.3234 | Train Acc 0.9140 | Speed (samples/sec) 46611.8891 | GPU 28112.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05322265625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06298828125GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.03955078125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.08056640625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.05517578125GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.06494140625GB

Max Memory Allocated 27.454015254974365  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.04150390625GB

Max Memory Allocated 27.454015254974365  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.37548828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.34814453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.29345703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.29345703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.33251953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.37353515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.35009765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.35791015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.29345703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.29345703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.33251953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.37744140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.35205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.36181640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.36181640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.29931640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.33837890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52587890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:15:42,692] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:42,805] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=3451.1070965638987
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.12116241 ms
avg iteration GPU training time:413.78612264 ms
avg iteration (step) total cpu time:457.34000206 ms
Epoch Time(s): 6.8743
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52587890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2975 | Train Acc 0.9201 | Speed (samples/sec) 46482.1983 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52587890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52587890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.49853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52587890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44580078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52587890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.55689621 ms
avg iteration GPU training time:420.10364787 ms
avg iteration (step) total cpu time:462.55954107 ms
Epoch Time(s): 6.4836
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.3016 | Train Acc 0.9192 | Speed (samples/sec) 46501.2086 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:15:52,882] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:15:52,995] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=3457.45544485247
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.42088572 ms
avg iteration GPU training time:416.50661214 ms
avg iteration (step) total cpu time:457.86396662 ms
Epoch Time(s): 6.4666
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3081 | Train Acc 0.9185 | Speed (samples/sec) 46558.8524 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:00,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:00,243] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=3464.945807072424
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:25.51735433 ms
avg iteration GPU training time:411.66093953 ms
avg iteration (step) total cpu time:450.69193840 ms
Epoch Time(s): 6.2494
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.3019 | Train Acc 0.9184 | Speed (samples/sec) 46634.8450 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:07,323] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:07,437] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=3471.04224949616
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.88096046 ms
avg iteration GPU training time:416.62478638 ms
avg iteration (step) total cpu time:462.84230550 ms
Epoch Time(s): 6.3427
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.3097 | Train Acc 0.9161 | Speed (samples/sec) 46657.7024 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:14,658] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:14,772] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=3477.345491893166
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.11148834 ms
avg iteration GPU training time:412.78088379 ms
avg iteration (step) total cpu time:455.54661751 ms
Epoch Time(s): 6.3947
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2943 | Train Acc 0.9190 | Speed (samples/sec) 46700.6280 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:30.20806376 ms
avg iteration GPU training time:412.02533976 ms
avg iteration (step) total cpu time:459.08602079 ms
Epoch Time(s): 6.3987
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2891 | Train Acc 0.9201 | Speed (samples/sec) 46712.0468 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:24,645] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:24,759] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=3478.890172700833
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:30.48504512 ms
avg iteration GPU training time:418.35253906 ms
avg iteration (step) total cpu time:468.20497513 ms
Epoch Time(s): 6.4807
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2865 | Train Acc 0.9233 | Speed (samples/sec) 46696.2948 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:32,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:32,166] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=3481.003688603391
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.93585014 ms
avg iteration GPU training time:413.38931274 ms
avg iteration (step) total cpu time:457.01313019 ms
Epoch Time(s): 6.3493
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2899 | Train Acc 0.9197 | Speed (samples/sec) 46737.0904 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:39,334] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:39,450] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=3484.9588294873024
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.48321088 ms
avg iteration GPU training time:416.00574748 ms
avg iteration (step) total cpu time:458.88392131 ms
Epoch Time(s): 6.3631
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2827 | Train Acc 0.9214 | Speed (samples/sec) 46752.1320 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:46,626] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:46,740] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=3487.7859461720295
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:30.85820834 ms
avg iteration GPU training time:409.15055339 ms
avg iteration (step) total cpu time:453.53062948 ms
Epoch Time(s): 6.4215
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2873 | Train Acc 0.9214 | Speed (samples/sec) 46763.5251 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:31.82156817 ms
avg iteration GPU training time:411.13113403 ms
avg iteration (step) total cpu time:458.82829030 ms
Epoch Time(s): 6.4232
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.2967 | Train Acc 0.9203 | Speed (samples/sec) 46747.6199 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:16:56,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:16:56,841] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=3485.3917593309498
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.38808568 ms
avg iteration GPU training time:418.35937500 ms
avg iteration (step) total cpu time:459.87502734 ms
Epoch Time(s): 6.4587
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2786 | Train Acc 0.9231 | Speed (samples/sec) 46749.4643 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:04,032] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:04,146] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=3488.0737374232463
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.79296048 ms
avg iteration GPU training time:410.99606323 ms
avg iteration (step) total cpu time:451.71085993 ms
Epoch Time(s): 6.2929
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2783 | Train Acc 0.9242 | Speed (samples/sec) 46789.4465 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:11,247] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:11,361] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=3492.6858689289656
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.29448509 ms
avg iteration GPU training time:411.14533488 ms
avg iteration (step) total cpu time:452.04528173 ms
Epoch Time(s): 6.3370
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2791 | Train Acc 0.9224 | Speed (samples/sec) 46823.5457 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:18,567] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:18,681] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=3496.6498899887356
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.43254407 ms
avg iteration GPU training time:416.69498698 ms
avg iteration (step) total cpu time:456.03775978 ms
Epoch Time(s): 6.3655
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2870 | Train Acc 0.9219 | Speed (samples/sec) 46827.5963 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.25148773 ms
avg iteration GPU training time:419.28904215 ms
avg iteration (step) total cpu time:461.74001694 ms
Epoch Time(s): 6.3893
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2618 | Train Acc 0.9278 | Speed (samples/sec) 46843.9531 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:28,620] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:28,735] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=3496.9175530928987
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99658203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97119140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98095703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:31.44982338 ms
avg iteration GPU training time:413.53459676 ms
avg iteration (step) total cpu time:458.85928472 ms
Epoch Time(s): 6.4865
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2812 | Train Acc 0.9240 | Speed (samples/sec) 46841.7612 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.91845703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95751953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:36,071] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:36,185] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=3495.919056950021
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.06124878 ms
avg iteration GPU training time:414.82799276 ms
avg iteration (step) total cpu time:459.94432767 ms
Epoch Time(s): 6.5119
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2828 | Train Acc 0.9248 | Speed (samples/sec) 46817.7755 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:43,453] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:43,566] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=3497.867825491468
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.05320549 ms
avg iteration GPU training time:410.36077881 ms
avg iteration (step) total cpu time:450.91176033 ms
Epoch Time(s): 6.4169
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2853 | Train Acc 0.9217 | Speed (samples/sec) 46832.8040 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:17:50,658] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:17:50,771] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=3501.4590210297715
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:30.03890165 ms
avg iteration GPU training time:409.87408447 ms
avg iteration (step) total cpu time:454.11181450 ms
Epoch Time(s): 6.3121
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2786 | Train Acc 0.9225 | Speed (samples/sec) 46852.3695 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.05805906 ms
avg iteration GPU training time:415.43574015 ms
avg iteration (step) total cpu time:461.59029007 ms
Epoch Time(s): 6.5370
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2768 | Train Acc 0.9247 | Speed (samples/sec) 46850.2269 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:00,891] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:01,004] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=3501.433375101612
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:32.18528048 ms
avg iteration GPU training time:414.87012736 ms
avg iteration (step) total cpu time:462.01705933 ms
Epoch Time(s): 6.5059
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2732 | Train Acc 0.9242 | Speed (samples/sec) 46854.1178 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:08,356] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:08,470] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=3503.6402499250885
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.52451197 ms
avg iteration GPU training time:411.97539266 ms
avg iteration (step) total cpu time:454.37359810 ms
Epoch Time(s): 6.4756
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2769 | Train Acc 0.9244 | Speed (samples/sec) 46882.6280 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:15,577] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:15,692] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=3506.4576691116863
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:25.64944013 ms
avg iteration GPU training time:410.43872070 ms
avg iteration (step) total cpu time:451.71093941 ms
Epoch Time(s): 6.2806
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2750 | Train Acc 0.9254 | Speed (samples/sec) 46905.1106 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:22,907] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:23,022] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=3509.4442591626776
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.37755775 ms
avg iteration GPU training time:410.83525594 ms
avg iteration (step) total cpu time:453.48564784 ms
Epoch Time(s): 6.4260
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2706 | Train Acc 0.9264 | Speed (samples/sec) 46932.8426 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.57502937 ms
avg iteration GPU training time:409.60066732 ms
avg iteration (step) total cpu time:453.87236277 ms
Epoch Time(s): 6.3408
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2828 | Train Acc 0.9244 | Speed (samples/sec) 46959.4923 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:32,842] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:32,957] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=3510.294452220846
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:34.28790410 ms
avg iteration GPU training time:422.25565592 ms
avg iteration (step) total cpu time:473.19436073 ms
Epoch Time(s): 6.4837
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2667 | Train Acc 0.9286 | Speed (samples/sec) 46936.9392 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:40,505] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:40,620] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=3511.0263612493145
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.67310969 ms
avg iteration GPU training time:419.02263387 ms
avg iteration (step) total cpu time:458.32912127 ms
Epoch Time(s): 6.6371
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2767 | Train Acc 0.9236 | Speed (samples/sec) 46957.9794 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:47,765] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:47,879] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=3512.9141571622595
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.92688052 ms
avg iteration GPU training time:411.26600138 ms
avg iteration (step) total cpu time:456.76461856 ms
Epoch Time(s): 6.3093
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2648 | Train Acc 0.9292 | Speed (samples/sec) 46968.8316 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:18:55,021] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:18:55,135] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=3515.6071726853047
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.19271469 ms
avg iteration GPU training time:413.25281779 ms
avg iteration (step) total cpu time:454.58086332 ms
Epoch Time(s): 6.3553
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2758 | Train Acc 0.9243 | Speed (samples/sec) 46988.9435 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:32.37779236 ms
avg iteration GPU training time:411.44253540 ms
avg iteration (step) total cpu time:459.26944415 ms
Epoch Time(s): 6.7283
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2632 | Train Acc 0.9279 | Speed (samples/sec) 47000.0096 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:05,344] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:05,456] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=3517.307223192965
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:31.44379807 ms
avg iteration GPU training time:414.08407593 ms
avg iteration (step) total cpu time:459.95521545 ms
Epoch Time(s): 6.3510
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2700 | Train Acc 0.9262 | Speed (samples/sec) 47014.6972 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:12,664] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:12,782] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=3519.100618767792
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.23422941 ms
avg iteration GPU training time:413.55960083 ms
avg iteration (step) total cpu time:457.47637749 ms
Epoch Time(s): 6.4558
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2592 | Train Acc 0.9274 | Speed (samples/sec) 47016.2222 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:19,957] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:20,071] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=3521.0053743224667
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.88094902 ms
avg iteration GPU training time:416.11206055 ms
avg iteration (step) total cpu time:460.26364962 ms
Epoch Time(s): 6.3768
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2619 | Train Acc 0.9273 | Speed (samples/sec) 47028.2479 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:27,347] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:27,461] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=3520.5072347265186
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.37318357 ms
avg iteration GPU training time:413.33518473 ms
avg iteration (step) total cpu time:453.69044940 ms
Epoch Time(s): 6.4636
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2806 | Train Acc 0.9234 | Speed (samples/sec) 47022.8353 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:25.86678378 ms
avg iteration GPU training time:410.76239014 ms
avg iteration (step) total cpu time:452.00856527 ms
Epoch Time(s): 6.4813
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2588 | Train Acc 0.9282 | Speed (samples/sec) 47037.8283 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:39,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:39,309] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=3521.138698030063
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:30.41058095 ms
avg iteration GPU training time:412.86044312 ms
avg iteration (step) total cpu time:459.17852720 ms
Epoch Time(s): 8.0802
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2513 | Train Acc 0.9308 | Speed (samples/sec) 47035.9361 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:47,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:47,627] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=3522.796284461987
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.36490631 ms
avg iteration GPU training time:413.86212158 ms
avg iteration (step) total cpu time:458.25449626 ms
Epoch Time(s): 7.4203
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2656 | Train Acc 0.9268 | Speed (samples/sec) 47041.3059 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:19:55,144] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:19:55,259] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=3523.057858837818
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.88112005 ms
avg iteration GPU training time:424.08747355 ms
avg iteration (step) total cpu time:468.62920125 ms
Epoch Time(s): 6.7024
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2636 | Train Acc 0.9258 | Speed (samples/sec) 47037.7698 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:02,478] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:02,592] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=3523.7283800571618
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.82892799 ms
avg iteration GPU training time:414.62358602 ms
avg iteration (step) total cpu time:457.77908961 ms
Epoch Time(s): 6.3954
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2482 | Train Acc 0.9307 | Speed (samples/sec) 47055.0165 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.90710386 ms
avg iteration GPU training time:412.32214355 ms
avg iteration (step) total cpu time:457.23732313 ms
Epoch Time(s): 6.3297
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2630 | Train Acc 0.9288 | Speed (samples/sec) 47068.4673 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:12,386] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:12,499] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=3525.050621552027
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.44547208 ms
avg iteration GPU training time:410.18987020 ms
avg iteration (step) total cpu time:451.13484065 ms
Epoch Time(s): 6.3846
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2619 | Train Acc 0.9285 | Speed (samples/sec) 47081.4216 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:19,753] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:19,867] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=3526.779027719973
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.75203196 ms
avg iteration GPU training time:411.97515869 ms
avg iteration (step) total cpu time:463.28075727 ms
Epoch Time(s): 6.4092
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2589 | Train Acc 0.9283 | Speed (samples/sec) 47093.9307 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:27,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:27,150] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=3528.072054541713
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.65718397 ms
avg iteration GPU training time:416.34513346 ms
avg iteration (step) total cpu time:467.51125654 ms
Epoch Time(s): 6.3799
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2646 | Train Acc 0.9297 | Speed (samples/sec) 47094.3158 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:34,289] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:34,403] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=3528.923483388112
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.83128548 ms
avg iteration GPU training time:427.40570068 ms
avg iteration (step) total cpu time:469.21873093 ms
Epoch Time(s): 6.3100
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2648 | Train Acc 0.9282 | Speed (samples/sec) 47099.6349 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:31.84419250 ms
avg iteration GPU training time:412.86562093 ms
avg iteration (step) total cpu time:458.18495750 ms
Epoch Time(s): 6.4410
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2589 | Train Acc 0.9275 | Speed (samples/sec) 47111.2362 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:44,313] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:44,428] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=3529.217532876689
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.87247976 ms
avg iteration GPU training time:412.57151286 ms
avg iteration (step) total cpu time:456.04451497 ms
Epoch Time(s): 6.3614
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2518 | Train Acc 0.9309 | Speed (samples/sec) 47120.6592 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:51,646] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:51,761] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=3530.149727334217
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.53723717 ms
avg iteration GPU training time:413.90328979 ms
avg iteration (step) total cpu time:460.61825752 ms
Epoch Time(s): 6.4462
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2631 | Train Acc 0.9270 | Speed (samples/sec) 47127.9614 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:20:59,250] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:20:59,366] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=3530.785361753828
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.10520554 ms
avg iteration GPU training time:413.30093384 ms
avg iteration (step) total cpu time:453.48207156 ms
Epoch Time(s): 6.6621
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2638 | Train Acc 0.9268 | Speed (samples/sec) 47133.5088 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:06,631] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:06,747] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=3531.5779685314346
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.18298721 ms
avg iteration GPU training time:413.30551147 ms
avg iteration (step) total cpu time:455.40078481 ms
Epoch Time(s): 6.4306
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2556 | Train Acc 0.9294 | Speed (samples/sec) 47137.5287 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.39493370 ms
avg iteration GPU training time:412.48691813 ms
avg iteration (step) total cpu time:452.25548744 ms
Epoch Time(s): 6.6493
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2639 | Train Acc 0.9258 | Speed (samples/sec) 47150.0261 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:16,873] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:16,989] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=3531.6769086848726
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:36.73598925 ms
avg iteration GPU training time:420.60254924 ms
avg iteration (step) total cpu time:474.17561213 ms
Epoch Time(s): 6.4400
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2579 | Train Acc 0.9291 | Speed (samples/sec) 47146.8525 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:24,296] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:24,410] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=3531.6529471708636
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97705078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.84995206 ms
avg iteration GPU training time:419.01571655 ms
avg iteration (step) total cpu time:460.98319689 ms
Epoch Time(s): 6.4276
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2541 | Train Acc 0.9290 | Speed (samples/sec) 47146.1378 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:31,607] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:31,721] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=3532.568740751608
-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.99853515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.65210660 ms
avg iteration GPU training time:412.92812093 ms
avg iteration (step) total cpu time:454.45537567 ms
Epoch Time(s): 6.4174
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97314453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98291015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2483 | Train Acc 0.9314 | Speed (samples/sec) 47155.7711 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92041015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.95947265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.00048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.97509765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.98486328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.92236328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.96142578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50244140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51220703125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44970703125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48876953125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52783203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50048828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.44775390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.48681640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.52978515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50439453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:38,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:39,101] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=3532.735366759422
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51416015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.28557841 ms
avg iteration GPU training time:409.97212728 ms
avg iteration (step) total cpu time:454.06762759 ms
Epoch Time(s): 6.4406
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45166015625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49072265625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53564453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2671 | Train Acc 0.9268 | Speed (samples/sec) 47155.3864 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.91528511 ms
avg iteration GPU training time:410.41647339 ms
avg iteration (step) total cpu time:453.25891177 ms
Epoch Time(s): 6.3961
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2624 | Train Acc 0.9262 | Speed (samples/sec) 47163.2924 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:49,010] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:49,124] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=3533.82714906301
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.27492332 ms
avg iteration GPU training time:409.30495199 ms
avg iteration (step) total cpu time:449.50000445 ms
Epoch Time(s): 6.3110
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2571 | Train Acc 0.9288 | Speed (samples/sec) 47179.1422 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:21:56,234] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:21:56,349] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=3534.4255714762785
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:25.44882139 ms
avg iteration GPU training time:409.71928914 ms
avg iteration (step) total cpu time:448.85627429 ms
Epoch Time(s): 6.3368
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53564453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2535 | Train Acc 0.9269 | Speed (samples/sec) 47186.2041 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:03,672] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:03,787] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=3534.282558827691
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.11518860 ms
avg iteration GPU training time:428.59472656 ms
avg iteration (step) total cpu time:471.46709760 ms
Epoch Time(s): 6.5577
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2506 | Train Acc 0.9282 | Speed (samples/sec) 47167.4714 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53564453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:11,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:11,150] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=3535.05883147679
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.43348312 ms
avg iteration GPU training time:414.93618774 ms
avg iteration (step) total cpu time:457.92198181 ms
Epoch Time(s): 6.4469
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50634765625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2550 | Train Acc 0.9280 | Speed (samples/sec) 47171.9283 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53564453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.55310949 ms
avg iteration GPU training time:413.47027588 ms
avg iteration (step) total cpu time:455.94700178 ms
Epoch Time(s): 6.4005
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2534 | Train Acc 0.9296 | Speed (samples/sec) 47166.3280 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:21,121] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:21,235] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=3533.695155962375
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.50309308 ms
avg iteration GPU training time:412.70635986 ms
avg iteration (step) total cpu time:454.76969083 ms
Epoch Time(s): 6.4549
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2563 | Train Acc 0.9290 | Speed (samples/sec) 47167.4973 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:28,469] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:28,584] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=3533.634647149981
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:28.22705078 ms
avg iteration GPU training time:411.65973918 ms
avg iteration (step) total cpu time:454.15282249 ms
Epoch Time(s): 6.3907
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2588 | Train Acc 0.9276 | Speed (samples/sec) 47172.4002 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53564453125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:35,841] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:35,955] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=3533.41440580455
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:29.77041117 ms
avg iteration GPU training time:415.28469849 ms
avg iteration (step) total cpu time:461.98678017 ms
Epoch Time(s): 6.4414
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2601 | Train Acc 0.9290 | Speed (samples/sec) 47164.7234 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53173828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51611328125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45556640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49462890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:43,122] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:43,235] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=3533.652982039157
-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.30345599 ms
avg iteration GPU training time:422.41522217 ms
avg iteration (step) total cpu time:464.12777901 ms
Epoch Time(s): 6.3640
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.50830078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2587 | Train Acc 0.9279 | Speed (samples/sec) 47162.3993 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.53369140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.51025390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.51806640625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.45361328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.49267578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:39.17338689 ms
avg iteration GPU training time:411.09457397 ms
avg iteration (step) total cpu time:466.31757418 ms
Epoch Time(s): 6.4196
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2522 | Train Acc 0.9287 | Speed (samples/sec) 47160.9852 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:22:53,110] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:22:53,225] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=3534.4330055310224
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.35939280 ms
avg iteration GPU training time:412.88613892 ms
avg iteration (step) total cpu time:455.97704252 ms
Epoch Time(s): 6.3467
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2519 | Train Acc 0.9300 | Speed (samples/sec) 47165.9978 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:23:00,366] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:00,481] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=3534.8032549346276
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:26.88475736 ms
avg iteration GPU training time:408.44672648 ms
avg iteration (step) total cpu time:451.35863622 ms
Epoch Time(s): 6.3499
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2516 | Train Acc 0.9287 | Speed (samples/sec) 47173.8572 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

[2021-06-17 23:23:07,745] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:07,859] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=3534.934218143226
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

avg iteration(step) data from cpu to GPU time:27.81226667 ms
avg iteration GPU training time:409.79256185 ms
avg iteration (step) total cpu time:453.34839821 ms
Epoch Time(s): 6.4619
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2535 | Train Acc 0.9299 | Speed (samples/sec) 47172.7441 | GPU 28147.0 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.48733949661255  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.48733949661255  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:23:15,096] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:15,209] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=3534.6420203650505
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:28.84240023 ms
avg iteration GPU training time:417.24519857 ms
avg iteration (step) total cpu time:462.91399002 ms
Epoch Time(s): 6.4409
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2559 | Train Acc 0.9291 | Speed (samples/sec) 47166.2918 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:37.09026146 ms
avg iteration GPU training time:429.55193075 ms
avg iteration (step) total cpu time:482.23916690 ms
Epoch Time(s): 6.5623
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2587 | Train Acc 0.9269 | Speed (samples/sec) 47146.5522 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:23:25,250] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:25,363] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=3533.2448396734194
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:33.30071449 ms
avg iteration GPU training time:416.05645752 ms
avg iteration (step) total cpu time:464.09106255 ms
Epoch Time(s): 6.3706
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2648 | Train Acc 0.9259 | Speed (samples/sec) 47147.1253 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:23:32,656] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:32,770] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=3533.935933330796
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:28.09024048 ms
avg iteration GPU training time:412.86643473 ms
avg iteration (step) total cpu time:455.12676239 ms
Epoch Time(s): 6.4739
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2493 | Train Acc 0.9299 | Speed (samples/sec) 47153.2504 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:23:40,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:40,271] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=3533.939423850548
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:28.36499151 ms
avg iteration GPU training time:412.75175985 ms
avg iteration (step) total cpu time:456.61973953 ms
Epoch Time(s): 6.5881
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2537 | Train Acc 0.9294 | Speed (samples/sec) 47151.8186 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:23:47,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:47,726] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=3533.105993597327
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:28.93585014 ms
avg iteration GPU training time:413.17471313 ms
avg iteration (step) total cpu time:456.86809222 ms
Epoch Time(s): 6.5162
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2513 | Train Acc 0.9287 | Speed (samples/sec) 47138.3459 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:28.40378698 ms
avg iteration GPU training time:408.92819214 ms
avg iteration (step) total cpu time:452.94674238 ms
Epoch Time(s): 6.3666
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2571 | Train Acc 0.9293 | Speed (samples/sec) 47147.3788 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:23:57,609] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:23:57,723] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=3532.9405756862793
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:28.76219749 ms
avg iteration GPU training time:442.77211507 ms
avg iteration (step) total cpu time:487.27854093 ms
Epoch Time(s): 6.5455
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2586 | Train Acc 0.9264 | Speed (samples/sec) 47123.9121 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:24:05,152] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:24:05,267] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=3531.613750666929
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:27.30317879 ms
avg iteration GPU training time:420.29838053 ms
avg iteration (step) total cpu time:464.81800079 ms
Epoch Time(s): 6.4615
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2462 | Train Acc 0.9316 | Speed (samples/sec) 47117.6584 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:24:12,760] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:24:12,874] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=3530.624100828196
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:26.52201589 ms
avg iteration GPU training time:415.06187948 ms
avg iteration (step) total cpu time:455.85107803 ms
Epoch Time(s): 6.6462
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2495 | Train Acc 0.9303 | Speed (samples/sec) 47109.5136 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

[2021-06-17 23:24:20,175] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:24:20,288] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=3530.3216447742234
-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:26.73748271 ms
avg iteration GPU training time:410.55821737 ms
avg iteration (step) total cpu time:453.45640182 ms
Epoch Time(s): 6.5273
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
8
2
91

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2605 | Train Acc 0.9290 | Speed (samples/sec) 47098.7566 | GPU 28194.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60400390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64306640625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68408203125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68212890625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65869140625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66650390625GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65478515625GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.60205078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.64111328125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.68017578125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.65673828125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.66455078125GB

Max Memory Allocated 27.533698558807373  GigaBytes

avg iteration(step) data from cpu to GPU time:26.40224012 ms
avg iteration GPU training time:428.47218831 ms
avg iteration (step) total cpu time:467.94176102 ms
Epoch Time(s): 6.6377
Eval Acc 0.9163
Test Acc: 0.7597
Avg epoch time(time.time()): 6478.406195839246 ms
total avg iteration(step) data from cpu to GPU time:28.53026486 ms
total avg iteration GPU training time:417.38590918 ms
total avg iteration (step) total cpu time:461.17781176 ms
