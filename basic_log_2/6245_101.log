[2021-06-17 23:39:17,535] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 23:39:21,197] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_mini_batch_train.py --aggre lstm --batch-size 6245 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 23:39:22,106] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 23:39:22,106] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 23:39:22,106] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 23:39:22,106] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 23:39:22,106] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623973167.624896
before load_ogb step Time(s): 0.0020
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.84765625, 'VmSize': 20541.86328125, 'VmHWM': 1164.94921875, 'VmRSS': 1164.94921875}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.5569
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2827
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0015
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.1029
-------------------------------------------------end of load ogb****************** step Time(s): 0.0351
finish constructing ogbn-products
load ogb-products time total: 1.9793765544891357
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.9802
after inductive else step Time(s): 0.0001
after label step Time(s): 3.6444
after train_g.create_formats_() step Time(s): 1.3981
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 6245
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 23:39:34,678] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 23:39:34,678] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 23:39:34,681] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 23:39:37,020] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.299262523651123 seconds
[2021-06-17 23:39:39,622] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 23:39:39,622] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 23:39:39,622] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 23:39:39,622] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 23:39:39,622] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f651cbce208>
[2021-06-17 23:39:39,622] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:39:39,622] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 23:39:39,623] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 23:39:39,624] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 23:39:39,625] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 23:39:39,625] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 23:39:39,627] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.2844007015228271 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.58837890625GB

Max Memory Allocated 1.189882755279541  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.66259765625GB

Max Memory Allocated 1.189882755279541  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 11.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 11.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 11.63720703125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 11.63720703125GB

Max Memory Allocated 9.890089511871338  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7265 | Train Acc 0.0307 | Speed (samples/sec) nan | GPU 10127.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 11.61376953125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 11.61376953125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 11.62744140625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10986328125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10986328125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.12158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.13330078125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.12939453125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.13134765625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.10791015625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.11962890625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62744140625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60205078125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60205078125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61376953125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59619140625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59619140625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61181640625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61181640625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61181640625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

[2021-06-17 23:39:45,485] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 23:39:45,519] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=6440.8391884014945
-----------------------------------------after batch engine step
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61181640625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.890089511871338  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.890089511871338  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.61962890625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59619140625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59619140625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62158203125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 12.62939453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 12.62353515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 12.62548828125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 12.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 12.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 12.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

[2021-06-17 23:39:47,956] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:39:47,990] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=6551.899084531643
-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60400390625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

[2021-06-17 23:39:50,372] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:39:50,407] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=6624.031593063628
-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.59619140625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.60400390625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

avg iteration(step) data from cpu to GPU time:10.55492853 ms
avg iteration GPU training time:223.17473744 ms
avg iteration (step) total cpu time:242.92562626 ms
Epoch Time(s): 10.1353
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.60791015625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.6382 | Train Acc 0.8442 | Speed (samples/sec) 24318.5122 | GPU 10128.8 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60400390625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59228515625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60400390625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58837890625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60009765625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.60986328125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.58642578125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.59814453125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.891366958618164  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.891366958618164  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

[2021-06-17 23:39:54,267] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:39:54,302] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=6648.813081075083
-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61572265625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61181640625GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61767578125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 13.61376953125GB

Max Memory Allocated 9.892158031463623  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 13.59033203125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 13.60205078125GB

Max Memory Allocated 9.892158031463623  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11962890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11767578125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11767578125GB

Max Memory Allocated 9.894766330718994  GigaBytes

[2021-06-17 23:39:56,902] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:39:56,936] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=6553.759150531455
-----------------------------------------after batch engine step
 Nvidia-smi: 14.11767578125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09423828125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09423828125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10595703125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11962890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11767578125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11962890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11767578125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10009765625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11767578125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

[2021-06-17 23:39:59,504] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:39:59,539] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=6504.040797751786
-----------------------------------------after batch engine step
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09033203125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10205078125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11181640625GB

Max Memory Allocated 9.894766330718994  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.09619140625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.10595703125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

avg iteration(step) data from cpu to GPU time:11.17318155 ms
avg iteration GPU training time:237.32119921 ms
avg iteration (step) total cpu time:258.12779533 ms
Epoch Time(s): 9.7004
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.08837890625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10009765625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 14.11376953125GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 14.11572265625GB

Max Memory Allocated 9.894766330718994  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.4303 | Train Acc 0.8905 | Speed (samples/sec) 23760.6008 | GPU 10132.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 14.09228515625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 14.10400390625GB

Max Memory Allocated 9.894766330718994  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

[2021-06-17 23:40:03,568] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:03,603] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=6492.340865348399
-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.16845703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.16845703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.16845703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.16845703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

[2021-06-17 23:40:06,185] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:06,219] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=6460.209509996941
-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17041015625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19384765625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19970703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.18994140625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19189453125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.16845703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.16845703125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18212890625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

[2021-06-17 23:40:08,685] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:08,719] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=6474.628084481032
-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.19775390625GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.19580078125GB

Max Memory Allocated 9.904658317565918  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.17236328125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.18408203125GB

Max Memory Allocated 9.904658317565918  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67431640625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.50052034 ms
avg iteration GPU training time:231.04484897 ms
avg iteration (step) total cpu time:251.84678148 ms
Epoch Time(s): 9.6295
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66259765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66259765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.3963 | Train Acc 0.9004 | Speed (samples/sec) 23744.6500 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:12,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:12,860] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=6441.482868525996
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:15,438] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:15,473] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=6424.333220285235
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:18,059] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:18,094] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=6411.812623797866
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67431640625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.26332686 ms
avg iteration GPU training time:237.53292225 ms
avg iteration (step) total cpu time:258.26664324 ms
Epoch Time(s): 9.9632
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4015 | Train Acc 0.8938 | Speed (samples/sec) 23514.3584 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:22,102] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:22,135] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=6409.132734206326
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:24,712] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:24,746] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=6400.015238185437
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:27,300] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:27,334] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=6395.424427145045
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:29,837] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:29,850] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=6403.3316467566465
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.32549092 ms
avg iteration GPU training time:234.78310536 ms
avg iteration (step) total cpu time:256.40038208 ms
Epoch Time(s): 9.7634
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3408 | Train Acc 0.9119 | Speed (samples/sec) 23444.5213 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:33,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:33,914] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=6402.338364905903
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:36,512] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:36,546] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=6390.492769398691
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:39,111] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:39,145] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=6384.74776074891
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:12.03484797 ms
avg iteration GPU training time:237.56531892 ms
avg iteration (step) total cpu time:258.83772638 ms
Epoch Time(s): 9.7836
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3423 | Train Acc 0.9028 | Speed (samples/sec) 23385.8782 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:43,244] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:43,278] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=6378.046452441474
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:45,826] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:45,862] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=6376.702611634167
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:48,442] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:48,476] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=6373.136722107448
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.18628387 ms
avg iteration GPU training time:234.69040426 ms
avg iteration (step) total cpu time:255.96202744 ms
Epoch Time(s): 9.8136
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3239 | Train Acc 0.9139 | Speed (samples/sec) 23348.4486 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:52,471] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:52,505] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=6374.856344279261
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:55,027] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:55,061] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=6375.908905088344
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:40:57,629] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:40:57,663] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=6372.229507626565
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67431640625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.04826184 ms
avg iteration GPU training time:236.25891904 ms
avg iteration (step) total cpu time:256.68461234 ms
Epoch Time(s): 9.6892
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3147 | Train Acc 0.9166 | Speed (samples/sec) 23348.5768 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:01,725] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:01,758] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=6369.068381094307
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66455078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:04,191] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:04,225] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=6379.719804372285
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:06,651] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:06,685] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=6390.036331719516
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.81859792 ms
avg iteration GPU training time:228.82766950 ms
avg iteration (step) total cpu time:250.03099442 ms
Epoch Time(s): 9.6188
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3244 | Train Acc 0.9142 | Speed (samples/sec) 23390.5332 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:10,835] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:10,869] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=6380.528914752213
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:13,286] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:13,321] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=6391.231749335869
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:15,770] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:15,804] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=6397.925751962161
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:18,143] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:18,156] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=6413.893742219417
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:10.86996508 ms
avg iteration GPU training time:221.96409155 ms
avg iteration (step) total cpu time:242.24956830 ms
Epoch Time(s): 9.4138
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3110 | Train Acc 0.9124 | Speed (samples/sec) 23498.0181 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:22,264] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:22,297] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=6408.0850428538715
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:24,857] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:24,891] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=6404.819987333799
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:27,472] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:27,505] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=6399.479508329545
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67431640625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:10.83403262 ms
avg iteration GPU training time:238.50589272 ms
avg iteration (step) total cpu time:258.49666419 ms
Epoch Time(s): 9.8014
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3262 | Train Acc 0.9119 | Speed (samples/sec) 23457.2868 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:31,459] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:31,493] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=6403.380745713949
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:33,894] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:33,929] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=6412.224658164476
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:36,361] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:36,395] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=6417.831610586083
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:10.90507262 ms
avg iteration GPU training time:222.15896719 ms
avg iteration (step) total cpu time:242.16307534 ms
Epoch Time(s): 9.3214
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3162 | Train Acc 0.9169 | Speed (samples/sec) 23548.2590 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:40,396] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:40,430] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=6418.318954033933
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:43,128] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:43,163] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=6405.266497140067
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:45,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:45,660] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=6408.9715143086405
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:10.85771253 ms
avg iteration GPU training time:241.66565959 ms
avg iteration (step) total cpu time:261.89748446 ms
Epoch Time(s): 9.9262
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3114 | Train Acc 0.9183 | Speed (samples/sec) 23493.4024 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:49,953] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:49,987] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=6398.120645857489
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:52,423] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:52,458] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=6403.2839381175745
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:54,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:54,914] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=6409.11601507321
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.20946134 ms
avg iteration GPU training time:226.79753565 ms
avg iteration (step) total cpu time:246.71070664 ms
Epoch Time(s): 9.6701
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3243 | Train Acc 0.9137 | Speed (samples/sec) 23524.3306 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:41:58,961] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:41:58,995] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=6406.554280864905
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:42:01,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:01,634] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=6401.880456490752
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:42:04,188] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:04,222] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=6400.042874441422
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67626953125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:42:06,730] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:06,743] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=6401.428660678508
-----------------------------------------after batch engine step
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.28651253 ms
avg iteration GPU training time:234.81313239 ms
avg iteration (step) total cpu time:255.64214035 ms
Epoch Time(s): 9.8218
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3122 | Train Acc 0.9190 | Speed (samples/sec) 23493.3039 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67236328125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68408203125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69775390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:42:10,780] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:10,814] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=6400.051643496471
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:42:13,394] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:13,428] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=6397.140159536226
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

[2021-06-17 23:42:16,004] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:16,038] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=6394.008879079981
-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.68603515625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

avg iteration(step) data from cpu to GPU time:11.42513302 ms
avg iteration GPU training time:236.60031354 ms
avg iteration (step) total cpu time:257.31134415 ms
Epoch Time(s): 9.7794
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.67822265625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2944 | Train Acc 0.9191 | Speed (samples/sec) 23470.2297 | GPU 10155.1 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66845703125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.68798828125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.68994140625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.66650390625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68017578125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69580078125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.69189453125GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.69384765625GB

Max Memory Allocated 9.917091846466064  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.67041015625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.68212890625GB

Max Memory Allocated 9.917091846466064  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:20,103] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:20,137] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=6392.226601789675
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:22,719] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:22,753] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=6389.632755697602
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:25,317] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:25,349] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=6388.250920435304
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.13318993 ms
avg iteration GPU training time:237.38834805 ms
avg iteration (step) total cpu time:258.32960341 ms
Epoch Time(s): 9.7574
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.16845703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.2997 | Train Acc 0.9169 | Speed (samples/sec) 23441.1661 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:29,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:29,761] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=6384.099441536684
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:32,359] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:32,393] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=6381.515004703402
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:34,955] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:34,990] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=6380.319961900626
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.60122541 ms
avg iteration GPU training time:237.51969684 ms
avg iteration (step) total cpu time:258.90632029 ms
Epoch Time(s): 10.2348
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2938 | Train Acc 0.9236 | Speed (samples/sec) 23413.7105 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:39,109] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:39,143] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=6380.253632508989
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:41,709] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:41,743] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=6378.705704877971
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:44,326] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:44,359] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=6376.675706914548
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.09209596 ms
avg iteration GPU training time:237.76368374 ms
avg iteration (step) total cpu time:258.34208065 ms
Epoch Time(s): 9.8991
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2804 | Train Acc 0.9259 | Speed (samples/sec) 23396.0825 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:48,421] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:48,455] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=6375.597868986504
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:50,972] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:51,006] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=6376.29652533444
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:53,602] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:53,636] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=6373.665105650662
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:42:56,065] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:42:56,078] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=6378.039566600373
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.79640655 ms
avg iteration GPU training time:234.66239760 ms
avg iteration (step) total cpu time:254.66656685 ms
Epoch Time(s): 9.6915
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2844 | Train Acc 0.9215 | Speed (samples/sec) 23400.1598 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:00,216] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:00,250] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=6374.24272668571
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:02,799] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:02,834] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=6373.685012303681
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:05,388] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:05,422] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=6373.278911973724
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.25643252 ms
avg iteration GPU training time:235.24331043 ms
avg iteration (step) total cpu time:256.48021698 ms
Epoch Time(s): 9.7890
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2724 | Train Acc 0.9286 | Speed (samples/sec) 23388.9088 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:09,800] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:09,835] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=6373.128554212006
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:12,405] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:12,439] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=6371.81635692795
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:14,993] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:15,027] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=6371.094323060203
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.20235489 ms
avg iteration GPU training time:235.61896543 ms
avg iteration (step) total cpu time:256.05544338 ms
Epoch Time(s): 10.1094
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3196 | Train Acc 0.9094 | Speed (samples/sec) 23384.5720 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:18,999] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:19,033] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=6374.341627201655
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:21,553] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:21,587] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=6374.842059407813
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:24,082] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:24,116] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=6376.390218411462
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.00307555 ms
avg iteration GPU training time:231.95767947 ms
avg iteration (step) total cpu time:252.60283329 ms
Epoch Time(s): 9.6193
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2949 | Train Acc 0.9212 | Speed (samples/sec) 23395.5700 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:28,102] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:28,136] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=6377.859796328163
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:30,537] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:30,571] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=6382.257910599129
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:33,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:33,136] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=6382.155779528038
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.54322852 ms
avg iteration GPU training time:229.60682396 ms
avg iteration (step) total cpu time:249.32875457 ms
Epoch Time(s): 9.5041
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2912 | Train Acc 0.9209 | Speed (samples/sec) 23418.6910 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:37,217] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:37,251] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=6380.739216302223
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:39,813] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:39,847] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=6379.749968319911
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:42,407] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:42,441] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=6378.8985238078785
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:44,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:44,893] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=6382.972581269363
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.34988207 ms
avg iteration GPU training time:232.31690075 ms
avg iteration (step) total cpu time:253.70446841 ms
Epoch Time(s): 9.7855
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.3244 | Train Acc 0.9113 | Speed (samples/sec) 23416.4006 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:48,951] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:48,984] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=6383.029957591426
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:51,603] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:51,637] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=6380.479389072934
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:54,023] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:54,057] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=6385.099976504571
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.41970620 ms
avg iteration GPU training time:229.25656806 ms
avg iteration (step) total cpu time:250.21701389 ms
Epoch Time(s): 9.5897
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2872 | Train Acc 0.9190 | Speed (samples/sec) 23430.0926 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:43:58,008] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:43:58,043] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=6387.680909433289
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:00,464] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:00,498] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=6391.081895405859
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:02,892] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:02,927] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=6395.070565612272
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.06331730 ms
avg iteration GPU training time:221.32551179 ms
avg iteration (step) total cpu time:241.35176341 ms
Epoch Time(s): 9.3496
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.3017 | Train Acc 0.9215 | Speed (samples/sec) 23472.2596 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:06,884] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:06,913] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=6396.356999061167
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:09,536] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:09,569] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=6393.547725888339
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:12,140] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:12,174] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=6392.170922685186
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.07740330 ms
avg iteration GPU training time:235.78383269 ms
avg iteration (step) total cpu time:256.34086574 ms
Epoch Time(s): 9.7279
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.3049 | Train Acc 0.9156 | Speed (samples/sec) 23461.6466 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:16,229] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:16,262] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=6390.4760853581565
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:18,880] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:18,914] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=6387.910107972464
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:21,483] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:21,517] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=6386.783594370561
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.18686701 ms
avg iteration GPU training time:236.37793760 ms
avg iteration (step) total cpu time:257.08785763 ms
Epoch Time(s): 9.9245
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2794 | Train Acc 0.9243 | Speed (samples/sec) 23443.6136 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:25,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:25,588] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=6386.625291996343
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:28,127] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:28,161] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=6386.322761665266
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:30,728] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:30,762] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=6385.379141260042
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:33,255] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:33,267] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=6386.5363871129475
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.19735946 ms
avg iteration GPU training time:235.65063872 ms
avg iteration (step) total cpu time:256.18909023 ms
Epoch Time(s): 9.7732
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2869 | Train Acc 0.9231 | Speed (samples/sec) 23436.6292 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:37,418] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:37,452] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=6383.666446113407
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:40,103] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:40,136] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=6380.620003951518
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:42,687] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:42,721] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=6380.010775577543
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.13225843 ms
avg iteration GPU training time:239.82130489 ms
avg iteration (step) total cpu time:260.83467625 ms
Epoch Time(s): 9.8812
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.3078 | Train Acc 0.9164 | Speed (samples/sec) 23417.5646 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:46,690] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:46,724] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=6380.9060926910415
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:49,283] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:49,317] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=6380.681031803227
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:51,731] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:51,765] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=6383.590595075276
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.47255701 ms
avg iteration GPU training time:228.66107347 ms
avg iteration (step) total cpu time:249.31851140 ms
Epoch Time(s): 9.4915
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.3038 | Train Acc 0.9220 | Speed (samples/sec) 23433.4862 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:55,726] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:55,760] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=6383.058049058757
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:44:58,347] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:44:58,381] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=6381.578327533414
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:00,938] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:00,972] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=6380.943317181283
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.09101520 ms
avg iteration GPU training time:236.79773571 ms
avg iteration (step) total cpu time:257.55728616 ms
Epoch Time(s): 9.8209
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2985 | Train Acc 0.9220 | Speed (samples/sec) 23420.2982 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:05,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:05,189] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=6377.347636964817
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:07,851] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:07,884] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=6374.526519734617
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:10,532] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:10,566] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=6371.934741607173
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:12.01078996 ms
avg iteration GPU training time:239.33031887 ms
avg iteration (step) total cpu time:260.91369876 ms
Epoch Time(s): 10.0522
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.3344 | Train Acc 0.9082 | Speed (samples/sec) 23396.9142 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:15,165] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:15,199] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=6373.108933569865
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:17,690] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:17,724] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=6373.995773823406
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:20,125] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:20,159] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=6377.272591689621
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:22,700] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:22,712] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=6377.333573192995
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.32493277 ms
avg iteration GPU training time:230.78037573 ms
avg iteration (step) total cpu time:251.36053121 ms
Epoch Time(s): 10.2442
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2878 | Train Acc 0.9225 | Speed (samples/sec) 23407.0604 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:27,353] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:27,387] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=6375.977695639382
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:29,983] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:30,017] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=6374.370478361405
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:32,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:32,633] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=6373.290077197447
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.31930544 ms
avg iteration GPU training time:240.05725550 ms
avg iteration (step) total cpu time:260.88913282 ms
Epoch Time(s): 10.3505
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.3043 | Train Acc 0.9199 | Speed (samples/sec) 23395.4559 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:36,637] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:36,671] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=6375.478268437501
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:39,138] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:39,172] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=6377.320223103766
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:41,578] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:41,612] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=6380.159569725589
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.35157331 ms
avg iteration GPU training time:222.96417858 ms
avg iteration (step) total cpu time:244.02518626 ms
Epoch Time(s): 9.4220
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2780 | Train Acc 0.9247 | Speed (samples/sec) 23421.4740 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:45,704] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:45,738] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=6379.234029345594
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:48,176] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:48,210] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=6381.233893921359
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:50,618] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:50,652] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=6383.86735238076
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.85804925 ms
avg iteration GPU training time:223.65610589 ms
avg iteration (step) total cpu time:243.49715092 ms
Epoch Time(s): 9.5530
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2983 | Train Acc 0.9223 | Speed (samples/sec) 23437.3861 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:54,705] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:54,739] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=6383.611152306065
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:57,134] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:57,168] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=6386.546096145702
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:45:59,565] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:45:59,599] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=6389.483643864994
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.19590516 ms
avg iteration GPU training time:220.27533581 ms
avg iteration (step) total cpu time:240.44654104 ms
Epoch Time(s): 9.3946
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2997 | Train Acc 0.9167 | Speed (samples/sec) 23461.8954 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:03,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:03,660] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=6391.741580333443
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:06,193] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:06,226] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=6391.431178017491
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:08,858] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:08,892] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=6389.192838283238
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:11,367] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:11,380] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=6390.404498217161
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.92751883 ms
avg iteration GPU training time:236.44690733 ms
avg iteration (step) total cpu time:256.39275268 ms
Epoch Time(s): 9.9076
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2864 | Train Acc 0.9239 | Speed (samples/sec) 23455.5166 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:15,573] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:15,606] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=6389.107339803474
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:18,204] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:18,238] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=6387.653355814037
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:20,832] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:20,866] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=6386.13709313169
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.92914966 ms
avg iteration GPU training time:239.89237185 ms
avg iteration (step) total cpu time:260.22118109 ms
Epoch Time(s): 9.9523
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.3153 | Train Acc 0.9158 | Speed (samples/sec) 23442.6770 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:24,983] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:25,017] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=6386.346669492673
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:27,526] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:27,560] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=6386.69291719494
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:30,037] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:30,071] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=6387.564357923375
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.64088894 ms
avg iteration GPU training time:228.67067747 ms
avg iteration (step) total cpu time:248.35376386 ms
Epoch Time(s): 9.6377
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2821 | Train Acc 0.9220 | Speed (samples/sec) 23453.6545 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:34,301] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:34,335] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=6385.259882407138
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:36,778] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:36,812] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=6387.3142393045955
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:39,206] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:39,240] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=6389.952991513005
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.82593061 ms
avg iteration GPU training time:222.78467023 ms
avg iteration (step) total cpu time:243.75113734 ms
Epoch Time(s): 9.6518
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2807 | Train Acc 0.9207 | Speed (samples/sec) 23471.2976 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:43,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:43,233] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=6390.643352894766
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:45,649] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:45,683] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=6392.719860527867
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:48,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:48,162] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=6394.2905587560745
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.58383654 ms
avg iteration GPU training time:226.10976269 ms
avg iteration (step) total cpu time:245.76769052 ms
Epoch Time(s): 9.4913
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.3038 | Train Acc 0.9177 | Speed (samples/sec) 23483.8684 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:52,196] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:52,230] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=6393.643616998741
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:55,001] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:55,035] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=6389.0455162896305
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:46:57,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:46:57,631] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=6388.49433897589
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:00,144] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:00,157] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=6389.016526727461
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.40958226 ms
avg iteration GPU training time:240.25838499 ms
avg iteration (step) total cpu time:261.10465438 ms
Epoch Time(s): 10.0308
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2986 | Train Acc 0.9193 | Speed (samples/sec) 23463.4148 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:04,245] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:04,278] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=6388.057359236533
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:06,812] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:06,846] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=6388.088131593497
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:09,423] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:09,457] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=6387.325526949421
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.48461861 ms
avg iteration GPU training time:234.18490431 ms
avg iteration (step) total cpu time:256.16768554 ms
Epoch Time(s): 9.7800
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.3060 | Train Acc 0.9169 | Speed (samples/sec) 23459.9552 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:13,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:13,542] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=6387.587409947303
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:15,964] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:15,998] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=6389.491344070243
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:18,570] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:18,605] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=6388.704882785046
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.96274017 ms
avg iteration GPU training time:230.29475403 ms
avg iteration (step) total cpu time:251.35418221 ms
Epoch Time(s): 9.6822
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2828 | Train Acc 0.9222 | Speed (samples/sec) 23462.9536 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:22,641] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:22,674] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=6389.175288048447
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:25,319] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:25,353] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=6387.307598533482
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:27,968] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:28,002] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=6386.096164744654
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.19922846 ms
avg iteration GPU training time:240.27066153 ms
avg iteration (step) total cpu time:261.80415683 ms
Epoch Time(s): 9.8595
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2983 | Train Acc 0.9211 | Speed (samples/sec) 23449.8419 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:32,053] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:32,086] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=6385.194048814705
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:34,708] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:34,742] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=6383.657984711656
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:37,313] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:37,347] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=6383.055833798218
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.21076379 ms
avg iteration GPU training time:238.24742805 ms
avg iteration (step) total cpu time:259.19305837 ms
Epoch Time(s): 9.8392
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2955 | Train Acc 0.9223 | Speed (samples/sec) 23439.3831 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:41,300] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:41,331] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=6383.194836531808
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:43,749] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:43,784] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=6385.01765856316
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:46,202] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:46,236] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=6386.874452390709
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:48,736] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:48,749] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=6387.430788999872
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.71673125 ms
avg iteration GPU training time:227.39068547 ms
avg iteration (step) total cpu time:247.44553919 ms
Epoch Time(s): 9.4231
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.3171 | Train Acc 0.9126 | Speed (samples/sec) 23453.0671 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:52,828] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:52,861] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=6386.205453508686
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:55,452] [INFO] [logging.py:60:log_dist] [Rank 0] step=1620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:55,486] [INFO] [timer.py:160:stop] 0/1620, SamplesPerSec=6385.406879032442
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:47:58,049] [INFO] [logging.py:60:log_dist] [Rank 0] step=1630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:47:58,083] [INFO] [timer.py:160:stop] 0/1630, SamplesPerSec=6384.661249736482
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.73773520 ms
avg iteration GPU training time:239.84333519 ms
avg iteration (step) total cpu time:261.27682792 ms
Epoch Time(s): 9.8441
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2966 | Train Acc 0.9167 | Speed (samples/sec) 23440.8729 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:02,124] [INFO] [logging.py:60:log_dist] [Rank 0] step=1640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:02,158] [INFO] [timer.py:160:stop] 0/1640, SamplesPerSec=6384.302798672471
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:04,697] [INFO] [logging.py:60:log_dist] [Rank 0] step=1650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:04,731] [INFO] [timer.py:160:stop] 0/1650, SamplesPerSec=6384.175539112895
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:07,282] [INFO] [logging.py:60:log_dist] [Rank 0] step=1660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:07,316] [INFO] [timer.py:160:stop] 0/1660, SamplesPerSec=6383.800848065885
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.26999830 ms
avg iteration GPU training time:234.37421332 ms
avg iteration (step) total cpu time:255.16196533 ms
Epoch Time(s): 9.6806
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2810 | Train Acc 0.9223 | Speed (samples/sec) 23438.8444 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:11,281] [INFO] [logging.py:60:log_dist] [Rank 0] step=1670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:11,314] [INFO] [timer.py:160:stop] 0/1670, SamplesPerSec=6384.452672529085
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:13,744] [INFO] [logging.py:60:log_dist] [Rank 0] step=1680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:13,778] [INFO] [timer.py:160:stop] 0/1680, SamplesPerSec=6386.114841838958
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:16,359] [INFO] [logging.py:60:log_dist] [Rank 0] step=1690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:16,393] [INFO] [timer.py:160:stop] 0/1690, SamplesPerSec=6385.451933021953
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.62358867 ms
avg iteration GPU training time:227.72132478 ms
avg iteration (step) total cpu time:248.71861493 ms
Epoch Time(s): 9.5582
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.3176 | Train Acc 0.9119 | Speed (samples/sec) 23448.8590 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:20,515] [INFO] [logging.py:60:log_dist] [Rank 0] step=1700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:20,549] [INFO] [timer.py:160:stop] 0/1700, SamplesPerSec=6384.213421146383
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:23,210] [INFO] [logging.py:60:log_dist] [Rank 0] step=1710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:23,244] [INFO] [timer.py:160:stop] 0/1710, SamplesPerSec=6382.252293926256
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:25,747] [INFO] [logging.py:60:log_dist] [Rank 0] step=1720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:25,781] [INFO] [timer.py:160:stop] 0/1720, SamplesPerSec=6382.751202562225
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.32698547 ms
avg iteration GPU training time:236.69346110 ms
avg iteration (step) total cpu time:257.75014030 ms
Epoch Time(s): 9.9257
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.3157 | Train Acc 0.9169 | Speed (samples/sec) 23437.2424 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:29,757] [INFO] [logging.py:60:log_dist] [Rank 0] step=1730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:29,790] [INFO] [timer.py:160:stop] 0/1730, SamplesPerSec=6382.372085169727
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:32,318] [INFO] [logging.py:60:log_dist] [Rank 0] step=1740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:32,351] [INFO] [timer.py:160:stop] 0/1740, SamplesPerSec=6382.424408658693
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:34,905] [INFO] [logging.py:60:log_dist] [Rank 0] step=1750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:34,939] [INFO] [timer.py:160:stop] 0/1750, SamplesPerSec=6382.071639716554
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:37,508] [INFO] [logging.py:60:log_dist] [Rank 0] step=1760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:37,520] [INFO] [timer.py:160:stop] 0/1760, SamplesPerSec=6381.903343627222
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.92796207 ms
avg iteration GPU training time:234.09080731 ms
avg iteration (step) total cpu time:255.01758081 ms
Epoch Time(s): 9.7781
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.3271 | Train Acc 0.9148 | Speed (samples/sec) 23432.0642 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:41,465] [INFO] [logging.py:60:log_dist] [Rank 0] step=1770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:41,499] [INFO] [timer.py:160:stop] 0/1770, SamplesPerSec=6383.367674049739
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:43,954] [INFO] [logging.py:60:log_dist] [Rank 0] step=1780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:43,988] [INFO] [timer.py:160:stop] 0/1780, SamplesPerSec=6384.496149225289
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:46,507] [INFO] [logging.py:60:log_dist] [Rank 0] step=1790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:46,549] [INFO] [timer.py:160:stop] 0/1790, SamplesPerSec=6384.447698140656
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.93620027 ms
avg iteration GPU training time:228.98776471 ms
avg iteration (step) total cpu time:249.10211563 ms
Epoch Time(s): 9.5016
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.3045 | Train Acc 0.9195 | Speed (samples/sec) 23442.1610 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:50,597] [INFO] [logging.py:60:log_dist] [Rank 0] step=1800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:50,631] [INFO] [timer.py:160:stop] 0/1800, SamplesPerSec=6384.112534505774
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:53,273] [INFO] [logging.py:60:log_dist] [Rank 0] step=1810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:53,307] [INFO] [timer.py:160:stop] 0/1810, SamplesPerSec=6382.477163432103
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:55,848] [INFO] [logging.py:60:log_dist] [Rank 0] step=1820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:55,882] [INFO] [timer.py:160:stop] 0/1820, SamplesPerSec=6382.198135213182
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.78988677 ms
avg iteration GPU training time:237.47828674 ms
avg iteration (step) total cpu time:257.70466416 ms
Epoch Time(s): 9.7896
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2870 | Train Acc 0.9217 | Speed (samples/sec) 23437.3352 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:48:59,870] [INFO] [logging.py:60:log_dist] [Rank 0] step=1830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:48:59,904] [INFO] [timer.py:160:stop] 0/1830, SamplesPerSec=6382.860737611269
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:02,499] [INFO] [logging.py:60:log_dist] [Rank 0] step=1840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:02,533] [INFO] [timer.py:160:stop] 0/1840, SamplesPerSec=6381.837178793616
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:05,100] [INFO] [logging.py:60:log_dist] [Rank 0] step=1850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:05,134] [INFO] [timer.py:160:stop] 0/1850, SamplesPerSec=6381.329725881481
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.02362076 ms
avg iteration GPU training time:238.64931008 ms
avg iteration (step) total cpu time:258.97981502 ms
Epoch Time(s): 9.8068
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2834 | Train Acc 0.9241 | Speed (samples/sec) 23430.1386 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:09,140] [INFO] [logging.py:60:log_dist] [Rank 0] step=1860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:09,173] [INFO] [timer.py:160:stop] 0/1860, SamplesPerSec=6382.048829337489
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:11,702] [INFO] [logging.py:60:log_dist] [Rank 0] step=1870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:11,735] [INFO] [timer.py:160:stop] 0/1870, SamplesPerSec=6382.140386231226
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:14,171] [INFO] [logging.py:60:log_dist] [Rank 0] step=1880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:14,205] [INFO] [timer.py:160:stop] 0/1880, SamplesPerSec=6383.521668237098
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.07090018 ms
avg iteration GPU training time:227.84903011 ms
avg iteration (step) total cpu time:248.24800315 ms
Epoch Time(s): 9.5378
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2942 | Train Acc 0.9238 | Speed (samples/sec) 23440.0938 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:18,203] [INFO] [logging.py:60:log_dist] [Rank 0] step=1890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:18,237] [INFO] [timer.py:160:stop] 0/1890, SamplesPerSec=6383.549970831873
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:20,932] [INFO] [logging.py:60:log_dist] [Rank 0] step=1900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:20,966] [INFO] [timer.py:160:stop] 0/1900, SamplesPerSec=6381.361161672775
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:23,509] [INFO] [logging.py:60:log_dist] [Rank 0] step=1910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:23,543] [INFO] [timer.py:160:stop] 0/1910, SamplesPerSec=6381.249857706839
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:25,942] [INFO] [logging.py:60:log_dist] [Rank 0] step=1920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:25,954] [INFO] [timer.py:160:stop] 0/1920, SamplesPerSec=6383.239222284105
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.20623640 ms
avg iteration GPU training time:231.53561119 ms
avg iteration (step) total cpu time:252.18690766 ms
Epoch Time(s): 9.7851
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.3024 | Train Acc 0.9148 | Speed (samples/sec) 23435.9001 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:30,076] [INFO] [logging.py:60:log_dist] [Rank 0] step=1930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:30,110] [INFO] [timer.py:160:stop] 0/1930, SamplesPerSec=6381.882428011208
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:32,682] [INFO] [logging.py:60:log_dist] [Rank 0] step=1940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:32,716] [INFO] [timer.py:160:stop] 0/1940, SamplesPerSec=6381.343876557707
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:35,299] [INFO] [logging.py:60:log_dist] [Rank 0] step=1950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:35,333] [INFO] [timer.py:160:stop] 0/1950, SamplesPerSec=6380.520028262351
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.99513834 ms
avg iteration GPU training time:237.50450078 ms
avg iteration (step) total cpu time:257.87382656 ms
Epoch Time(s): 9.8734
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.3017 | Train Acc 0.9199 | Speed (samples/sec) 23429.0385 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:39,444] [INFO] [logging.py:60:log_dist] [Rank 0] step=1960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:39,477] [INFO] [timer.py:160:stop] 0/1960, SamplesPerSec=6379.911273660064
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:41,987] [INFO] [logging.py:60:log_dist] [Rank 0] step=1970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:42,020] [INFO] [timer.py:160:stop] 0/1970, SamplesPerSec=6380.322864865962
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:44,439] [INFO] [logging.py:60:log_dist] [Rank 0] step=1980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:44,473] [INFO] [timer.py:160:stop] 0/1980, SamplesPerSec=6381.830806364825
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.31172749 ms
avg iteration GPU training time:226.63779421 ms
avg iteration (step) total cpu time:247.20189306 ms
Epoch Time(s): 9.5269
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.3081 | Train Acc 0.9172 | Speed (samples/sec) 23436.1979 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:48,562] [INFO] [logging.py:60:log_dist] [Rank 0] step=1990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:48,596] [INFO] [timer.py:160:stop] 0/1990, SamplesPerSec=6381.160137635741
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:50,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=2000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:51,032] [INFO] [timer.py:160:stop] 0/2000, SamplesPerSec=6382.923919530252
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:53,434] [INFO] [logging.py:60:log_dist] [Rank 0] step=2010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:53,468] [INFO] [timer.py:160:stop] 0/2010, SamplesPerSec=6384.6875187361475
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.56959407 ms
avg iteration GPU training time:222.78712859 ms
avg iteration (step) total cpu time:243.37833016 ms
Epoch Time(s): 9.5252
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.3150 | Train Acc 0.9116 | Speed (samples/sec) 23446.5692 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:57,490] [INFO] [logging.py:60:log_dist] [Rank 0] step=2020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:49:57,524] [INFO] [timer.py:160:stop] 0/2020, SamplesPerSec=6384.217917578816
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:49:59,996] [INFO] [logging.py:60:log_dist] [Rank 0] step=2030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:00,030] [INFO] [timer.py:160:stop] 0/2030, SamplesPerSec=6384.961379205765
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:02,425] [INFO] [logging.py:60:log_dist] [Rank 0] step=2040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:02,459] [INFO] [timer.py:160:stop] 0/2040, SamplesPerSec=6386.758670730942
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.98159290 ms
avg iteration GPU training time:221.47798270 ms
avg iteration (step) total cpu time:241.42377465 ms
Epoch Time(s): 9.4604
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.3059 | Train Acc 0.9148 | Speed (samples/sec) 23458.1802 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:06,411] [INFO] [logging.py:60:log_dist] [Rank 0] step=2050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:06,445] [INFO] [timer.py:160:stop] 0/2050, SamplesPerSec=6387.626051799422
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:08,915] [INFO] [logging.py:60:log_dist] [Rank 0] step=2060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:08,949] [INFO] [timer.py:160:stop] 0/2060, SamplesPerSec=6388.386642864888
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:11,448] [INFO] [logging.py:60:log_dist] [Rank 0] step=2070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:11,482] [INFO] [timer.py:160:stop] 0/2070, SamplesPerSec=6388.972531330507
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:13,813] [INFO] [logging.py:60:log_dist] [Rank 0] step=2080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:13,825] [INFO] [timer.py:160:stop] 0/2080, SamplesPerSec=6391.593776379147
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.28222693 ms
avg iteration GPU training time:223.29051265 ms
avg iteration (step) total cpu time:244.13901788 ms
Epoch Time(s): 9.4630
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.3118 | Train Acc 0.9182 | Speed (samples/sec) 23468.9876 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:17,966] [INFO] [logging.py:60:log_dist] [Rank 0] step=2090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:18,000] [INFO] [timer.py:160:stop] 0/2090, SamplesPerSec=6389.513457788803
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:20,636] [INFO] [logging.py:60:log_dist] [Rank 0] step=2100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:20,670] [INFO] [timer.py:160:stop] 0/2100, SamplesPerSec=6388.268871938899
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:23,160] [INFO] [logging.py:60:log_dist] [Rank 0] step=2110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:23,194] [INFO] [timer.py:160:stop] 0/2110, SamplesPerSec=6388.720656365199
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.16713010 ms
avg iteration GPU training time:235.87709667 ms
avg iteration (step) total cpu time:256.95454633 ms
Epoch Time(s): 9.8217
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.3321 | Train Acc 0.9079 | Speed (samples/sec) 23463.4560 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:27,174] [INFO] [logging.py:60:log_dist] [Rank 0] step=2120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:27,208] [INFO] [timer.py:160:stop] 0/2120, SamplesPerSec=6388.9567590257975
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:29,811] [INFO] [logging.py:60:log_dist] [Rank 0] step=2130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:29,845] [INFO] [timer.py:160:stop] 0/2130, SamplesPerSec=6388.4299956899795
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:32,389] [INFO] [logging.py:60:log_dist] [Rank 0] step=2140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:32,423] [INFO] [timer.py:160:stop] 0/2140, SamplesPerSec=6388.1041160827535
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.91754193 ms
avg iteration GPU training time:236.42449499 ms
avg iteration (step) total cpu time:257.79168694 ms
Epoch Time(s): 9.8020
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.3043 | Train Acc 0.9180 | Speed (samples/sec) 23457.5586 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:36,465] [INFO] [logging.py:60:log_dist] [Rank 0] step=2150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:36,499] [INFO] [timer.py:160:stop] 0/2150, SamplesPerSec=6388.635394856033
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:39,108] [INFO] [logging.py:60:log_dist] [Rank 0] step=2160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:39,142] [INFO] [timer.py:160:stop] 0/2160, SamplesPerSec=6388.116686445675
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:41,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=2170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:41,728] [INFO] [timer.py:160:stop] 0/2170, SamplesPerSec=6387.8361551211665
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:12.09562900 ms
avg iteration GPU training time:236.34006868 ms
avg iteration (step) total cpu time:259.28842580 ms
Epoch Time(s): 9.8227
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2991 | Train Acc 0.9150 | Speed (samples/sec) 23453.3859 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:45,805] [INFO] [logging.py:60:log_dist] [Rank 0] step=2180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:45,839] [INFO] [timer.py:160:stop] 0/2180, SamplesPerSec=6387.8007884696
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:48,248] [INFO] [logging.py:60:log_dist] [Rank 0] step=2190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:48,281] [INFO] [timer.py:160:stop] 0/2190, SamplesPerSec=6389.247070741439
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:50,709] [INFO] [logging.py:60:log_dist] [Rank 0] step=2200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:50,742] [INFO] [timer.py:160:stop] 0/2200, SamplesPerSec=6390.4811514789635
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.78697713 ms
avg iteration GPU training time:222.70274297 ms
avg iteration (step) total cpu time:242.79580293 ms
Epoch Time(s): 9.4178
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.3070 | Train Acc 0.9143 | Speed (samples/sec) 23467.4792 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:54,680] [INFO] [logging.py:60:log_dist] [Rank 0] step=2210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:54,713] [INFO] [timer.py:160:stop] 0/2210, SamplesPerSec=6392.024341783617
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:57,131] [INFO] [logging.py:60:log_dist] [Rank 0] step=2220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:57,165] [INFO] [timer.py:160:stop] 0/2220, SamplesPerSec=6393.383467149808
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:50:59,596] [INFO] [logging.py:60:log_dist] [Rank 0] step=2230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:50:59,630] [INFO] [timer.py:160:stop] 0/2230, SamplesPerSec=6394.497982319578
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:02,030] [INFO] [logging.py:60:log_dist] [Rank 0] step=2240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:02,043] [INFO] [timer.py:160:stop] 0/2240, SamplesPerSec=6396.013266451854
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.63222869 ms
avg iteration GPU training time:224.11519934 ms
avg iteration (step) total cpu time:243.70549343 ms
Epoch Time(s): 9.3793
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.3558 | Train Acc 0.9076 | Speed (samples/sec) 23480.2514 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:06,003] [INFO] [logging.py:60:log_dist] [Rank 0] step=2250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:06,036] [INFO] [timer.py:160:stop] 0/2250, SamplesPerSec=6396.612016272748
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:08,547] [INFO] [logging.py:60:log_dist] [Rank 0] step=2260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:08,581] [INFO] [timer.py:160:stop] 0/2260, SamplesPerSec=6396.757993797931
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:11,113] [INFO] [logging.py:60:log_dist] [Rank 0] step=2270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:11,147] [INFO] [timer.py:160:stop] 0/2270, SamplesPerSec=6396.517422338944
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.56224710 ms
avg iteration GPU training time:232.87090669 ms
avg iteration (step) total cpu time:252.85893899 ms
Epoch Time(s): 9.5343
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.3418 | Train Acc 0.9094 | Speed (samples/sec) 23482.7024 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:15,052] [INFO] [logging.py:60:log_dist] [Rank 0] step=2280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:15,086] [INFO] [timer.py:160:stop] 0/2280, SamplesPerSec=6397.40771539077
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:17,558] [INFO] [logging.py:60:log_dist] [Rank 0] step=2290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:17,591] [INFO] [timer.py:160:stop] 0/2290, SamplesPerSec=6398.071636938516
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:20,219] [INFO] [logging.py:60:log_dist] [Rank 0] step=2300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:20,253] [INFO] [timer.py:160:stop] 0/2300, SamplesPerSec=6396.980206907724
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.31894405 ms
avg iteration GPU training time:233.89800912 ms
avg iteration (step) total cpu time:255.01471096 ms
Epoch Time(s): 9.6578
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.3403 | Train Acc 0.9098 | Speed (samples/sec) 23482.1918 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:24,320] [INFO] [logging.py:60:log_dist] [Rank 0] step=2310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:24,354] [INFO] [timer.py:160:stop] 0/2310, SamplesPerSec=6396.560670943596
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:26,986] [INFO] [logging.py:60:log_dist] [Rank 0] step=2320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:27,020] [INFO] [timer.py:160:stop] 0/2320, SamplesPerSec=6395.5319033080605
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:29,594] [INFO] [logging.py:60:log_dist] [Rank 0] step=2330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:29,627] [INFO] [timer.py:160:stop] 0/2330, SamplesPerSec=6395.0501648077125
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.66271167 ms
avg iteration GPU training time:238.89014407 ms
avg iteration (step) total cpu time:260.65496162 ms
Epoch Time(s): 9.9185
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.3225 | Train Acc 0.9122 | Speed (samples/sec) 23474.5394 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:33,724] [INFO] [logging.py:60:log_dist] [Rank 0] step=2340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:33,758] [INFO] [timer.py:160:stop] 0/2340, SamplesPerSec=6394.389504540483
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:36,199] [INFO] [logging.py:60:log_dist] [Rank 0] step=2350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:36,233] [INFO] [timer.py:160:stop] 0/2350, SamplesPerSec=6395.376668102752
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:38,797] [INFO] [logging.py:60:log_dist] [Rank 0] step=2360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:38,830] [INFO] [timer.py:160:stop] 0/2360, SamplesPerSec=6394.995682785602
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.05939439 ms
avg iteration GPU training time:232.84940762 ms
avg iteration (step) total cpu time:253.38837836 ms
Epoch Time(s): 9.6670
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.3375 | Train Acc 0.9023 | Speed (samples/sec) 23474.0753 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:42,797] [INFO] [logging.py:60:log_dist] [Rank 0] step=2370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:42,830] [INFO] [timer.py:160:stop] 0/2370, SamplesPerSec=6395.152341969369
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:45,316] [INFO] [logging.py:60:log_dist] [Rank 0] step=2380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:45,350] [INFO] [timer.py:160:stop] 0/2380, SamplesPerSec=6395.614225599068
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:47,924] [INFO] [logging.py:60:log_dist] [Rank 0] step=2390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:47,958] [INFO] [timer.py:160:stop] 0/2390, SamplesPerSec=6395.359950866054
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:50,490] [INFO] [logging.py:60:log_dist] [Rank 0] step=2400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:50,503] [INFO] [timer.py:160:stop] 0/2400, SamplesPerSec=6395.378749777279
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.30114598 ms
avg iteration GPU training time:235.18491787 ms
avg iteration (step) total cpu time:256.58367298 ms
Epoch Time(s): 9.6829
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.3477 | Train Acc 0.9060 | Speed (samples/sec) 23472.6090 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:54,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=2410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:54,662] [INFO] [timer.py:160:stop] 0/2410, SamplesPerSec=6394.635024151117
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:57,128] [INFO] [logging.py:60:log_dist] [Rank 0] step=2420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:57,161] [INFO] [timer.py:160:stop] 0/2420, SamplesPerSec=6395.353226363032
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:51:59,764] [INFO] [logging.py:60:log_dist] [Rank 0] step=2430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:51:59,798] [INFO] [timer.py:160:stop] 0/2430, SamplesPerSec=6394.409498259307
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.07402552 ms
avg iteration GPU training time:231.98415968 ms
avg iteration (step) total cpu time:252.23730229 ms
Epoch Time(s): 9.7399
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.3343 | Train Acc 0.9122 | Speed (samples/sec) 23472.1777 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:03,785] [INFO] [logging.py:60:log_dist] [Rank 0] step=2440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:03,819] [INFO] [timer.py:160:stop] 0/2440, SamplesPerSec=6394.508055832873
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:06,257] [INFO] [logging.py:60:log_dist] [Rank 0] step=2450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:06,291] [INFO] [timer.py:160:stop] 0/2450, SamplesPerSec=6395.611416208297
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:08,682] [INFO] [logging.py:60:log_dist] [Rank 0] step=2460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:08,716] [INFO] [timer.py:160:stop] 0/2460, SamplesPerSec=6397.023917806313
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.80464828 ms
avg iteration GPU training time:222.50071038 ms
avg iteration (step) total cpu time:242.79562632 ms
Epoch Time(s): 9.4264
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.3225 | Train Acc 0.9124 | Speed (samples/sec) 23483.6488 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:12,797] [INFO] [logging.py:60:log_dist] [Rank 0] step=2470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:12,832] [INFO] [timer.py:160:stop] 0/2470, SamplesPerSec=6396.692313645693
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:15,448] [INFO] [logging.py:60:log_dist] [Rank 0] step=2480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:15,482] [INFO] [timer.py:160:stop] 0/2480, SamplesPerSec=6395.805418587586
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:18,027] [INFO] [logging.py:60:log_dist] [Rank 0] step=2490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:18,061] [INFO] [timer.py:160:stop] 0/2490, SamplesPerSec=6395.6202380770155
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.51453271 ms
avg iteration GPU training time:237.28531505 ms
avg iteration (step) total cpu time:258.30621190 ms
Epoch Time(s): 9.8496
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.3389 | Train Acc 0.9044 | Speed (samples/sec) 23475.8719 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:22,167] [INFO] [logging.py:60:log_dist] [Rank 0] step=2500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:22,201] [INFO] [timer.py:160:stop] 0/2500, SamplesPerSec=6394.632033675872
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:24,723] [INFO] [logging.py:60:log_dist] [Rank 0] step=2510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:24,757] [INFO] [timer.py:160:stop] 0/2510, SamplesPerSec=6394.807494199535
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:27,188] [INFO] [logging.py:60:log_dist] [Rank 0] step=2520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:27,219] [INFO] [timer.py:160:stop] 0/2520, SamplesPerSec=6395.982925015667
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.59850428 ms
avg iteration GPU training time:224.74008009 ms
avg iteration (step) total cpu time:245.56565285 ms
Epoch Time(s): 9.6009
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.3260 | Train Acc 0.9054 | Speed (samples/sec) 23481.7947 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:31,152] [INFO] [logging.py:60:log_dist] [Rank 0] step=2530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:31,186] [INFO] [timer.py:160:stop] 0/2530, SamplesPerSec=6396.852387122574
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:33,887] [INFO] [logging.py:60:log_dist] [Rank 0] step=2540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:33,921] [INFO] [timer.py:160:stop] 0/2540, SamplesPerSec=6394.980965421127
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:36,500] [INFO] [logging.py:60:log_dist] [Rank 0] step=2550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:36,534] [INFO] [timer.py:160:stop] 0/2550, SamplesPerSec=6394.509256161739
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:39,047] [INFO] [logging.py:60:log_dist] [Rank 0] step=2560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:39,060] [INFO] [timer.py:160:stop] 0/2560, SamplesPerSec=6394.748500095686
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.38921955 ms
avg iteration GPU training time:238.27793206 ms
avg iteration (step) total cpu time:259.23069318 ms
Epoch Time(s): 9.9434
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.3366 | Train Acc 0.9062 | Speed (samples/sec) 23472.0411 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:43,349] [INFO] [logging.py:60:log_dist] [Rank 0] step=2570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:43,383] [INFO] [timer.py:160:stop] 0/2570, SamplesPerSec=6391.627565929728
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:46,031] [INFO] [logging.py:60:log_dist] [Rank 0] step=2580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:46,065] [INFO] [timer.py:160:stop] 0/2580, SamplesPerSec=6390.558201022902
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:48,614] [INFO] [logging.py:60:log_dist] [Rank 0] step=2590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:48,647] [INFO] [timer.py:160:stop] 0/2590, SamplesPerSec=6390.303353066236
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.69891910 ms
avg iteration GPU training time:243.20867976 ms
avg iteration (step) total cpu time:264.24636664 ms
Epoch Time(s): 10.0518
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.3411 | Train Acc 0.9038 | Speed (samples/sec) 23458.9595 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:52,726] [INFO] [logging.py:60:log_dist] [Rank 0] step=2600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:52,758] [INFO] [timer.py:160:stop] 0/2600, SamplesPerSec=6389.802463025834
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:55,178] [INFO] [logging.py:60:log_dist] [Rank 0] step=2610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:55,212] [INFO] [timer.py:160:stop] 0/2610, SamplesPerSec=6390.972556207411
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:52:57,633] [INFO] [logging.py:60:log_dist] [Rank 0] step=2620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:52:57,667] [INFO] [timer.py:160:stop] 0/2620, SamplesPerSec=6392.160675185782
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.89056469 ms
avg iteration GPU training time:222.97770521 ms
avg iteration (step) total cpu time:243.89764115 ms
Epoch Time(s): 9.4975
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.3365 | Train Acc 0.9066 | Speed (samples/sec) 23466.5149 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:01,744] [INFO] [logging.py:60:log_dist] [Rank 0] step=2630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:01,778] [INFO] [timer.py:160:stop] 0/2630, SamplesPerSec=6391.470222178168
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:04,593] [INFO] [logging.py:60:log_dist] [Rank 0] step=2640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:04,626] [INFO] [timer.py:160:stop] 0/2640, SamplesPerSec=6388.64594032109
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:07,218] [INFO] [logging.py:60:log_dist] [Rank 0] step=2650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:07,252] [INFO] [timer.py:160:stop] 0/2650, SamplesPerSec=6388.092415637258
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.61281063 ms
avg iteration GPU training time:245.23821343 ms
avg iteration (step) total cpu time:266.63971830 ms
Epoch Time(s): 10.0580
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.3523 | Train Acc 0.9055 | Speed (samples/sec) 23453.7976 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:11,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=2660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:11,241] [INFO] [timer.py:160:stop] 0/2660, SamplesPerSec=6388.331499722527
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:14,051] [INFO] [logging.py:60:log_dist] [Rank 0] step=2670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:14,085] [INFO] [timer.py:160:stop] 0/2670, SamplesPerSec=6385.581797286585
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:16,716] [INFO] [logging.py:60:log_dist] [Rank 0] step=2680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:16,750] [INFO] [timer.py:160:stop] 0/2680, SamplesPerSec=6384.725415914461
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.34142114 ms
avg iteration GPU training time:245.78246505 ms
avg iteration (step) total cpu time:267.07898246 ms
Epoch Time(s): 10.0972
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.3664 | Train Acc 0.8990 | Speed (samples/sec) 23440.2389 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:20,766] [INFO] [logging.py:60:log_dist] [Rank 0] step=2690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:20,800] [INFO] [timer.py:160:stop] 0/2690, SamplesPerSec=6384.84617588625
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:23,295] [INFO] [logging.py:60:log_dist] [Rank 0] step=2700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:23,331] [INFO] [timer.py:160:stop] 0/2700, SamplesPerSec=6385.269465284435
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:25,924] [INFO] [logging.py:60:log_dist] [Rank 0] step=2710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:25,959] [INFO] [timer.py:160:stop] 0/2710, SamplesPerSec=6384.692044592433
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:28,469] [INFO] [logging.py:60:log_dist] [Rank 0] step=2720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:28,482] [INFO] [timer.py:160:stop] 0/2720, SamplesPerSec=6384.986300332563
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.29186959 ms
avg iteration GPU training time:236.33620933 ms
avg iteration (step) total cpu time:257.42027495 ms
Epoch Time(s): 9.7229
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.3507 | Train Acc 0.9031 | Speed (samples/sec) 23439.2396 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:32,542] [INFO] [logging.py:60:log_dist] [Rank 0] step=2730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:32,577] [INFO] [timer.py:160:stop] 0/2730, SamplesPerSec=6384.381821831237
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:35,223] [INFO] [logging.py:60:log_dist] [Rank 0] step=2740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:35,257] [INFO] [timer.py:160:stop] 0/2740, SamplesPerSec=6383.612277227224
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:37,799] [INFO] [logging.py:60:log_dist] [Rank 0] step=2750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:37,833] [INFO] [timer.py:160:stop] 0/2750, SamplesPerSec=6383.432618052259
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.07350750 ms
avg iteration GPU training time:238.45285486 ms
avg iteration (step) total cpu time:259.86530163 ms
Epoch Time(s): 9.8354
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.3689 | Train Acc 0.8993 | Speed (samples/sec) 23433.6467 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:41,995] [INFO] [logging.py:60:log_dist] [Rank 0] step=2760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:42,029] [INFO] [timer.py:160:stop] 0/2760, SamplesPerSec=6382.43828958219
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:44,613] [INFO] [logging.py:60:log_dist] [Rank 0] step=2770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:44,647] [INFO] [timer.py:160:stop] 0/2770, SamplesPerSec=6381.989412365537
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:47,228] [INFO] [logging.py:60:log_dist] [Rank 0] step=2780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:47,262] [INFO] [timer.py:160:stop] 0/2780, SamplesPerSec=6381.461569692946
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.38961547 ms
avg iteration GPU training time:237.90187468 ms
avg iteration (step) total cpu time:258.76722512 ms
Epoch Time(s): 9.9053
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.3847 | Train Acc 0.8942 | Speed (samples/sec) 23426.9339 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:51,447] [INFO] [logging.py:60:log_dist] [Rank 0] step=2790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:51,481] [INFO] [timer.py:160:stop] 0/2790, SamplesPerSec=6379.655023597885
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:54,172] [INFO] [logging.py:60:log_dist] [Rank 0] step=2800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:54,207] [INFO] [timer.py:160:stop] 0/2800, SamplesPerSec=6378.114493338057
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:53:56,738] [INFO] [logging.py:60:log_dist] [Rank 0] step=2810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:53:56,772] [INFO] [timer.py:160:stop] 0/2810, SamplesPerSec=6378.26447479194
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.78389816 ms
avg iteration GPU training time:240.59486898 ms
avg iteration (step) total cpu time:261.76832340 ms
Epoch Time(s): 10.0279
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.3770 | Train Acc 0.8889 | Speed (samples/sec) 23416.5297 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:00,800] [INFO] [logging.py:60:log_dist] [Rank 0] step=2820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:00,834] [INFO] [timer.py:160:stop] 0/2820, SamplesPerSec=6378.835087115416
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:03,438] [INFO] [logging.py:60:log_dist] [Rank 0] step=2830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:03,472] [INFO] [timer.py:160:stop] 0/2830, SamplesPerSec=6378.232848011848
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:05,979] [INFO] [logging.py:60:log_dist] [Rank 0] step=2840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:06,012] [INFO] [timer.py:160:stop] 0/2840, SamplesPerSec=6378.536296705815
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18017578125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.45252985 ms
avg iteration GPU training time:234.03496693 ms
avg iteration (step) total cpu time:254.65633251 ms
Epoch Time(s): 9.6796
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.3788 | Train Acc 0.8950 | Speed (samples/sec) 23417.8101 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:09,923] [INFO] [logging.py:60:log_dist] [Rank 0] step=2850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:09,956] [INFO] [timer.py:160:stop] 0/2850, SamplesPerSec=6379.124321225631
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:12,627] [INFO] [logging.py:60:log_dist] [Rank 0] step=2860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:12,660] [INFO] [timer.py:160:stop] 0/2860, SamplesPerSec=6377.806892686369
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:15,244] [INFO] [logging.py:60:log_dist] [Rank 0] step=2870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:15,277] [INFO] [timer.py:160:stop] 0/2870, SamplesPerSec=6377.33436530396
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:17,808] [INFO] [logging.py:60:log_dist] [Rank 0] step=2880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:17,820] [INFO] [timer.py:160:stop] 0/2880, SamplesPerSec=6377.391227126345
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.74941632 ms
avg iteration GPU training time:238.94333733 ms
avg iteration (step) total cpu time:259.27538342 ms
Epoch Time(s): 9.9047
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.4029 | Train Acc 0.8878 | Speed (samples/sec) 23411.2435 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:22,022] [INFO] [logging.py:60:log_dist] [Rank 0] step=2890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:22,056] [INFO] [timer.py:160:stop] 0/2890, SamplesPerSec=6375.852720925848
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:24,646] [INFO] [logging.py:60:log_dist] [Rank 0] step=2900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:24,680] [INFO] [timer.py:160:stop] 0/2900, SamplesPerSec=6375.427835796221
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:27,246] [INFO] [logging.py:60:log_dist] [Rank 0] step=2910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:27,280] [INFO] [timer.py:160:stop] 0/2910, SamplesPerSec=6375.0885283772395
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.27989098 ms
avg iteration GPU training time:238.27226314 ms
avg iteration (step) total cpu time:259.31141995 ms
Epoch Time(s): 9.8911
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.4319 | Train Acc 0.8797 | Speed (samples/sec) 23404.6603 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:31,374] [INFO] [logging.py:60:log_dist] [Rank 0] step=2920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:31,407] [INFO] [timer.py:160:stop] 0/2920, SamplesPerSec=6374.491062112308
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:34,040] [INFO] [logging.py:60:log_dist] [Rank 0] step=2930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:34,074] [INFO] [timer.py:160:stop] 0/2930, SamplesPerSec=6373.622660152692
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:36,645] [INFO] [logging.py:60:log_dist] [Rank 0] step=2940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:36,679] [INFO] [timer.py:160:stop] 0/2940, SamplesPerSec=6373.278169051413
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.22921130 ms
avg iteration GPU training time:237.64606391 ms
avg iteration (step) total cpu time:258.15175198 ms
Epoch Time(s): 9.9146
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17041015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.4833 | Train Acc 0.8677 | Speed (samples/sec) 23398.6113 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:40,648] [INFO] [logging.py:60:log_dist] [Rank 0] step=2950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:40,682] [INFO] [timer.py:160:stop] 0/2950, SamplesPerSec=6373.590810845522
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:43,286] [INFO] [logging.py:60:log_dist] [Rank 0] step=2960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:43,319] [INFO] [timer.py:160:stop] 0/2960, SamplesPerSec=6372.88300698862
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:45,957] [INFO] [logging.py:60:log_dist] [Rank 0] step=2970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:45,991] [INFO] [timer.py:160:stop] 0/2970, SamplesPerSec=6371.916073507533
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.78240006 ms
avg iteration GPU training time:240.58618616 ms
avg iteration (step) total cpu time:260.54984552 ms
Epoch Time(s): 9.8453
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.4675 | Train Acc 0.8685 | Speed (samples/sec) 23394.2674 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:50,138] [INFO] [logging.py:60:log_dist] [Rank 0] step=2980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:50,172] [INFO] [timer.py:160:stop] 0/2980, SamplesPerSec=6370.802986328263
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:52,842] [INFO] [logging.py:60:log_dist] [Rank 0] step=2990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:52,876] [INFO] [timer.py:160:stop] 0/2990, SamplesPerSec=6369.706525099828
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:55,447] [INFO] [logging.py:60:log_dist] [Rank 0] step=3000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:55,480] [INFO] [timer.py:160:stop] 0/3000, SamplesPerSec=6369.48005926399
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.46651962 ms
avg iteration GPU training time:238.66191723 ms
avg iteration (step) total cpu time:259.90286580 ms
Epoch Time(s): 9.9482
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.5100 | Train Acc 0.8600 | Speed (samples/sec) 23385.9445 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:54:59,507] [INFO] [logging.py:60:log_dist] [Rank 0] step=3010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:54:59,541] [INFO] [timer.py:160:stop] 0/3010, SamplesPerSec=6369.301724251224
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:02,158] [INFO] [logging.py:60:log_dist] [Rank 0] step=3020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:02,192] [INFO] [timer.py:160:stop] 0/3020, SamplesPerSec=6368.792306171648
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:04,745] [INFO] [logging.py:60:log_dist] [Rank 0] step=3030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:04,779] [INFO] [timer.py:160:stop] 0/3030, SamplesPerSec=6368.642661872559
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:07,287] [INFO] [logging.py:60:log_dist] [Rank 0] step=3040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:07,299] [INFO] [timer.py:160:stop] 0/3040, SamplesPerSec=6368.949859895283
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.05050302 ms
avg iteration GPU training time:236.54394305 ms
avg iteration (step) total cpu time:257.48259050 ms
Epoch Time(s): 9.8218
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.4893 | Train Acc 0.8594 | Speed (samples/sec) 23382.4481 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:11,641] [INFO] [logging.py:60:log_dist] [Rank 0] step=3050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:11,673] [INFO] [timer.py:160:stop] 0/3050, SamplesPerSec=6365.959330415624
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:14,526] [INFO] [logging.py:60:log_dist] [Rank 0] step=3060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:14,560] [INFO] [timer.py:160:stop] 0/3060, SamplesPerSec=6363.259742915471
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:17,246] [INFO] [logging.py:60:log_dist] [Rank 0] step=3070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:17,279] [INFO] [timer.py:160:stop] 0/3070, SamplesPerSec=6361.891929107637
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.33397570 ms
avg iteration GPU training time:257.34231511 ms
avg iteration (step) total cpu time:278.48378817 ms
Epoch Time(s): 10.4888
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.5130 | Train Acc 0.8591 | Speed (samples/sec) 23361.8285 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:21,861] [INFO] [logging.py:60:log_dist] [Rank 0] step=3080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:21,894] [INFO] [timer.py:160:stop] 0/3080, SamplesPerSec=6361.64339149515
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:24,571] [INFO] [logging.py:60:log_dist] [Rank 0] step=3090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:24,605] [INFO] [timer.py:160:stop] 0/3090, SamplesPerSec=6360.542840412018
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:27,177] [INFO] [logging.py:60:log_dist] [Rank 0] step=3100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:27,210] [INFO] [timer.py:160:stop] 0/3100, SamplesPerSec=6360.306664553906
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18212890625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.57423415 ms
avg iteration GPU training time:238.44136047 ms
avg iteration (step) total cpu time:259.50964292 ms
Epoch Time(s): 10.4434
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.5180 | Train Acc 0.8509 | Speed (samples/sec) 23356.9946 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:31,248] [INFO] [logging.py:60:log_dist] [Rank 0] step=3110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:31,282] [INFO] [timer.py:160:stop] 0/3110, SamplesPerSec=6360.834617824496
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:33,712] [INFO] [logging.py:60:log_dist] [Rank 0] step=3120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:33,746] [INFO] [timer.py:160:stop] 0/3120, SamplesPerSec=6361.743081857529
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:36,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=3130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:36,242] [INFO] [timer.py:160:stop] 0/3130, SamplesPerSec=6362.349792458009
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.12684570 ms
avg iteration GPU training time:226.18624200 ms
avg iteration (step) total cpu time:246.44816363 ms
Epoch Time(s): 9.5010
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.5235 | Train Acc 0.8498 | Speed (samples/sec) 23365.0931 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19384765625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:40,307] [INFO] [logging.py:60:log_dist] [Rank 0] step=3140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:40,341] [INFO] [timer.py:160:stop] 0/3140, SamplesPerSec=6361.934356245448
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:42,947] [INFO] [logging.py:60:log_dist] [Rank 0] step=3150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:42,982] [INFO] [timer.py:160:stop] 0/3150, SamplesPerSec=6361.4298408364075
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:45,615] [INFO] [logging.py:60:log_dist] [Rank 0] step=3160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:45,649] [INFO] [timer.py:160:stop] 0/3160, SamplesPerSec=6360.7100698110635
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.55972615 ms
avg iteration GPU training time:238.68522983 ms
avg iteration (step) total cpu time:259.70534925 ms
Epoch Time(s): 9.9677
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.5328 | Train Acc 0.8453 | Speed (samples/sec) 23358.0624 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:49,731] [INFO] [logging.py:60:log_dist] [Rank 0] step=3170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:49,764] [INFO] [timer.py:160:stop] 0/3170, SamplesPerSec=6360.320273757147
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:52,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=3180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:52,546] [INFO] [timer.py:160:stop] 0/3180, SamplesPerSec=6358.574750104471
-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:55,110] [INFO] [logging.py:60:log_dist] [Rank 0] step=3190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:55,143] [INFO] [timer.py:160:stop] 0/3190, SamplesPerSec=6358.421569638197
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:55:57,691] [INFO] [logging.py:60:log_dist] [Rank 0] step=3200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:55:57,704] [INFO] [timer.py:160:stop] 0/3200, SamplesPerSec=6358.426521006185
-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:11.25679654 ms
avg iteration GPU training time:240.28826452 ms
avg iteration (step) total cpu time:261.09820825 ms
Epoch Time(s): 10.0455
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
32
7
355

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.5623 | Train Acc 0.8436 | Speed (samples/sec) 23349.8632 | GPU 10165.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:56:01,810] [INFO] [logging.py:60:log_dist] [Rank 0] step=3210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:56:01,844] [INFO] [timer.py:160:stop] 0/3210, SamplesPerSec=6358.200420080692
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17236328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   16   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   17   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   18   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   19   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:56:04,522] [INFO] [logging.py:60:log_dist] [Rank 0] step=3220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:56:04,556] [INFO] [timer.py:160:stop] 0/3220, SamplesPerSec=6357.075926539133
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   20   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   21   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   22   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   23   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   24   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   25   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   26   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.20166015625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   27   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17822265625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.20361328125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   28   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18798828125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   29   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19580078125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

[2021-06-17 23:56:06,993] [INFO] [logging.py:60:log_dist] [Rank 0] step=3230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:56:07,027] [INFO] [timer.py:160:stop] 0/3230, SamplesPerSec=6357.8204324674625
-----------------------------------------after batch engine step
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   30   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17431640625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18603515625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.19775390625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.19970703125GB

Max Memory Allocated 9.926921844482422  GigaBytes


   ***************************     step   31   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.17626953125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.18408203125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.19189453125GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.18994140625GB

Max Memory Allocated 9.926921844482422  GigaBytes

avg iteration(step) data from cpu to GPU time:10.93647167 ms
avg iteration GPU training time:236.24183090 ms
avg iteration (step) total cpu time:256.42262565 ms
Epoch Time(s): 9.7926
Eval Acc 0.8585
Test Acc: 0.6466
Avg epoch time(time.time()): 9766.885422170162 ms
total avg iteration(step) data from cpu to GPU time:11.21467972 ms
total avg iteration GPU training time:233.72575194 ms
total avg iteration (step) total cpu time:254.45121140 ms
