[2021-06-17 23:25:13,454] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-06-17 23:25:17,117] [INFO] [runner.py:360:main] cmd = /usr/bin/python3.6 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMF19 --master_addr=127.0.0.1 --master_port=29500 ds_mini_batch_train.py --aggre lstm --batch-size 12289 --log-every 120 --deepspeed_config ds_config.json
[2021-06-17 23:25:18,128] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0]}
[2021-06-17 23:25:18,128] [INFO] [launch.py:89:main] nnodes=1, num_local_procs=1, node_rank=0
[2021-06-17 23:25:18,128] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0]})
[2021-06-17 23:25:18,128] [INFO] [launch.py:102:main] dist_world_size=1
[2021-06-17 23:25:18,128] [INFO] [launch.py:105:main] Setting CUDA_VISIBLE_DEVICES=0
main start at this time 1623972323.702833
before load_ogb step Time(s): 0.0019
-------------------------------------------------------------from ogb.nodeproppred import DglNodePropPredDataset***************************  
{'VmPeak': 20668.83984375, 'VmSize': 20541.9375, 'VmHWM': 1166.06640625, 'VmRSS': 1166.06640625}  

load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.4584
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2823
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0014
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0001
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0770
-------------------------------------------------end of load ogb****************** step Time(s): 0.0019
finish constructing ogbn-products
load ogb-products time total: 1.821321964263916
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 1.8222
after inductive else step Time(s): 0.0000
after label step Time(s): 3.8793
after train_g.create_formats_() step Time(s): 1.7524
in_feats 100
train_labels.shape torch.Size([2449029])
args.batch_size 12289
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
[2021-06-17 23:25:31,189] [INFO] [logging.py:60:log_dist] [Rank -1] DeepSpeed info: version=0.4.1+unknown, git-hash=unknown, git-branch=unknown
[2021-06-17 23:25:31,190] [INFO] [distributed.py:47:init_distributed] Initializing torch distributed with backend: nccl
[2021-06-17 23:25:31,193] [INFO] [utils.py:13:_initialize_parameter_parallel_groups] data_parallel_size: 1, parameter_parallel_size: 1
[2021-06-17 23:25:33,559] [INFO] [engine.py:173:__init__] DeepSpeed Flops Profiler Enabled: False
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /home/cc/.cache/torch_extensions/fused_adam/build.ninja...
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 1.5076253414154053 seconds
[2021-06-17 23:25:36,519] [INFO] [engine.py:693:_configure_optimizer] Using DeepSpeed Optimizer param name adam as basic optimizer
[2021-06-17 23:25:36,519] [INFO] [engine.py:697:_configure_optimizer] DeepSpeed Basic Optimizer = FusedAdam
[2021-06-17 23:25:36,519] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = adam
[2021-06-17 23:25:36,519] [INFO] [engine.py:505:_configure_lr_scheduler] DeepSpeed using configured LR scheduler = WarmupLR
[2021-06-17 23:25:36,519] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7f71553f5198>
[2021-06-17 23:25:36,519] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:25:36,519] [INFO] [config.py:900:print] DeepSpeedEngine configuration:
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   allreduce_always_fp32 ........ False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   amp_enabled .................. False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   amp_params ................... False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   checkpoint_tag_validation_enabled  True
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   checkpoint_tag_validation_fail  False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   disable_allgather ............ False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   dump_state ................... False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   dynamic_loss_scale_args ...... None
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_enabled ........... False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_gas_boundary_resolution  1
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_layer_num ......... 0
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_max_iter .......... 100
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_stability ......... 1e-06
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_tol ............... 0.01
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   eigenvalue_verbose ........... False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   elasticity_enabled ........... False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   flops_profiler_config ........ {
    "enabled": false, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   fp16_enabled ................. False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   fp16_mixed_quantize .......... False
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   global_rank .................. 0
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   gradient_accumulation_steps .. 1
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   gradient_clipping ............ 0.0
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   gradient_predivide_factor .... 1.0
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   initial_dynamic_scale ........ 4294967296
[2021-06-17 23:25:36,520] [INFO] [config.py:904:print]   loss_scale ................... 0
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   memory_breakdown ............. False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   optimizer_legacy_fusion ...... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   optimizer_name ............... adam
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   optimizer_params ............. {'lr': 0.03, 'betas': [0.8, 0.999], 'eps': 1e-08, 'weight_decay': 3e-07}
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   pld_enabled .................. False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   pld_params ................... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   prescale_gradients ........... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_change_rate ......... 0.001
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_groups .............. 1
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_offset .............. 1000
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_period .............. 1000
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_rounding ............ 0
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_start_bits .......... 16
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_target_bits ......... 8
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_training_enabled .... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_type ................ 0
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   quantize_verbose ............. False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   scheduler_name ............... WarmupLR
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 0.03, 'warmup_num_steps': 10}
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   sparse_attention ............. None
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   sparse_gradients_enabled ..... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   steps_per_print .............. 10
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   tensorboard_enabled .......... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   tensorboard_job_name ......... DeepSpeedJobName
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   tensorboard_output_path ...... 
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   train_batch_size ............. 1500
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   train_micro_batch_size_per_gpu  1500
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   use_quantizer_kernel ......... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   wall_clock_breakdown ......... False
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   world_size ................... 1
[2021-06-17 23:25:36,521] [INFO] [config.py:904:print]   zero_allow_untested_optimizer  False
[2021-06-17 23:25:36,522] [INFO] [config.py:904:print]   zero_config .................. {
    "stage": 0, 
    "contiguous_gradients": false, 
    "reduce_scatter": true, 
    "reduce_bucket_size": 5.000000e+08, 
    "allgather_partitions": true, 
    "allgather_bucket_size": 5.000000e+08, 
    "overlap_comm": false, 
    "load_from_fp32_weights": true, 
    "elastic_checkpoint": true, 
    "offload_param": null, 
    "offload_optimizer": null, 
    "sub_group_size": 1.000000e+12, 
    "prefetch_bucket_size": 5.000000e+07, 
    "param_persistence_threshold": 1.000000e+05, 
    "max_live_parameters": 1.000000e+09, 
    "max_reuse_distance": 1.000000e+09, 
    "gather_fp16_weights_on_model_save": false, 
    "ignore_unused_parameters": true, 
    "legacy_stage1": false
}
[2021-06-17 23:25:36,522] [INFO] [config.py:904:print]   zero_enabled ................. False
[2021-06-17 23:25:36,522] [INFO] [config.py:904:print]   zero_optimization_stage ...... 0
[2021-06-17 23:25:36,524] [INFO] [config.py:912:print]   json = {
    "train_batch_size": 1.500000e+03, 
    "steps_per_print": 10, 
    "optimizer": {
        "type": "Adam", 
        "params": {
            "lr": 0.03, 
            "betas": [0.8, 0.999], 
            "eps": 1e-08, 
            "weight_decay": 3e-07
        }
    }, 
    "scheduler": {
        "type": "WarmupLR", 
        "params": {
            "warmup_min_lr": 0, 
            "warmup_max_lr": 0.03, 
            "warmup_num_steps": 10
        }
    }, 
    "wall_clock_breakdown": false
}
Using /home/cc/.cache/torch_extensions as PyTorch extensions root...
Emitting ninja build file /home/cc/.cache/torch_extensions/utils/build.ninja...
Building extension module utils...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module utils...
Time to load utils op: 1.542083978652954 seconds
******************************0 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 2.31494140625GB

Max Memory Allocated 0.9309120178222656  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 2.68408203125GB

Max Memory Allocated 1.2875065803527832  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 2.76806640625GB

Max Memory Allocated 1.2875065803527832  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 18.44970703125GB

Max Memory Allocated 16.616138458251953  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 18.44970703125GB

Max Memory Allocated 16.616138458251953  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 18.46533203125GB

Max Memory Allocated 16.616138458251953  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 18.46533203125GB

Max Memory Allocated 16.616138458251953  GigaBytes

Epoch 00000 | Step 00000 | Loss 4.7762 | Train Acc 0.0313 | Speed (samples/sec) nan | GPU 17014.9 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 18.42626953125GB

Max Memory Allocated 16.616138458251953  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 18.42626953125GB

Max Memory Allocated 16.616138458251953  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 18.44970703125GB

Max Memory Allocated 16.616138458251953  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 19.34228515625GB

Max Memory Allocated 16.61941146850586  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 19.33251953125GB

Max Memory Allocated 16.61941146850586  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 19.33447265625GB

Max Memory Allocated 16.61941146850586  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 19.33447265625GB

Max Memory Allocated 16.61941146850586  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 19.29541015625GB

Max Memory Allocated 16.61941146850586  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 19.29541015625GB

Max Memory Allocated 16.61941146850586  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 19.31884765625GB

Max Memory Allocated 16.61941146850586  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.657718181610107  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08447265625GB

Max Memory Allocated 16.657718181610107  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.657718181610107  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.657718181610107  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.657718181610107  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.657718181610107  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.657718181610107  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.658058166503906  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.658058166503906  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes

[2021-06-17 23:25:44,405] [INFO] [logging.py:60:log_dist] [Rank 0] step=10, skipped=0, lr=[0.029999999999999995], mom=[[0.8, 0.999]]
[2021-06-17 23:25:44,466] [INFO] [timer.py:160:stop] 0/10, SamplesPerSec=4531.081952372353
-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08642578125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.04931640625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07275390625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09619140625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 21.09814453125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 21.08837890625GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 21.09033203125GB

Max Memory Allocated 16.669312953948975  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 21.05126953125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 21.07470703125GB

Max Memory Allocated 16.669312953948975  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

avg iteration(step) data from cpu to GPU time:19.01539230 ms
avg iteration GPU training time:309.59128085 ms
avg iteration (step) total cpu time:340.98525481 ms
Epoch Time(s): 8.6460
******************************1 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

Epoch 00001 | Step 00000 | Loss 1.0142 | Train Acc 0.7355 | Speed (samples/sec) 33306.0220 | GPU 17099.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83642578125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84619140625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

[2021-06-17 23:25:49,734] [INFO] [logging.py:60:log_dist] [Rank 0] step=20, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:25:49,796] [INFO] [timer.py:160:stop] 0/20, SamplesPerSec=4697.840853974519
-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82470703125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

[2021-06-17 23:25:53,154] [INFO] [logging.py:60:log_dist] [Rank 0] step=30, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:25:53,212] [INFO] [timer.py:160:stop] 0/30, SamplesPerSec=4765.263329424334
-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.83837890625GB

Max Memory Allocated 16.698627948760986  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.79931640625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 29.84814453125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 29.84033203125GB

Max Memory Allocated 16.698627948760986  GigaBytes

avg iteration(step) data from cpu to GPU time:19.07908405 ms
avg iteration GPU training time:309.80596092 ms
avg iteration (step) total cpu time:340.58681401 ms
Epoch Time(s): 7.4494
******************************2 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 29.80126953125GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 29.82275390625GB

Max Memory Allocated 16.698627948760986  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.70751953125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.70947265625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.70947265625GB

Max Memory Allocated 16.712443828582764  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.5765 | Train Acc 0.8690 | Speed (samples/sec) 33643.5758 | GPU 17113.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67041015625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67041015625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69384765625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67236328125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67236328125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.70947265625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67236328125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67236328125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

[2021-06-17 23:25:58,628] [INFO] [logging.py:60:log_dist] [Rank 0] step=40, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:25:58,716] [INFO] [timer.py:160:stop] 0/40, SamplesPerSec=4730.521191815461
-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.71923828125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.70947265625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67236328125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67236328125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69580078125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 30.72119140625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 30.71142578125GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 30.71337890625GB

Max Memory Allocated 16.712443828582764  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 30.67431640625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 30.69775390625GB

Max Memory Allocated 16.712443828582764  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.15036774 ms
avg iteration GPU training time:341.24621582 ms
avg iteration (step) total cpu time:372.99041315 ms
Epoch Time(s): 7.9196
******************************3 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.4677 | Train Acc 0.8857 | Speed (samples/sec) 32960.0734 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:04,571] [INFO] [logging.py:60:log_dist] [Rank 0] step=50, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:04,628] [INFO] [timer.py:160:stop] 0/50, SamplesPerSec=4607.666039830182
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:08,242] [INFO] [logging.py:60:log_dist] [Rank 0] step=60, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:08,300] [INFO] [timer.py:160:stop] 0/60, SamplesPerSec=4592.060581338975
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.19832715 ms
avg iteration GPU training time:327.47750854 ms
avg iteration (step) total cpu time:360.78294841 ms
Epoch Time(s): 7.9268
******************************4 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.4280 | Train Acc 0.8903 | Speed (samples/sec) 32679.4332 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:13,790] [INFO] [logging.py:60:log_dist] [Rank 0] step=70, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:13,852] [INFO] [timer.py:160:stop] 0/70, SamplesPerSec=4604.228284586178
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:17,167] [INFO] [logging.py:60:log_dist] [Rank 0] step=80, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:17,229] [INFO] [timer.py:160:stop] 0/80, SamplesPerSec=4640.49961986818
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.81442642 ms
avg iteration GPU training time:306.15312056 ms
avg iteration (step) total cpu time:338.15266869 ms
Epoch Time(s): 7.4661
******************************5 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.3771 | Train Acc 0.9038 | Speed (samples/sec) 33003.5269 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:22,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=90, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:22,657] [INFO] [timer.py:160:stop] 0/90, SamplesPerSec=4666.530043173957
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.98742953 ms
avg iteration GPU training time:316.09840809 ms
avg iteration (step) total cpu time:348.26675328 ms
Epoch Time(s): 7.6292
******************************6 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.3585 | Train Acc 0.9037 | Speed (samples/sec) 33122.6576 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:28,231] [INFO] [logging.py:60:log_dist] [Rank 0] step=100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:28,292] [INFO] [timer.py:160:stop] 0/100, SamplesPerSec=4662.294919674633
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:31,635] [INFO] [logging.py:60:log_dist] [Rank 0] step=110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:31,697] [INFO] [timer.py:160:stop] 0/110, SamplesPerSec=4682.350348174554
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.81681442 ms
avg iteration GPU training time:306.68129106 ms
avg iteration (step) total cpu time:337.99379522 ms
Epoch Time(s): 7.4954
******************************7 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.3413 | Train Acc 0.9097 | Speed (samples/sec) 33279.5129 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:36,995] [INFO] [logging.py:60:log_dist] [Rank 0] step=120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:37,058] [INFO] [timer.py:160:stop] 0/120, SamplesPerSec=4703.029774117905
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.61181640625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.55197074 ms
avg iteration GPU training time:311.33532437 ms
avg iteration (step) total cpu time:342.45083549 ms
Epoch Time(s): 7.5140
******************************8 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.3374 | Train Acc 0.9105 | Speed (samples/sec) 33361.0446 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:42,481] [INFO] [logging.py:60:log_dist] [Rank 0] step=130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:42,544] [INFO] [timer.py:160:stop] 0/130, SamplesPerSec=4703.9472066739
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:45,821] [INFO] [logging.py:60:log_dist] [Rank 0] step=140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:45,882] [INFO] [timer.py:160:stop] 0/140, SamplesPerSec=4722.949922363418
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.05630805 ms
avg iteration GPU training time:301.78085327 ms
avg iteration (step) total cpu time:333.69970322 ms
Epoch Time(s): 7.3695
******************************9 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.3443 | Train Acc 0.9121 | Speed (samples/sec) 33538.9817 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:51,257] [INFO] [logging.py:60:log_dist] [Rank 0] step=150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:51,320] [INFO] [timer.py:160:stop] 0/150, SamplesPerSec=4732.350750237816
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:26:54,631] [INFO] [logging.py:60:log_dist] [Rank 0] step=160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:26:54,694] [INFO] [timer.py:160:stop] 0/160, SamplesPerSec=4741.805599345881
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.05261074 ms
avg iteration GPU training time:306.52532959 ms
avg iteration (step) total cpu time:336.49175817 ms
Epoch Time(s): 7.4635
******************************10 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.3228 | Train Acc 0.9140 | Speed (samples/sec) 33606.0848 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:00,099] [INFO] [logging.py:60:log_dist] [Rank 0] step=170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:00,162] [INFO] [timer.py:160:stop] 0/170, SamplesPerSec=4745.869051870952
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:20.70603874 ms
avg iteration GPU training time:295.16429832 ms
avg iteration (step) total cpu time:328.64655148 ms
Epoch Time(s): 7.4081
******************************11 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.3426 | Train Acc 0.9102 | Speed (samples/sec) 33717.4621 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:05,403] [INFO] [logging.py:60:log_dist] [Rank 0] step=180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:05,466] [INFO] [timer.py:160:stop] 0/180, SamplesPerSec=4761.183447384909
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:08,793] [INFO] [logging.py:60:log_dist] [Rank 0] step=190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:08,856] [INFO] [timer.py:160:stop] 0/190, SamplesPerSec=4771.532668916612
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.78366834 ms
avg iteration GPU training time:301.03507857 ms
avg iteration (step) total cpu time:332.92785558 ms
Epoch Time(s): 7.4125
******************************12 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.3166 | Train Acc 0.9132 | Speed (samples/sec) 33774.1027 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:14,151] [INFO] [logging.py:60:log_dist] [Rank 0] step=200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:14,215] [INFO] [timer.py:160:stop] 0/200, SamplesPerSec=4782.937896197315
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.84157961 ms
avg iteration GPU training time:302.16877608 ms
avg iteration (step) total cpu time:332.86998489 ms
Epoch Time(s): 7.4152
******************************13 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.3031 | Train Acc 0.9206 | Speed (samples/sec) 33850.7107 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:19,607] [INFO] [logging.py:60:log_dist] [Rank 0] step=210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:19,669] [INFO] [timer.py:160:stop] 0/210, SamplesPerSec=4783.399363086472
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:23,020] [INFO] [logging.py:60:log_dist] [Rank 0] step=220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:23,083] [INFO] [timer.py:160:stop] 0/220, SamplesPerSec=4785.987880673819
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95909223 ms
avg iteration GPU training time:297.46582864 ms
avg iteration (step) total cpu time:327.66114582 ms
Epoch Time(s): 7.4757
******************************14 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.3078 | Train Acc 0.9165 | Speed (samples/sec) 33890.3639 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:28,435] [INFO] [logging.py:60:log_dist] [Rank 0] step=230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:28,499] [INFO] [timer.py:160:stop] 0/230, SamplesPerSec=4794.418584485225
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:31,730] [INFO] [logging.py:60:log_dist] [Rank 0] step=240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:31,793] [INFO] [timer.py:160:stop] 0/240, SamplesPerSec=4803.872725325925
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.71625016 ms
avg iteration GPU training time:298.51113892 ms
avg iteration (step) total cpu time:329.34182340 ms
Epoch Time(s): 7.4456
******************************15 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.3083 | Train Acc 0.9172 | Speed (samples/sec) 33953.0552 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:37,225] [INFO] [logging.py:60:log_dist] [Rank 0] step=250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:37,288] [INFO] [timer.py:160:stop] 0/250, SamplesPerSec=4805.8495428741735
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.43201741 ms
avg iteration GPU training time:301.60494440 ms
avg iteration (step) total cpu time:333.69625698 ms
Epoch Time(s): 7.4411
******************************16 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.2965 | Train Acc 0.9191 | Speed (samples/sec) 33984.6582 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:42,595] [INFO] [logging.py:60:log_dist] [Rank 0] step=260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:42,658] [INFO] [timer.py:160:stop] 0/260, SamplesPerSec=4809.719775172614
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:45,897] [INFO] [logging.py:60:log_dist] [Rank 0] step=270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:45,961] [INFO] [timer.py:160:stop] 0/270, SamplesPerSec=4818.414935920227
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:20.69463556 ms
avg iteration GPU training time:296.96834772 ms
avg iteration (step) total cpu time:329.49679548 ms
Epoch Time(s): 7.3426
******************************17 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.2972 | Train Acc 0.9219 | Speed (samples/sec) 34048.5575 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:51,223] [INFO] [logging.py:60:log_dist] [Rank 0] step=280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:51,286] [INFO] [timer.py:160:stop] 0/280, SamplesPerSec=4824.130957595659
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.34420672 ms
avg iteration GPU training time:297.97579679 ms
avg iteration (step) total cpu time:329.10524715 ms
Epoch Time(s): 7.3063
******************************18 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.2931 | Train Acc 0.9214 | Speed (samples/sec) 34106.2858 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:56,531] [INFO] [logging.py:60:log_dist] [Rank 0] step=290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:56,593] [INFO] [timer.py:160:stop] 0/290, SamplesPerSec=4829.890899027185
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:27:59,821] [INFO] [logging.py:60:log_dist] [Rank 0] step=300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:27:59,885] [INFO] [timer.py:160:stop] 0/300, SamplesPerSec=4836.358606064897
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.60475020 ms
avg iteration GPU training time:297.40661344 ms
avg iteration (step) total cpu time:326.52562315 ms
Epoch Time(s): 7.2919
******************************19 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.2918 | Train Acc 0.9213 | Speed (samples/sec) 34176.2001 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:05,290] [INFO] [logging.py:60:log_dist] [Rank 0] step=310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:05,352] [INFO] [timer.py:160:stop] 0/310, SamplesPerSec=4835.6929963723605
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:08,576] [INFO] [logging.py:60:log_dist] [Rank 0] step=320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:08,640] [INFO] [timer.py:160:stop] 0/320, SamplesPerSec=4841.547330820091
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.16625456 ms
avg iteration GPU training time:302.52953824 ms
avg iteration (step) total cpu time:332.99398422 ms
Epoch Time(s): 7.4093
******************************20 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.2894 | Train Acc 0.9208 | Speed (samples/sec) 34188.1252 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:14,022] [INFO] [logging.py:60:log_dist] [Rank 0] step=330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:14,085] [INFO] [timer.py:160:stop] 0/330, SamplesPerSec=4841.906380264235
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.17837680 ms
avg iteration GPU training time:296.07099498 ms
avg iteration (step) total cpu time:327.41993124 ms
Epoch Time(s): 7.4073
******************************21 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.2716 | Train Acc 0.9238 | Speed (samples/sec) 34219.9693 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:19,346] [INFO] [logging.py:60:log_dist] [Rank 0] step=340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:19,408] [INFO] [timer.py:160:stop] 0/340, SamplesPerSec=4846.037676015477
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:22,677] [INFO] [logging.py:60:log_dist] [Rank 0] step=350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:22,719] [INFO] [timer.py:160:stop] 0/350, SamplesPerSec=4851.687657394561
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.73189198 ms
avg iteration GPU training time:297.16941695 ms
avg iteration (step) total cpu time:326.76347819 ms
Epoch Time(s): 7.3376
******************************22 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.3015 | Train Acc 0.9173 | Speed (samples/sec) 34257.7345 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:28,035] [INFO] [logging.py:60:log_dist] [Rank 0] step=360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:28,099] [INFO] [timer.py:160:stop] 0/360, SamplesPerSec=4853.373827840268
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30127404 ms
avg iteration GPU training time:300.10973566 ms
avg iteration (step) total cpu time:330.36073771 ms
Epoch Time(s): 7.3449
******************************23 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.2749 | Train Acc 0.9260 | Speed (samples/sec) 34276.3582 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:33,400] [INFO] [logging.py:60:log_dist] [Rank 0] step=370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:33,462] [INFO] [timer.py:160:stop] 0/370, SamplesPerSec=4853.505702534682
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:36,838] [INFO] [logging.py:60:log_dist] [Rank 0] step=380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:36,901] [INFO] [timer.py:160:stop] 0/380, SamplesPerSec=4853.3320335444
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.82514936 ms
avg iteration GPU training time:297.12670621 ms
avg iteration (step) total cpu time:328.93057303 ms
Epoch Time(s): 7.4379
******************************24 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.2836 | Train Acc 0.9225 | Speed (samples/sec) 34280.3307 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:42,155] [INFO] [logging.py:60:log_dist] [Rank 0] step=390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:42,219] [INFO] [timer.py:160:stop] 0/390, SamplesPerSec=4855.83197873397
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:45,471] [INFO] [logging.py:60:log_dist] [Rank 0] step=400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:45,534] [INFO] [timer.py:160:stop] 0/400, SamplesPerSec=4859.283415727475
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.81211645 ms
avg iteration GPU training time:300.02600930 ms
avg iteration (step) total cpu time:331.19344711 ms
Epoch Time(s): 7.3740
******************************25 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.2954 | Train Acc 0.9201 | Speed (samples/sec) 34305.2573 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:50,897] [INFO] [logging.py:60:log_dist] [Rank 0] step=410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:50,960] [INFO] [timer.py:160:stop] 0/410, SamplesPerSec=4860.8045681867425
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.27320134 ms
avg iteration GPU training time:305.26555564 ms
avg iteration (step) total cpu time:335.71438356 ms
Epoch Time(s): 7.4589
******************************26 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.2757 | Train Acc 0.9269 | Speed (samples/sec) 34317.4322 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:56,286] [INFO] [logging.py:60:log_dist] [Rank 0] step=420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:56,350] [INFO] [timer.py:160:stop] 0/420, SamplesPerSec=4862.365415976272
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:28:59,601] [INFO] [logging.py:60:log_dist] [Rank 0] step=430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:28:59,664] [INFO] [timer.py:160:stop] 0/430, SamplesPerSec=4867.076030597311
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.66106207 ms
avg iteration GPU training time:296.30097823 ms
avg iteration (step) total cpu time:325.58352297 ms
Epoch Time(s): 7.3517
******************************27 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.2807 | Train Acc 0.9222 | Speed (samples/sec) 34348.4276 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:05,764] [INFO] [logging.py:60:log_dist] [Rank 0] step=440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:05,825] [INFO] [timer.py:160:stop] 0/440, SamplesPerSec=4867.381045909847
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:21.84296747 ms
avg iteration GPU training time:298.20235651 ms
avg iteration (step) total cpu time:332.95943520 ms
Epoch Time(s): 8.1263
******************************28 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.2715 | Train Acc 0.9255 | Speed (samples/sec) 34355.7441 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:11,020] [INFO] [logging.py:60:log_dist] [Rank 0] step=450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:11,083] [INFO] [timer.py:160:stop] 0/450, SamplesPerSec=4870.711599418911
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:14,375] [INFO] [logging.py:60:log_dist] [Rank 0] step=460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:14,440] [INFO] [timer.py:160:stop] 0/460, SamplesPerSec=4873.098561407555
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.77554339 ms
avg iteration GPU training time:298.01043979 ms
avg iteration (step) total cpu time:329.18641784 ms
Epoch Time(s): 7.3054
******************************29 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.2753 | Train Acc 0.9238 | Speed (samples/sec) 34374.5164 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:19,751] [INFO] [logging.py:60:log_dist] [Rank 0] step=470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:19,814] [INFO] [timer.py:160:stop] 0/470, SamplesPerSec=4875.277480381505
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:23,019] [INFO] [logging.py:60:log_dist] [Rank 0] step=480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:23,082] [INFO] [timer.py:160:stop] 0/480, SamplesPerSec=4879.0772605950715
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.18971634 ms
avg iteration GPU training time:296.76020397 ms
avg iteration (step) total cpu time:327.56811922 ms
Epoch Time(s): 7.2924
******************************30 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.2943 | Train Acc 0.9225 | Speed (samples/sec) 34407.5545 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:28,554] [INFO] [logging.py:60:log_dist] [Rank 0] step=490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:28,617] [INFO] [timer.py:160:stop] 0/490, SamplesPerSec=4875.359259407803
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.96312748 ms
avg iteration GPU training time:300.90631104 ms
avg iteration (step) total cpu time:334.15603638 ms
Epoch Time(s): 7.5565
******************************31 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.3018 | Train Acc 0.9189 | Speed (samples/sec) 34394.2057 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:33,934] [INFO] [logging.py:60:log_dist] [Rank 0] step=500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:33,997] [INFO] [timer.py:160:stop] 0/500, SamplesPerSec=4876.467609480625
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:37,333] [INFO] [logging.py:60:log_dist] [Rank 0] step=510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:37,397] [INFO] [timer.py:160:stop] 0/510, SamplesPerSec=4878.379473612958
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.54949500 ms
avg iteration GPU training time:298.34183572 ms
avg iteration (step) total cpu time:330.38984645 ms
Epoch Time(s): 7.4126
******************************32 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.2908 | Train Acc 0.9209 | Speed (samples/sec) 34396.8171 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:42,783] [INFO] [logging.py:60:log_dist] [Rank 0] step=520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:42,845] [INFO] [timer.py:160:stop] 0/520, SamplesPerSec=4876.99907177657
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.13859489 ms
avg iteration GPU training time:297.24379661 ms
avg iteration (step) total cpu time:327.83100822 ms
Epoch Time(s): 7.4593
******************************33 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.2751 | Train Acc 0.9242 | Speed (samples/sec) 34407.6014 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:48,185] [INFO] [logging.py:60:log_dist] [Rank 0] step=530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:48,246] [INFO] [timer.py:160:stop] 0/530, SamplesPerSec=4877.647004087439
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:51,609] [INFO] [logging.py:60:log_dist] [Rank 0] step=540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:51,672] [INFO] [timer.py:160:stop] 0/540, SamplesPerSec=4877.3216733682275
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.45958710 ms
avg iteration GPU training time:301.66078047 ms
avg iteration (step) total cpu time:332.52033320 ms
Epoch Time(s): 7.4943
******************************34 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.2918 | Train Acc 0.9190 | Speed (samples/sec) 34402.3284 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:29:57,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:29:57,154] [INFO] [timer.py:160:stop] 0/550, SamplesPerSec=4875.648298093698
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:00,384] [INFO] [logging.py:60:log_dist] [Rank 0] step=560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:00,447] [INFO] [timer.py:160:stop] 0/560, SamplesPerSec=4878.414314945691
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.89197662 ms
avg iteration GPU training time:301.54244163 ms
avg iteration (step) total cpu time:332.86090331 ms
Epoch Time(s): 7.4371
******************************35 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.2689 | Train Acc 0.9254 | Speed (samples/sec) 34404.2317 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:05,738] [INFO] [logging.py:60:log_dist] [Rank 0] step=570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:05,802] [INFO] [timer.py:160:stop] 0/570, SamplesPerSec=4878.906995690456
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.75461838 ms
avg iteration GPU training time:300.14994951 ms
avg iteration (step) total cpu time:329.88886400 ms
Epoch Time(s): 7.3271
******************************36 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.2716 | Train Acc 0.9282 | Speed (samples/sec) 34417.4478 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:11,092] [INFO] [logging.py:60:log_dist] [Rank 0] step=580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:11,154] [INFO] [timer.py:160:stop] 0/580, SamplesPerSec=4878.642335731405
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:14,645] [INFO] [logging.py:60:log_dist] [Rank 0] step=590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:14,707] [INFO] [timer.py:160:stop] 0/590, SamplesPerSec=4874.876910013253
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.27321590 ms
avg iteration GPU training time:318.40072077 ms
avg iteration (step) total cpu time:348.94817526 ms
Epoch Time(s): 7.6111
******************************37 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.2621 | Train Acc 0.9283 | Speed (samples/sec) 34386.7996 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:20,055] [INFO] [logging.py:60:log_dist] [Rank 0] step=600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:20,118] [INFO] [timer.py:160:stop] 0/600, SamplesPerSec=4873.943245865226
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.05587456 ms
avg iteration GPU training time:303.04696100 ms
avg iteration (step) total cpu time:335.99558744 ms
Epoch Time(s): 7.4265
******************************38 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.2722 | Train Acc 0.9264 | Speed (samples/sec) 34391.9008 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:25,513] [INFO] [logging.py:60:log_dist] [Rank 0] step=610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:25,576] [INFO] [timer.py:160:stop] 0/610, SamplesPerSec=4873.518628252802
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:29,186] [INFO] [logging.py:60:log_dist] [Rank 0] step=620, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:29,251] [INFO] [timer.py:160:stop] 0/620, SamplesPerSec=4869.812484542689
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.75266907 ms
avg iteration GPU training time:311.35458374 ms
avg iteration (step) total cpu time:342.21031449 ms
Epoch Time(s): 7.8146
******************************39 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.2801 | Train Acc 0.9234 | Speed (samples/sec) 34353.5350 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:34,669] [INFO] [logging.py:60:log_dist] [Rank 0] step=630, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:34,732] [INFO] [timer.py:160:stop] 0/630, SamplesPerSec=4867.589189951391
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:38,000] [INFO] [logging.py:60:log_dist] [Rank 0] step=640, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:38,063] [INFO] [timer.py:160:stop] 0/640, SamplesPerSec=4869.386764822848
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.15599736 ms
avg iteration GPU training time:305.27495228 ms
avg iteration (step) total cpu time:336.98394082 ms
Epoch Time(s): 7.4657
******************************40 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.2745 | Train Acc 0.9256 | Speed (samples/sec) 34352.7689 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:43,498] [INFO] [logging.py:60:log_dist] [Rank 0] step=650, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:43,562] [INFO] [timer.py:160:stop] 0/650, SamplesPerSec=4866.948591447528
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.45065568 ms
avg iteration GPU training time:303.20670388 ms
avg iteration (step) total cpu time:333.20260048 ms
Epoch Time(s): 7.4935
******************************41 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.2744 | Train Acc 0.9233 | Speed (samples/sec) 34352.9583 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:48,910] [INFO] [logging.py:60:log_dist] [Rank 0] step=660, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:48,973] [INFO] [timer.py:160:stop] 0/660, SamplesPerSec=4866.759917688849
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:52,352] [INFO] [logging.py:60:log_dist] [Rank 0] step=670, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:52,416] [INFO] [timer.py:160:stop] 0/670, SamplesPerSec=4867.364600208009
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.36384288 ms
avg iteration GPU training time:305.18660389 ms
avg iteration (step) total cpu time:336.10265905 ms
Epoch Time(s): 7.5317
******************************42 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.2635 | Train Acc 0.9290 | Speed (samples/sec) 34346.0776 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:30:57,851] [INFO] [logging.py:60:log_dist] [Rank 0] step=680, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:30:57,913] [INFO] [timer.py:160:stop] 0/680, SamplesPerSec=4866.5149934906185
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:20.05486228 ms
avg iteration GPU training time:298.59970648 ms
avg iteration (step) total cpu time:330.35995743 ms
Epoch Time(s): 7.4187
******************************43 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.2773 | Train Acc 0.9239 | Speed (samples/sec) 34349.2366 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:03,136] [INFO] [logging.py:60:log_dist] [Rank 0] step=690, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:03,198] [INFO] [timer.py:160:stop] 0/690, SamplesPerSec=4869.130453281744
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:06,516] [INFO] [logging.py:60:log_dist] [Rank 0] step=700, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:06,579] [INFO] [timer.py:160:stop] 0/700, SamplesPerSec=4869.650730131692
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09893521 ms
avg iteration GPU training time:300.99077259 ms
avg iteration (step) total cpu time:330.87294752 ms
Epoch Time(s): 7.3571
******************************44 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.2785 | Train Acc 0.9244 | Speed (samples/sec) 34361.6308 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:12,143] [INFO] [logging.py:60:log_dist] [Rank 0] step=710, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:12,207] [INFO] [timer.py:160:stop] 0/710, SamplesPerSec=4867.622742184352
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:15,435] [INFO] [logging.py:60:log_dist] [Rank 0] step=720, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:15,496] [INFO] [timer.py:160:stop] 0/720, SamplesPerSec=4869.929762651381
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.58354621 ms
avg iteration GPU training time:298.08129051 ms
avg iteration (step) total cpu time:328.65715027 ms
Epoch Time(s): 7.6020
******************************45 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.2754 | Train Acc 0.9233 | Speed (samples/sec) 34361.5393 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:20,908] [INFO] [logging.py:60:log_dist] [Rank 0] step=730, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:20,974] [INFO] [timer.py:160:stop] 0/730, SamplesPerSec=4869.933201602209
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95962169 ms
avg iteration GPU training time:301.63036000 ms
avg iteration (step) total cpu time:331.97773587 ms
Epoch Time(s): 7.4267
******************************46 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.2847 | Train Acc 0.9224 | Speed (samples/sec) 34370.3357 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:26,284] [INFO] [logging.py:60:log_dist] [Rank 0] step=740, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:26,348] [INFO] [timer.py:160:stop] 0/740, SamplesPerSec=4869.0311021785155
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:29,628] [INFO] [logging.py:60:log_dist] [Rank 0] step=750, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:29,690] [INFO] [timer.py:160:stop] 0/750, SamplesPerSec=4870.77807560043
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.59621221 ms
avg iteration GPU training time:300.18966675 ms
avg iteration (step) total cpu time:331.12133633 ms
Epoch Time(s): 7.4826
******************************47 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.2691 | Train Acc 0.9271 | Speed (samples/sec) 34365.9270 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:35,230] [INFO] [logging.py:60:log_dist] [Rank 0] step=760, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:35,292] [INFO] [timer.py:160:stop] 0/760, SamplesPerSec=4868.287235558613
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.20389227 ms
avg iteration GPU training time:305.76174927 ms
avg iteration (step) total cpu time:335.90024168 ms
Epoch Time(s): 7.5408
******************************48 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.2767 | Train Acc 0.9242 | Speed (samples/sec) 34359.0109 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:40,770] [INFO] [logging.py:60:log_dist] [Rank 0] step=770, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:40,833] [INFO] [timer.py:160:stop] 0/770, SamplesPerSec=4868.914063499879
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:44,208] [INFO] [logging.py:60:log_dist] [Rank 0] step=780, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:44,272] [INFO] [timer.py:160:stop] 0/780, SamplesPerSec=4868.4833277643165
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.05399825 ms
avg iteration GPU training time:307.01497303 ms
avg iteration (step) total cpu time:338.49900419 ms
Epoch Time(s): 7.6949
******************************49 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.2630 | Train Acc 0.9273 | Speed (samples/sec) 34355.2103 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:49,618] [INFO] [logging.py:60:log_dist] [Rank 0] step=790, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:49,681] [INFO] [timer.py:160:stop] 0/790, SamplesPerSec=4869.509924840111
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:52,903] [INFO] [logging.py:60:log_dist] [Rank 0] step=800, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:52,967] [INFO] [timer.py:160:stop] 0/800, SamplesPerSec=4871.610447103147
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.64961746 ms
avg iteration GPU training time:298.62085793 ms
avg iteration (step) total cpu time:328.99347219 ms
Epoch Time(s): 7.3185
******************************50 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.2772 | Train Acc 0.9246 | Speed (samples/sec) 34372.8444 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:31:58,420] [INFO] [logging.py:60:log_dist] [Rank 0] step=810, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:31:58,483] [INFO] [timer.py:160:stop] 0/810, SamplesPerSec=4871.738388276512
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.15054841 ms
avg iteration GPU training time:298.30906816 ms
avg iteration (step) total cpu time:328.81749760 ms
Epoch Time(s): 7.4802
******************************51 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.2763 | Train Acc 0.9252 | Speed (samples/sec) 34379.3294 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:03,896] [INFO] [logging.py:60:log_dist] [Rank 0] step=820, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:03,958] [INFO] [timer.py:160:stop] 0/820, SamplesPerSec=4872.246874812356
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:07,195] [INFO] [logging.py:60:log_dist] [Rank 0] step=830, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:07,257] [INFO] [timer.py:160:stop] 0/830, SamplesPerSec=4874.205204265145
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.91069083 ms
avg iteration GPU training time:298.00468584 ms
avg iteration (step) total cpu time:327.93136076 ms
Epoch Time(s): 7.4840
******************************52 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.2654 | Train Acc 0.9279 | Speed (samples/sec) 34388.7259 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:12,629] [INFO] [logging.py:60:log_dist] [Rank 0] step=840, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:12,692] [INFO] [timer.py:160:stop] 0/840, SamplesPerSec=4875.1423049976365
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.40596078 ms
avg iteration GPU training time:300.79672241 ms
avg iteration (step) total cpu time:331.95237680 ms
Epoch Time(s): 7.4470
******************************53 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.2535 | Train Acc 0.9317 | Speed (samples/sec) 34398.5995 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:18,104] [INFO] [logging.py:60:log_dist] [Rank 0] step=850, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:18,166] [INFO] [timer.py:160:stop] 0/850, SamplesPerSec=4875.950636806188
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:21,460] [INFO] [logging.py:60:log_dist] [Rank 0] step=860, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:21,524] [INFO] [timer.py:160:stop] 0/860, SamplesPerSec=4877.370239046453
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.92436947 ms
avg iteration GPU training time:299.70984719 ms
avg iteration (step) total cpu time:330.79190688 ms
Epoch Time(s): 7.4785
******************************54 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.2582 | Train Acc 0.9286 | Speed (samples/sec) 34407.6683 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:26,897] [INFO] [logging.py:60:log_dist] [Rank 0] step=870, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:26,960] [INFO] [timer.py:160:stop] 0/870, SamplesPerSec=4878.533319611699
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:30,157] [INFO] [logging.py:60:log_dist] [Rank 0] step=880, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:30,221] [INFO] [timer.py:160:stop] 0/880, SamplesPerSec=4880.495328569684
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.19157791 ms
avg iteration GPU training time:297.10609020 ms
avg iteration (step) total cpu time:326.33716410 ms
Epoch Time(s): 7.4236
******************************55 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.2846 | Train Acc 0.9232 | Speed (samples/sec) 34421.0035 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:36,740] [INFO] [logging.py:60:log_dist] [Rank 0] step=890, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:36,804] [INFO] [timer.py:160:stop] 0/890, SamplesPerSec=4875.1482705095505
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.26139918 ms
avg iteration GPU training time:313.46035212 ms
avg iteration (step) total cpu time:346.03600069 ms
Epoch Time(s): 8.4981
******************************56 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.2583 | Train Acc 0.9308 | Speed (samples/sec) 34373.4052 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:42,114] [INFO] [logging.py:60:log_dist] [Rank 0] step=900, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:42,177] [INFO] [timer.py:160:stop] 0/900, SamplesPerSec=4875.299909155319
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:45,612] [INFO] [logging.py:60:log_dist] [Rank 0] step=910, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:45,675] [INFO] [timer.py:160:stop] 0/910, SamplesPerSec=4874.715771564459
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:20.57610772 ms
avg iteration GPU training time:309.72731157 ms
avg iteration (step) total cpu time:347.35629775 ms
Epoch Time(s): 7.5730
******************************57 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.2605 | Train Acc 0.9286 | Speed (samples/sec) 34361.6807 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:51,264] [INFO] [logging.py:60:log_dist] [Rank 0] step=920, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:51,327] [INFO] [timer.py:160:stop] 0/920, SamplesPerSec=4875.732817549257
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.24057007 ms
avg iteration GPU training time:299.24775280 ms
avg iteration (step) total cpu time:330.54453676 ms
Epoch Time(s): 7.6140
******************************58 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.2560 | Train Acc 0.9300 | Speed (samples/sec) 34373.2761 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:32:57,201] [INFO] [logging.py:60:log_dist] [Rank 0] step=930, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:32:57,267] [INFO] [timer.py:160:stop] 0/930, SamplesPerSec=4877.223182084793
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:00,588] [INFO] [logging.py:60:log_dist] [Rank 0] step=940, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:00,652] [INFO] [timer.py:160:stop] 0/940, SamplesPerSec=4877.868284244241
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.84277795 ms
avg iteration GPU training time:301.58202293 ms
avg iteration (step) total cpu time:331.25296506 ms
Epoch Time(s): 8.0483
******************************59 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.2623 | Train Acc 0.9276 | Speed (samples/sec) 34380.9550 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:06,139] [INFO] [logging.py:60:log_dist] [Rank 0] step=950, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:06,203] [INFO] [timer.py:160:stop] 0/950, SamplesPerSec=4879.054291209151
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:09,416] [INFO] [logging.py:60:log_dist] [Rank 0] step=960, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:09,479] [INFO] [timer.py:160:stop] 0/960, SamplesPerSec=4880.724944585866
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.89102832 ms
avg iteration GPU training time:298.27676114 ms
avg iteration (step) total cpu time:328.45544815 ms
Epoch Time(s): 7.5417
******************************60 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.2620 | Train Acc 0.9266 | Speed (samples/sec) 34390.8347 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:14,909] [INFO] [logging.py:60:log_dist] [Rank 0] step=970, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:14,973] [INFO] [timer.py:160:stop] 0/970, SamplesPerSec=4881.353895095528
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.58389508 ms
avg iteration GPU training time:296.08394553 ms
avg iteration (step) total cpu time:326.32303238 ms
Epoch Time(s): 7.3399
******************************61 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.2730 | Train Acc 0.9275 | Speed (samples/sec) 34410.5184 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:20,263] [INFO] [logging.py:60:log_dist] [Rank 0] step=980, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:20,326] [INFO] [timer.py:160:stop] 0/980, SamplesPerSec=4882.817008909394
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:23,556] [INFO] [logging.py:60:log_dist] [Rank 0] step=990, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:23,619] [INFO] [timer.py:160:stop] 0/990, SamplesPerSec=4884.284407706223
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.90211504 ms
avg iteration GPU training time:297.83789062 ms
avg iteration (step) total cpu time:327.76000283 ms
Epoch Time(s): 7.3842
******************************62 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.2585 | Train Acc 0.9290 | Speed (samples/sec) 34424.4098 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:29,169] [INFO] [logging.py:60:log_dist] [Rank 0] step=1000, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:29,231] [INFO] [timer.py:160:stop] 0/1000, SamplesPerSec=4884.7070677650645
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.44699912 ms
avg iteration GPU training time:299.66895918 ms
avg iteration (step) total cpu time:331.00119504 ms
Epoch Time(s): 7.6217
******************************63 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.2818 | Train Acc 0.9231 | Speed (samples/sec) 34430.8643 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:34,650] [INFO] [logging.py:60:log_dist] [Rank 0] step=1010, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:34,713] [INFO] [timer.py:160:stop] 0/1010, SamplesPerSec=4885.6516527192225
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:37,998] [INFO] [logging.py:60:log_dist] [Rank 0] step=1020, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:38,062] [INFO] [timer.py:160:stop] 0/1020, SamplesPerSec=4886.540483565141
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.34746777 ms
avg iteration GPU training time:299.28143865 ms
avg iteration (step) total cpu time:330.67423647 ms
Epoch Time(s): 7.4854
******************************64 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.2741 | Train Acc 0.9248 | Speed (samples/sec) 34439.4262 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:43,419] [INFO] [logging.py:60:log_dist] [Rank 0] step=1030, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:43,482] [INFO] [timer.py:160:stop] 0/1030, SamplesPerSec=4887.600291246597
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:46,711] [INFO] [logging.py:60:log_dist] [Rank 0] step=1040, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:46,773] [INFO] [timer.py:160:stop] 0/1040, SamplesPerSec=4888.83550185854
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.62553588 ms
avg iteration GPU training time:298.90990934 ms
avg iteration (step) total cpu time:328.73030142 ms
Epoch Time(s): 7.4284
******************************65 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.2581 | Train Acc 0.9297 | Speed (samples/sec) 34450.1123 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:52,303] [INFO] [logging.py:60:log_dist] [Rank 0] step=1050, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:52,366] [INFO] [timer.py:160:stop] 0/1050, SamplesPerSec=4888.143127161908
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.49762032 ms
avg iteration GPU training time:304.61418013 ms
avg iteration (step) total cpu time:333.91306617 ms
Epoch Time(s): 7.5288
******************************66 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.2816 | Train Acc 0.9224 | Speed (samples/sec) 34453.6932 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:33:57,734] [INFO] [logging.py:60:log_dist] [Rank 0] step=1060, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:33:57,795] [INFO] [timer.py:160:stop] 0/1060, SamplesPerSec=4888.897249769266
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:01,114] [INFO] [logging.py:60:log_dist] [Rank 0] step=1070, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:01,177] [INFO] [timer.py:160:stop] 0/1070, SamplesPerSec=4889.569953340654
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:20.55530739 ms
avg iteration GPU training time:301.79885032 ms
avg iteration (step) total cpu time:334.20558409 ms
Epoch Time(s): 7.5260
******************************67 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.2597 | Train Acc 0.9278 | Speed (samples/sec) 34456.4792 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:06,650] [INFO] [logging.py:60:log_dist] [Rank 0] step=1080, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:06,711] [INFO] [timer.py:160:stop] 0/1080, SamplesPerSec=4890.586393639855
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.58710965 ms
avg iteration GPU training time:297.76756980 ms
avg iteration (step) total cpu time:329.01774753 ms
Epoch Time(s): 7.4976
******************************68 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.2661 | Train Acc 0.9267 | Speed (samples/sec) 34465.2568 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:12,111] [INFO] [logging.py:60:log_dist] [Rank 0] step=1090, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:12,174] [INFO] [timer.py:160:stop] 0/1090, SamplesPerSec=4890.729086847672
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:15,599] [INFO] [logging.py:60:log_dist] [Rank 0] step=1100, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:15,662] [INFO] [timer.py:160:stop] 0/1100, SamplesPerSec=4889.287994697722
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.53092662 ms
avg iteration GPU training time:305.86102295 ms
avg iteration (step) total cpu time:337.29453520 ms
Epoch Time(s): 7.6453
******************************69 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.2749 | Train Acc 0.9244 | Speed (samples/sec) 34456.0396 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:21,190] [INFO] [logging.py:60:log_dist] [Rank 0] step=1110, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:21,251] [INFO] [timer.py:160:stop] 0/1110, SamplesPerSec=4888.1420053644615
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:24,558] [INFO] [logging.py:60:log_dist] [Rank 0] step=1120, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:24,620] [INFO] [timer.py:160:stop] 0/1120, SamplesPerSec=4888.107392200068
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.87990691 ms
avg iteration GPU training time:309.77850064 ms
avg iteration (step) total cpu time:339.18866244 ms
Epoch Time(s): 7.6028
******************************70 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.2721 | Train Acc 0.9237 | Speed (samples/sec) 34448.1516 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:30,182] [INFO] [logging.py:60:log_dist] [Rank 0] step=1130, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:30,245] [INFO] [timer.py:160:stop] 0/1130, SamplesPerSec=4886.467998657925
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.39537742 ms
avg iteration GPU training time:309.38495428 ms
avg iteration (step) total cpu time:342.84858270 ms
Epoch Time(s): 7.6232
******************************71 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.2644 | Train Acc 0.9272 | Speed (samples/sec) 34440.7476 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:35,733] [INFO] [logging.py:60:log_dist] [Rank 0] step=1140, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:35,796] [INFO] [timer.py:160:stop] 0/1140, SamplesPerSec=4885.319118534822
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.61181640625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:39,085] [INFO] [logging.py:60:log_dist] [Rank 0] step=1150, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:39,148] [INFO] [timer.py:160:stop] 0/1150, SamplesPerSec=4885.8269083020405
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.08193744 ms
avg iteration GPU training time:302.54791260 ms
avg iteration (step) total cpu time:333.11594616 ms
Epoch Time(s): 7.6205
******************************72 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.61181640625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.2760 | Train Acc 0.9241 | Speed (samples/sec) 34434.8160 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:44,632] [INFO] [logging.py:60:log_dist] [Rank 0] step=1160, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:44,696] [INFO] [timer.py:160:stop] 0/1160, SamplesPerSec=4885.7439222769135
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.97791993 ms
avg iteration GPU training time:297.09537853 ms
avg iteration (step) total cpu time:327.33789357 ms
Epoch Time(s): 7.5056
******************************73 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.2558 | Train Acc 0.9278 | Speed (samples/sec) 34439.1394 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:50,132] [INFO] [logging.py:60:log_dist] [Rank 0] step=1170, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:50,194] [INFO] [timer.py:160:stop] 0/1170, SamplesPerSec=4885.953828924321
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:53,694] [INFO] [logging.py:60:log_dist] [Rank 0] step=1180, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:53,757] [INFO] [timer.py:160:stop] 0/1180, SamplesPerSec=4883.754649607182
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.43957537 ms
avg iteration GPU training time:310.24186013 ms
avg iteration (step) total cpu time:340.58182890 ms
Epoch Time(s): 7.7454
******************************74 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.2630 | Train Acc 0.9270 | Speed (samples/sec) 34425.5086 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:34:59,281] [INFO] [logging.py:60:log_dist] [Rank 0] step=1190, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:34:59,343] [INFO] [timer.py:160:stop] 0/1190, SamplesPerSec=4883.137863469717
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:02,982] [INFO] [logging.py:60:log_dist] [Rank 0] step=1200, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:03,045] [INFO] [timer.py:160:stop] 0/1200, SamplesPerSec=4878.824248844172
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.82647549 ms
avg iteration GPU training time:340.78690962 ms
avg iteration (step) total cpu time:371.00070173 ms
Epoch Time(s): 7.9881
******************************75 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.2748 | Train Acc 0.9260 | Speed (samples/sec) 34394.0309 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:08,449] [INFO] [logging.py:60:log_dist] [Rank 0] step=1210, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:08,513] [INFO] [timer.py:160:stop] 0/1210, SamplesPerSec=4878.177251933184
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.21185754 ms
avg iteration GPU training time:297.18266713 ms
avg iteration (step) total cpu time:329.00628177 ms
Epoch Time(s): 7.3940
******************************76 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.2637 | Train Acc 0.9279 | Speed (samples/sec) 34396.7676 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:13,820] [INFO] [logging.py:60:log_dist] [Rank 0] step=1220, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:13,881] [INFO] [timer.py:160:stop] 0/1220, SamplesPerSec=4878.146083704651
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:17,125] [INFO] [logging.py:60:log_dist] [Rank 0] step=1230, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:17,188] [INFO] [timer.py:160:stop] 0/1230, SamplesPerSec=4879.266531985728
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.54738027 ms
avg iteration GPU training time:299.54771285 ms
avg iteration (step) total cpu time:330.34118739 ms
Epoch Time(s): 7.3643
******************************77 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.2636 | Train Acc 0.9272 | Speed (samples/sec) 34402.4801 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:22,483] [INFO] [logging.py:60:log_dist] [Rank 0] step=1240, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:22,546] [INFO] [timer.py:160:stop] 0/1240, SamplesPerSec=4879.791028665971
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.87409453 ms
avg iteration GPU training time:297.49093073 ms
avg iteration (step) total cpu time:329.06894250 ms
Epoch Time(s): 7.3379
******************************78 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.2649 | Train Acc 0.9243 | Speed (samples/sec) 34410.3561 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:27,779] [INFO] [logging.py:60:log_dist] [Rank 0] step=1250, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:27,843] [INFO] [timer.py:160:stop] 0/1250, SamplesPerSec=4880.661677322562
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:31,129] [INFO] [logging.py:60:log_dist] [Rank 0] step=1260, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:31,193] [INFO] [timer.py:160:stop] 0/1260, SamplesPerSec=4881.794496668316
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:19.15488867 ms
avg iteration GPU training time:296.30199918 ms
avg iteration (step) total cpu time:328.30888575 ms
Epoch Time(s): 7.3157
******************************79 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.2701 | Train Acc 0.9225 | Speed (samples/sec) 34417.6338 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:36,538] [INFO] [logging.py:60:log_dist] [Rank 0] step=1270, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:36,600] [INFO] [timer.py:160:stop] 0/1270, SamplesPerSec=4882.292717186655
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:39,841] [INFO] [logging.py:60:log_dist] [Rank 0] step=1280, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:39,907] [INFO] [timer.py:160:stop] 0/1280, SamplesPerSec=4883.443912126224
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.31579919 ms
avg iteration GPU training time:299.80613570 ms
avg iteration (step) total cpu time:332.00287819 ms
Epoch Time(s): 7.4044
******************************80 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.2626 | Train Acc 0.9264 | Speed (samples/sec) 34422.6175 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:45,270] [INFO] [logging.py:60:log_dist] [Rank 0] step=1290, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:45,333] [INFO] [timer.py:160:stop] 0/1290, SamplesPerSec=4883.2432774647195
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.48211202 ms
avg iteration GPU training time:296.54147894 ms
avg iteration (step) total cpu time:327.22161033 ms
Epoch Time(s): 7.3853
******************************81 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.2708 | Train Acc 0.9239 | Speed (samples/sec) 34428.1093 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:50,566] [INFO] [logging.py:60:log_dist] [Rank 0] step=1300, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:50,628] [INFO] [timer.py:160:stop] 0/1300, SamplesPerSec=4884.410162263608
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:53,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=1310, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:53,948] [INFO] [timer.py:160:stop] 0/1310, SamplesPerSec=4885.413474374395
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.29577602 ms
avg iteration GPU training time:299.14600442 ms
avg iteration (step) total cpu time:328.87489145 ms
Epoch Time(s): 7.2876
******************************82 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.2637 | Train Acc 0.9272 | Speed (samples/sec) 34437.9536 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:35:59,234] [INFO] [logging.py:60:log_dist] [Rank 0] step=1320, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:35:59,297] [INFO] [timer.py:160:stop] 0/1320, SamplesPerSec=4886.153672359162
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.52383978 ms
avg iteration GPU training time:300.09709861 ms
avg iteration (step) total cpu time:330.79832250 ms
Epoch Time(s): 7.3368
******************************83 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.2735 | Train Acc 0.9255 | Speed (samples/sec) 34444.8287 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:04,571] [INFO] [logging.py:60:log_dist] [Rank 0] step=1330, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:04,633] [INFO] [timer.py:160:stop] 0/1330, SamplesPerSec=4886.188325803517
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:07,914] [INFO] [logging.py:60:log_dist] [Rank 0] step=1340, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:07,977] [INFO] [timer.py:160:stop] 0/1340, SamplesPerSec=4886.813030297524
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30978029 ms
avg iteration GPU training time:298.29886419 ms
avg iteration (step) total cpu time:329.28507978 ms
Epoch Time(s): 7.3858
******************************84 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.2744 | Train Acc 0.9262 | Speed (samples/sec) 34449.7773 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:13,251] [INFO] [logging.py:60:log_dist] [Rank 0] step=1350, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:13,315] [INFO] [timer.py:160:stop] 0/1350, SamplesPerSec=4887.204535485356
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:16,558] [INFO] [logging.py:60:log_dist] [Rank 0] step=1360, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:16,621] [INFO] [timer.py:160:stop] 0/1360, SamplesPerSec=4888.080095093127
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.82463386 ms
avg iteration GPU training time:299.68001487 ms
avg iteration (step) total cpu time:331.13785224 ms
Epoch Time(s): 7.3665
******************************85 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.2653 | Train Acc 0.9255 | Speed (samples/sec) 34456.5637 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:22,038] [INFO] [logging.py:60:log_dist] [Rank 0] step=1370, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:22,098] [INFO] [timer.py:160:stop] 0/1370, SamplesPerSec=4888.931955445114
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.65395789 ms
avg iteration GPU training time:296.60725264 ms
avg iteration (step) total cpu time:326.25818253 ms
Epoch Time(s): 7.4527
******************************86 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.2737 | Train Acc 0.9223 | Speed (samples/sec) 34463.7097 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:27,370] [INFO] [logging.py:60:log_dist] [Rank 0] step=1380, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:27,434] [INFO] [timer.py:160:stop] 0/1380, SamplesPerSec=4889.754343146
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:30,665] [INFO] [logging.py:60:log_dist] [Rank 0] step=1390, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:30,727] [INFO] [timer.py:160:stop] 0/1390, SamplesPerSec=4890.717100037458
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.66223127 ms
avg iteration GPU training time:298.25166737 ms
avg iteration (step) total cpu time:328.31421765 ms
Epoch Time(s): 7.2524
******************************87 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.2731 | Train Acc 0.9251 | Speed (samples/sec) 34473.1214 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:36,011] [INFO] [logging.py:60:log_dist] [Rank 0] step=1400, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:36,074] [INFO] [timer.py:160:stop] 0/1400, SamplesPerSec=4890.8668632146155
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.55007432 ms
avg iteration GPU training time:298.61252386 ms
avg iteration (step) total cpu time:330.73102344 ms
Epoch Time(s): 7.3311
******************************88 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.2635 | Train Acc 0.9261 | Speed (samples/sec) 34479.4825 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:41,334] [INFO] [logging.py:60:log_dist] [Rank 0] step=1410, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:41,395] [INFO] [timer.py:160:stop] 0/1410, SamplesPerSec=4891.394778731282
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:44,780] [INFO] [logging.py:60:log_dist] [Rank 0] step=1420, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:44,845] [INFO] [timer.py:160:stop] 0/1420, SamplesPerSec=4890.797798430103
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.62155030 ms
avg iteration GPU training time:302.32924860 ms
avg iteration (step) total cpu time:333.30041712 ms
Epoch Time(s): 7.4528
******************************89 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.2649 | Train Acc 0.9265 | Speed (samples/sec) 34475.7541 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:50,168] [INFO] [logging.py:60:log_dist] [Rank 0] step=1430, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:50,232] [INFO] [timer.py:160:stop] 0/1430, SamplesPerSec=4891.102268783908
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:53,478] [INFO] [logging.py:60:log_dist] [Rank 0] step=1440, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:53,542] [INFO] [timer.py:160:stop] 0/1440, SamplesPerSec=4891.775350077919
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.92589933 ms
avg iteration GPU training time:300.83308549 ms
avg iteration (step) total cpu time:330.87509329 ms
Epoch Time(s): 7.3969
******************************90 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.2649 | Train Acc 0.9254 | Speed (samples/sec) 34479.9812 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:36:58,885] [INFO] [logging.py:60:log_dist] [Rank 0] step=1450, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:36:58,949] [INFO] [timer.py:160:stop] 0/1450, SamplesPerSec=4891.844002401503
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.24328735 ms
avg iteration GPU training time:301.15196644 ms
avg iteration (step) total cpu time:331.36276765 ms
Epoch Time(s): 7.3687
******************************91 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.2720 | Train Acc 0.9243 | Speed (samples/sec) 34483.8802 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:04,361] [INFO] [logging.py:60:log_dist] [Rank 0] step=1460, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:04,423] [INFO] [timer.py:160:stop] 0/1460, SamplesPerSec=4890.9138833394745
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.61181640625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:07,708] [INFO] [logging.py:60:log_dist] [Rank 0] step=1470, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:07,770] [INFO] [timer.py:160:stop] 0/1470, SamplesPerSec=4891.586515862637
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.81844677 ms
avg iteration GPU training time:300.98253285 ms
avg iteration (step) total cpu time:332.14250478 ms
Epoch Time(s): 7.5128
******************************92 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.2795 | Train Acc 0.9230 | Speed (samples/sec) 34481.1257 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:13,076] [INFO] [logging.py:60:log_dist] [Rank 0] step=1480, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:13,142] [INFO] [timer.py:160:stop] 0/1480, SamplesPerSec=4891.970442771524
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.63357648 ms
avg iteration GPU training time:297.52670011 ms
avg iteration (step) total cpu time:328.49366015 ms
Epoch Time(s): 7.3826
******************************93 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.2625 | Train Acc 0.9273 | Speed (samples/sec) 34486.4516 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:18,478] [INFO] [logging.py:60:log_dist] [Rank 0] step=1490, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:18,541] [INFO] [timer.py:160:stop] 0/1490, SamplesPerSec=4892.949055731417
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:21,835] [INFO] [logging.py:60:log_dist] [Rank 0] step=1500, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:21,897] [INFO] [timer.py:160:stop] 0/1500, SamplesPerSec=4893.631832725064
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.98627767 ms
avg iteration GPU training time:301.13464355 ms
avg iteration (step) total cpu time:331.95827224 ms
Epoch Time(s): 7.4393
******************************94 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.2710 | Train Acc 0.9260 | Speed (samples/sec) 34489.8691 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:27,591] [INFO] [logging.py:60:log_dist] [Rank 0] step=1510, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:27,654] [INFO] [timer.py:160:stop] 0/1510, SamplesPerSec=4893.96303653872
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:30,906] [INFO] [logging.py:60:log_dist] [Rank 0] step=1520, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:30,970] [INFO] [timer.py:160:stop] 0/1520, SamplesPerSec=4894.841435879275
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.66415111 ms
avg iteration GPU training time:298.65627774 ms
avg iteration (step) total cpu time:333.28600363 ms
Epoch Time(s): 7.7473
******************************95 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.2585 | Train Acc 0.9269 | Speed (samples/sec) 34483.6614 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:36,372] [INFO] [logging.py:60:log_dist] [Rank 0] step=1530, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:36,435] [INFO] [timer.py:160:stop] 0/1530, SamplesPerSec=4894.988922005729
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.02232708 ms
avg iteration GPU training time:299.58448930 ms
avg iteration (step) total cpu time:330.48922365 ms
Epoch Time(s): 7.4332
******************************96 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.2776 | Train Acc 0.9225 | Speed (samples/sec) 34488.2468 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:41,868] [INFO] [logging.py:60:log_dist] [Rank 0] step=1540, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:41,932] [INFO] [timer.py:160:stop] 0/1540, SamplesPerSec=4895.654908976857
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:45,213] [INFO] [logging.py:60:log_dist] [Rank 0] step=1550, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:45,277] [INFO] [timer.py:160:stop] 0/1550, SamplesPerSec=4896.499995576436
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.08032313 ms
avg iteration GPU training time:297.43293069 ms
avg iteration (step) total cpu time:327.45246454 ms
Epoch Time(s): 7.5353
******************************97 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.2775 | Train Acc 0.9226 | Speed (samples/sec) 34492.7738 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:51,018] [INFO] [logging.py:60:log_dist] [Rank 0] step=1560, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:51,081] [INFO] [timer.py:160:stop] 0/1560, SamplesPerSec=4896.689460955068
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.67465609 ms
avg iteration GPU training time:296.99016779 ms
avg iteration (step) total cpu time:326.69598406 ms
Epoch Time(s): 7.6986
******************************98 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.2755 | Train Acc 0.9239 | Speed (samples/sec) 34498.3013 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:37:56,916] [INFO] [logging.py:60:log_dist] [Rank 0] step=1570, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:37:56,979] [INFO] [timer.py:160:stop] 0/1570, SamplesPerSec=4897.333106068684
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:38:00,341] [INFO] [logging.py:60:log_dist] [Rank 0] step=1580, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:38:00,404] [INFO] [timer.py:160:stop] 0/1580, SamplesPerSec=4897.371213494147
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:20.87747192 ms
avg iteration GPU training time:306.37598211 ms
avg iteration (step) total cpu time:339.78460052 ms
Epoch Time(s): 8.1125
******************************99 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.2703 | Train Acc 0.9273 | Speed (samples/sec) 34496.7966 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.61181640625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:38:05,724] [INFO] [logging.py:60:log_dist] [Rank 0] step=1590, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:38:05,788] [INFO] [timer.py:160:stop] 0/1590, SamplesPerSec=4897.901651073719
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:38:08,985] [INFO] [logging.py:60:log_dist] [Rank 0] step=1600, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:38:09,046] [INFO] [timer.py:160:stop] 0/1600, SamplesPerSec=4898.988814801935
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:18.19186315 ms
avg iteration GPU training time:296.04345148 ms
avg iteration (step) total cpu time:326.10316710 ms
Epoch Time(s): 7.2656
******************************100 epoch 
 the length of training loader ------------------------------------------------------------
16
4
181

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.2754 | Train Acc 0.9258 | Speed (samples/sec) 34504.6044 | GPU 17160.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

[2021-06-17 23:38:14,378] [INFO] [logging.py:60:log_dist] [Rank 0] step=1610, skipped=0, lr=[0.03], mom=[[0.8, 0.999]]
[2021-06-17 23:38:14,441] [INFO] [timer.py:160:stop] 0/1610, SamplesPerSec=4899.491752024407
-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58642578125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60986328125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56298828125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.59814453125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------before blocks to device
 Nvidia-smi: 31.56103515625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after blocks to device
 Nvidia-smi: 31.58447265625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch train
 Nvidia-smi: 31.60791015625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss
 Nvidia-smi: 31.60009765625GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch loss backward
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

-----------------------------------------after batch engine step
 Nvidia-smi: 31.60205078125GB

Max Memory Allocated 16.758448123931885  GigaBytes

avg iteration(step) data from cpu to GPU time:17.60552406 ms
avg iteration GPU training time:296.87882857 ms
avg iteration (step) total cpu time:326.98908719 ms
Epoch Time(s): 7.3406
Eval Acc 0.9129
Test Acc: 0.7510
Avg epoch time(time.time()): 7491.249745090802 ms
total avg iteration(step) data from cpu to GPU time:18.58809747 ms
total avg iteration GPU training time:302.28849129 ms
total avg iteration (step) total cpu time:333.38187966 ms
